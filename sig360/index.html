<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SIG 360 - Innovaq Solutions</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body, #root { width: 100%; height: 100%; overflow: hidden; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
</style>
<script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://cdn.jsdelivr.net/npm/prop-types@15/prop-types.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/recharts@2.12.7/umd/Recharts.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel" data-type="module">
// Destructure React hooks from React global
const { useState, useEffect, useCallback, useMemo, useRef } = React;
// Destructure Recharts components from Recharts global
const { LineChart, Line, AreaChart, Area, BarChart, Bar, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, RadarChart, Radar, PolarGrid, PolarAngleAxis, PolarRadiusAxis, ComposedChart, Treemap } = Recharts;

// ═══════════════════════════════════════════════════════════════════════════
// SIG CONSTRUCCION 360 — V7  |  Control Documental Integral ISO + SGS
// ISO 9001 · ISO 14001 · ISO 45001 · ISO 37001
// Modulos: Dashboard BI · Docs · Auditoria IA · Legal Tech · Lista Maestra
// Recursos PDCA · Modulos ISO Editables · Incidentes SST
// ═══════════════════════════════════════════════════════════════════════════

var C = {
  bg:"#06090f", sf:"#0c1220", sa:"#111a2d", card:"#0f1728", cardH:"#142035",
  bd:"#1a2744", bdL:"#243354", tx:"#e4ecf7", tm:"#8da0bc", td:"#4d6484",
  pr:"#2d7ff9", pl:"#5da3ff", pd:"#1a5fd4", ac:"#00d68f", acD:"#00b377",
  wn:"#ffb020", wnD:"#e09500", dn:"#ff4757", dnD:"#d63040",
  pp:"#8c6bfa", ppL:"#aa90ff", cy:"#00d4ff", tl:"#1abc9c",
  i9:"#2d7ff9", i14:"#00c853", i45:"#ffab00", i37:"#8c6bfa",
  g1:"linear-gradient(135deg,#2d7ff9,#00d4ff)",
  g2:"linear-gradient(135deg,#00d68f,#00b377)",
  g3:"linear-gradient(135deg,#ffb020,#ff8c00)",
  g4:"linear-gradient(135deg,#8c6bfa,#d946ef)",
};

// ═══ SVG ICON HELPERS ═══
function svgI(d, w, h) {
  w = w || 18; h = h || 18;
  return React.createElement("svg", {
    width: w, height: h, viewBox: "0 0 24 24", fill: "none",
    stroke: "currentColor", strokeWidth: 1.7,
    strokeLinecap: "round", strokeLinejoin: "round"
  }, d);
}

var Icons = {
  Dash: function() { return svgI([
    React.createElement("rect", { key:"a", x:3, y:3, width:7, height:7, rx:1.5 }),
    React.createElement("rect", { key:"b", x:14, y:3, width:7, height:7, rx:1.5 }),
    React.createElement("rect", { key:"c", x:3, y:14, width:7, height:7, rx:1.5 }),
    React.createElement("rect", { key:"d", x:14, y:14, width:7, height:7, rx:1.5 })
  ]); },
  Doc: function() { return svgI([
    React.createElement("path", { key:"a", d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" }),
    React.createElement("polyline", { key:"b", points:"14 2 14 8 20 8" })
  ]); },
  Folder: function() { return svgI([
    React.createElement("path", { key:"a", d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z" })
  ]); },
  Upload: function() { return svgI([
    React.createElement("path", { key:"a", d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" }),
    React.createElement("polyline", { key:"b", points:"17 8 12 3 7 8" }),
    React.createElement("line", { key:"c", x1:12, y1:3, x2:12, y2:15 })
  ]); },
  Download: function() { return svgI([
    React.createElement("path", { key:"a", d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" }),
    React.createElement("polyline", { key:"b", points:"7 10 12 15 17 10" }),
    React.createElement("line", { key:"c", x1:12, y1:15, x2:12, y2:3 })
  ]); },
  Eye: function() { return svgI([
    React.createElement("path", { key:"a", d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" }),
    React.createElement("circle", { key:"b", cx:12, cy:12, r:3 })
  ]); },
  Check: function() { return svgI([
    React.createElement("polyline", { key:"a", points:"20 6 9 17 4 12" })
  ]); },
  X: function() { return svgI([
    React.createElement("line", { key:"a", x1:18, y1:6, x2:6, y2:18 }),
    React.createElement("line", { key:"b", x1:6, y1:6, x2:18, y2:18 })
  ]); },
  Alert: function() { return svgI([
    React.createElement("path", { key:"a", d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z" }),
    React.createElement("line", { key:"b", x1:12, y1:9, x2:12, y2:13 }),
    React.createElement("line", { key:"c", x1:12, y1:17, x2:12.01, y2:17 })
  ]); },
  Shield: function() { return svgI([
    React.createElement("path", { key:"a", d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" })
  ]); },
  Leaf: function() { return svgI([
    React.createElement("path", { key:"a", d:"M17 8C8 10 5.9 16.17 3.82 21.34" }),
    React.createElement("path", { key:"b", d:"M20.2 2.8a1 1 0 00-1.4 0C15 6.6 11 9 6 11a1 1 0 00-.6 1.2c1.4 5 5 8.6 10 9.8a1 1 0 001.2-.6c2-5 2.4-11 .6-14.8" })
  ]); },
  Star: function() { return svgI([
    React.createElement("path", { key:"a", d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" })
  ]); },
  Brain: function() { return svgI([
    React.createElement("path", { key:"a", d:"M9.5 2A5.5 5.5 0 005 7.5c0 1.3.5 2.5 1.3 3.4" }),
    React.createElement("path", { key:"b", d:"M14.5 2A5.5 5.5 0 0120 7.5c0 1.3-.5 2.5-1.3 3.4" }),
    React.createElement("path", { key:"c", d:"M6.3 10.9A5.5 5.5 0 004 15.5 5.5 5.5 0 009.5 21h5a5.5 5.5 0 005.5-5.5c0-1.8-.9-3.4-2.3-4.4" }),
    React.createElement("line", { key:"d", x1:12, y1:2, x2:12, y2:21 })
  ]); },
  Scale: function() { return svgI([
    React.createElement("path", { key:"a", d:"M12 3v18" }),
    React.createElement("path", { key:"b", d:"M5 7l7-4 7 4" }),
    React.createElement("path", { key:"c", d:"M3 13l2-6 4 6a4 4 0 01-6 0z" }),
    React.createElement("path", { key:"d", d:"M15 13l2-6 4 6a4 4 0 01-6 0z" })
  ]); },
  Menu: function() { return svgI([
    React.createElement("line", { key:"a", x1:3, y1:12, x2:21, y2:12 }),
    React.createElement("line", { key:"b", x1:3, y1:6, x2:21, y2:6 }),
    React.createElement("line", { key:"c", x1:3, y1:18, x2:21, y2:18 })
  ]); },
  Bell: function() { return svgI([
    React.createElement("path", { key:"a", d:"M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9" }),
    React.createElement("path", { key:"b", d:"M13.73 21a2 2 0 01-3.46 0" })
  ]); },
  Search: function() { return svgI([
    React.createElement("circle", { key:"a", cx:11, cy:11, r:8 }),
    React.createElement("line", { key:"b", x1:21, y1:21, x2:16.65, y2:16.65 })
  ]); },
  Plus: function() { return svgI([
    React.createElement("line", { key:"a", x1:12, y1:5, x2:12, y2:19 }),
    React.createElement("line", { key:"b", x1:5, y1:12, x2:19, y2:12 })
  ]); },
  Bar: function() { return svgI([
    React.createElement("rect", { key:"a", x:3, y:10, width:4, height:11, rx:1 }),
    React.createElement("rect", { key:"b", x:10, y:3, width:4, height:18, rx:1 }),
    React.createElement("rect", { key:"c", x:17, y:7, width:4, height:14, rx:1 })
  ]); },
  Users: function() { return svgI([
    React.createElement("path", { key:"a", d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" }),
    React.createElement("circle", { key:"b", cx:9, cy:7, r:4 }),
    React.createElement("path", { key:"c", d:"M23 21v-2a4 4 0 00-3-3.87" }),
    React.createElement("path", { key:"d", d:"M16 3.13a4 4 0 010 7.75" })
  ]); },
  Settings: function() { return svgI([
    React.createElement("circle", { key:"a", cx:12, cy:12, r:3 }),
    React.createElement("path", { key:"b", d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 112.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 112.83 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9c.26.604.852.997 1.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" })
  ]); },
  Trend: function() { return svgI([
    React.createElement("polyline", { key:"a", points:"23 6 13.5 15.5 8.5 10.5 1 18" }),
    React.createElement("polyline", { key:"b", points:"17 6 23 6 23 12" })
  ]); },
  Clock: function() { return svgI([
    React.createElement("circle", { key:"a", cx:12, cy:12, r:10 }),
    React.createElement("polyline", { key:"b", points:"12 6 12 12 16 14" })
  ]); },
  Clipboard: function() { return svgI([
    React.createElement("path", { key:"a", d:"M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2" }),
    React.createElement("rect", { key:"b", x:8, y:2, width:8, height:4, rx:1, ry:1 })
  ]); },
  Gavel: function() { return svgI([
    React.createElement("path", { key:"a", d:"M14 3l-4 4 7 7 4-4-7-7z" }),
    React.createElement("path", { key:"b", d:"M3 21l5-5" }),
    React.createElement("path", { key:"c", d:"M7 17l-4 4" }),
    React.createElement("path", { key:"d", d:"M11 7L7 3" })
  ]); },
  Filter: function() { return svgI([
    React.createElement("polygon", { key:"a", points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3" })
  ]); },
  ChevDown: function() { return svgI([
    React.createElement("polyline", { key:"a", points:"6 9 12 15 18 9" })
  ]); },
  ChevRight: function() { return svgI([
    React.createElement("polyline", { key:"a", points:"9 18 15 12 9 6" })
  ]); },
  RefreshCw: function() { return svgI([
    React.createElement("polyline", { key:"a", points:"23 4 23 10 17 10" }),
    React.createElement("polyline", { key:"b", points:"1 20 1 14 7 14" }),
    React.createElement("path", { key:"c", d:"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" })
  ]); },
  FileText: function() { return svgI([
    React.createElement("path", { key:"a", d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" }),
    React.createElement("polyline", { key:"b", points:"14 2 14 8 20 8" }),
    React.createElement("line", { key:"c", x1:16, y1:13, x2:8, y2:13 }),
    React.createElement("line", { key:"d", x1:16, y1:17, x2:8, y2:17 }),
    React.createElement("polyline", { key:"e", points:"10 9 9 9 8 9" })
  ]); },
  Building: function() { return svgI([
    React.createElement("rect", { key:"a", x:4, y:2, width:16, height:20, rx:2, ry:2 }),
    React.createElement("line", { key:"b", x1:9, y1:6, x2:9.01, y2:6 }),
    React.createElement("line", { key:"c", x1:15, y1:6, x2:15.01, y2:6 }),
    React.createElement("line", { key:"d", x1:9, y1:10, x2:9.01, y2:10 }),
    React.createElement("line", { key:"e", x1:15, y1:10, x2:15.01, y2:10 }),
    React.createElement("line", { key:"f", x1:9, y1:14, x2:9.01, y2:14 }),
    React.createElement("line", { key:"g", x1:15, y1:14, x2:15.01, y2:14 }),
    React.createElement("line", { key:"h", x1:9, y1:18, x2:15, y2:18 })
  ]); },
  ListIcon: function() { return svgI([
    React.createElement("line", { key:"a", x1:8, y1:6, x2:21, y2:6 }),
    React.createElement("line", { key:"b", x1:8, y1:12, x2:21, y2:12 }),
    React.createElement("line", { key:"c", x1:8, y1:18, x2:21, y2:18 }),
    React.createElement("line", { key:"d", x1:3, y1:6, x2:3.01, y2:6 }),
    React.createElement("line", { key:"e", x1:3, y1:12, x2:3.01, y2:12 }),
    React.createElement("line", { key:"f", x1:3, y1:18, x2:3.01, y2:18 })
  ]); },
  Database: function() { return svgI([
    React.createElement("ellipse", { key:"a", cx:12, cy:5, rx:9, ry:3 }),
    React.createElement("path", { key:"b", d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" }),
    React.createElement("path", { key:"c", d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" })
  ]); },
  Wrench: function() { return svgI([
    React.createElement("path", { key:"a", d:"M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z" })
  ]); },
  Package: function() { return svgI([
    React.createElement("path", { key:"a", d:"M16.5 9.4l-9-5.19" }),
    React.createElement("path", { key:"b", d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z" }),
    React.createElement("polyline", { key:"c", points:"3.27 6.96 12 12.01 20.73 6.96" }),
    React.createElement("line", { key:"d", x1:12, y1:22.08, x2:12, y2:12 })
  ]); },
  Edit: function() { return svgI([
    React.createElement("path", { key:"a", d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" }),
    React.createElement("path", { key:"b", d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" })
  ]); },
  Zap: function() { return svgI([
    React.createElement("polygon", { key:"a", points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2" })
  ]); },
};


// ═══ AUDIT DATA (Auditor Inteligente IA) ═══
var _aUid = function() { return Math.random().toString(36).substr(2, 8); };
var _aToday = function() { return new Date().toISOString().split("T")[0]; };
var _aFmtDate = function(d) { if (!d) return "\u2014"; return new Date(d + "T12:00:00").toLocaleDateString("es-PE", { day: "2-digit", month: "short", year: "numeric" }); };
var _aInputS = { background: C.sa, border: "1px solid " + C.bd, borderRadius: 6, padding: "6px 10px", color: C.tx, fontSize: 11, outline: "none", width: "100%", fontFamily: "inherit" };
var _aSelectS = Object.assign({}, _aInputS, { cursor: "pointer" });
var _aBtnS = function(bg, c) { return { background: bg, color: c || "#fff", border: "none", borderRadius: 6, padding: "6px 14px", fontSize: 10, fontWeight: 700, cursor: "pointer", display: "flex", alignItems: "center", gap: 4, transition: "all .15s" }; };

var AUDIT_CHECKLISTS = {
  "9001": [
    { clausula: "4.1", req: "Contexto de la organizaci\u00f3n", docs: ["An\u00e1lisis FODA/PESTEL", "Informaci\u00f3n documentada del contexto"] },
    { clausula: "4.2", req: "Partes interesadas", docs: ["Matriz de partes interesadas"] },
    { clausula: "5.2", req: "Pol\u00edtica de calidad", docs: ["Pol\u00edtica documentada", "Evidencia de comunicaci\u00f3n"] },
    { clausula: "6.1", req: "Riesgos y oportunidades", docs: ["Matriz de riesgos", "Plan de tratamiento"] },
    { clausula: "6.2", req: "Objetivos de calidad", docs: ["Objetivos e indicadores KPIs"] },
    { clausula: "7.2", req: "Competencia", docs: ["Matriz de competencias", "Registros de formaci\u00f3n"] },
    { clausula: "7.5", req: "Informaci\u00f3n documentada", docs: ["Procedimiento de control documental", "Lista maestra"] },
    { clausula: "8.1", req: "Planificaci\u00f3n y control operacional", docs: ["Procedimientos operativos"] },
    { clausula: "8.4", req: "Control de proveedores externos", docs: ["Evaluaci\u00f3n de proveedores"] },
    { clausula: "8.7", req: "Salidas no conformes", docs: ["Procedimiento de PNC", "Registros de NC"] },
    { clausula: "9.1", req: "Seguimiento y medici\u00f3n", docs: ["Indicadores", "Tablero de control"] },
    { clausula: "9.2", req: "Auditor\u00eda interna", docs: ["Programa e informes de auditor\u00eda"] },
    { clausula: "9.3", req: "Revisi\u00f3n por la direcci\u00f3n", docs: ["Acta de revisi\u00f3n"] },
    { clausula: "10.2", req: "No conformidad y acci\u00f3n correctiva", docs: ["Registro de NC", "Acciones correctivas"] }
  ],
  "14001": [
    { clausula: "4.1", req: "Contexto ambiental", docs: ["An\u00e1lisis de contexto ambiental"] },
    { clausula: "6.1.2", req: "Aspectos ambientales significativos", docs: ["Matriz de aspectos e impactos"] },
    { clausula: "6.1.3", req: "Requisitos legales ambientales", docs: ["Matriz legal ambiental"] },
    { clausula: "6.2", req: "Objetivos ambientales", docs: ["Objetivos y metas ambientales"] },
    { clausula: "8.1", req: "Control operacional ambiental", docs: ["Gesti\u00f3n de residuos", "Control de emisiones"] },
    { clausula: "8.2", req: "Emergencias ambientales", docs: ["Plan de contingencia ambiental"] },
    { clausula: "9.1.1", req: "Monitoreo ambiental", docs: ["Registros de medici\u00f3n ECA/LMP"] },
    { clausula: "9.1.2", req: "Cumplimiento legal ambiental", docs: ["Informe de cumplimiento"] },
    { clausula: "9.2", req: "Auditor\u00eda interna ambiental", docs: ["Programa e informes"] },
    { clausula: "10.2", req: "NC y acci\u00f3n correctiva ambiental", docs: ["NC ambientales"] }
  ],
  "45001": [
    { clausula: "4.1", req: "Contexto SST", docs: ["An\u00e1lisis de contexto SST"] },
    { clausula: "5.2", req: "Pol\u00edtica de SST", docs: ["Pol\u00edtica de SST", "Difusi\u00f3n"] },
    { clausula: "5.4", req: "Consulta y participaci\u00f3n de trabajadores", docs: ["Comit\u00e9 de SST", "Actas de reuni\u00f3n"] },
    { clausula: "6.1.2", req: "IPERC", docs: ["IPERC l\u00ednea base", "IPERC continuo", "Mapa de riesgos"] },
    { clausula: "6.1.3", req: "Requisitos legales SST (Ley 29783)", docs: ["Matriz legal SST"] },
    { clausula: "6.2", req: "Objetivos de SST", docs: ["Objetivos SST", "Indicadores IF/IS/IA"] },
    { clausula: "7.2", req: "Competencia en SST", docs: ["Programa de capacitaci\u00f3n", "Registros SCTR"] },
    { clausula: "8.1", req: "Control operacional SST", docs: ["PETAR", "ATS", "Procedimientos de trabajo seguro"] },
    { clausula: "8.1.2", req: "Jerarqu\u00eda de controles", docs: ["Controles operacionales", "EPP"] },
    { clausula: "8.2", req: "Preparaci\u00f3n y respuesta ante emergencias", docs: ["Plan de emergencias", "Simulacros"] },
    { clausula: "9.1", req: "Seguimiento SST", docs: ["Estad\u00edsticas SST", "Inspecciones"] },
    { clausula: "9.2", req: "Auditor\u00eda interna SST", docs: ["Programa e informes"] },
    { clausula: "10.2", req: "Investigaci\u00f3n de incidentes y NC", docs: ["Registros de investigaci\u00f3n"] }
  ],
  "37001": [
    { clausula: "4.5", req: "Evaluaci\u00f3n del riesgo de soborno", docs: ["Matriz de riesgos de soborno"] },
    { clausula: "5.2", req: "Pol\u00edtica antisoborno", docs: ["Pol\u00edtica firmada", "Difusi\u00f3n"] },
    { clausula: "5.3", req: "Funci\u00f3n de cumplimiento", docs: ["Designaci\u00f3n del Oficial"] },
    { clausula: "7.2", req: "Competencia antisoborno", docs: ["Capacitaci\u00f3n antisoborno", "C\u00f3digo de \u00e9tica"] },
    { clausula: "8.2", req: "Debida diligencia", docs: ["Procedimiento de due diligence"] },
    { clausula: "8.7", req: "Regalos y hospitalidad", docs: ["Registro de regalos"] },
    { clausula: "8.9", req: "Canal de denuncias", docs: ["Canal de denuncias", "Protecci\u00f3n al denunciante"] },
    { clausula: "8.10", req: "Investigaci\u00f3n de soborno", docs: ["Procedimiento de investigaci\u00f3n"] },
    { clausula: "9.2", req: "Auditor\u00eda interna antisoborno", docs: ["Programa e informes"] },
    { clausula: "9.4", req: "Informes al \u00f3rgano de gobierno", docs: ["Reportes peri\u00f3dicos"] }
  ]
};

var AUDIT_TYPES = [
  { id: "interna", label: "Auditor\u00eda Interna", desc: "Primera parte seg\u00fan cl\u00e1usula 9.2", icon: "\uD83D\uDD0D", color: C.pr },
  { id: "mintra", label: "Auditor\u00eda MINTRA / SUNAFIL", desc: "Verificaci\u00f3n Ley 29783 y D.S. 005-2012-TR", icon: "\uD83C\uDFDB\uFE0F", color: C.wn },
  { id: "homologacion", label: "Auditor\u00eda de Homologaci\u00f3n", desc: "Evaluaci\u00f3n de contratistas", icon: "\uD83E\uDD1D", color: C.ac },
  { id: "certificacion", label: "Auditor\u00eda de Certificaci\u00f3n (3ra Parte)", desc: "SGS, Bureau Veritas, T\u00dcV, etc.", icon: "\uD83C\uDFC5", color: C.pp },
  { id: "seguimiento", label: "Auditor\u00eda de Seguimiento", desc: "Cierre de NC y eficacia", icon: "\uD83D\uDCCB", color: C.cy }
];

var AUDIT_SYSTEMS = [
  { id: "9001", label: "ISO 9001:2015 \u2014 Calidad", color: C.i9, icon: "\u2B50" },
  { id: "14001", label: "ISO 14001:2015 \u2014 Ambiental", color: C.i14, icon: "\uD83C\uDF3F" },
  { id: "45001", label: "ISO 45001:2018 \u2014 SST", color: C.i45, icon: "\uD83D\uDEE1\uFE0F" },
  { id: "37001", label: "ISO 37001:2016 \u2014 Antisoborno", color: C.i37, icon: "\uD83D\uDEAB" },
  { id: "integrado", label: "SIG Completo (Integrado)", color: C.tl, icon: "\uD83D\uDD17" }
];

// HTML export builder
function buildReportHTML(r) {
  var rs = r.resumen_hallazgos || {};
  var h = r.hallazgos || [];
  var pa = r.plan_accion_sugerido || [];
  var recs = r.recomendaciones_generales || [];
  var s = "border:1px solid #ccc;padding:6px";

  function typeStyle(t) {
    if (t === "nc_mayor") return "background:#ffe0e0;color:#d63040";
    if (t === "nc_menor") return "background:#fff3cd;color:#e09500";
    if (t === "observacion") return "background:#cce5ff;color:#2d7ff9";
    if (t === "fortaleza") return "background:#d4edda;color:#00b377";
    return "background:#e8daff;color:#8c6bfa";
  }
  function riskBg(rk) {
    if (rk === "alto") return "background:#ffe0e0";
    if (rk === "medio") return "background:#fff3cd";
    return "background:#d4edda";
  }

  var hRows = h.map(function(x) {
    return "<tr><td style='" + s + ";font-weight:bold;text-align:center'>" + (x.numero || "") +
      "</td><td style='" + s + ";text-align:center'><span style='padding:2px 8px;border-radius:12px;font-size:9px;font-weight:bold;" + typeStyle(x.tipo) + "'>" + (x.tipo || "").replace(/_/g, " ").toUpperCase() +
      "</span></td><td style='" + s + ";text-align:center;font-weight:bold'>" + (x.clausula || "") +
      "</td><td style='" + s + ";text-align:center'>" + (x.norma || "") +
      "</td><td style='" + s + "'>" + (x.descripcion || "") +
      "</td><td style='" + s + ";font-size:10px'>" + (x.evidencia || "") +
      "</td><td style='" + s + ";text-align:center'><span style='padding:2px 6px;border-radius:8px;font-size:9px;" + riskBg(x.riesgo) + "'>" + (x.riesgo || "").toUpperCase() +
      "</span></td><td style='" + s + ";font-size:10px'>" + (x.recomendacion || "") + "</td></tr>";
  }).join("");

  var pRows = pa.map(function(p) {
    return "<tr><td style='" + s + ";font-weight:bold'>" + (p.hallazgo || "") +
      "</td><td style='" + s + "'>" + (p.accion || "") +
      "</td><td style='" + s + "'>" + (p.responsable || "") +
      "</td><td style='" + s + "'>" + (p.plazo || "") + "</td></tr>";
  }).join("");

  var recItems = recs.map(function(rc) { return "<li style='margin:4px 0'>" + rc + "</li>"; }).join("");

  return [
    "<!DOCTYPE html><html><head><meta charset='UTF-8'><title>" + (r.titulo || "Informe") + "</title>",
    "<style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Segoe UI,sans-serif;font-size:11px;color:#1a1a2e;padding:30px;max-width:1000px;margin:0 auto}",
    ".hdr{border:2px solid #1a1a2e;padding:15px;margin-bottom:20px;text-align:center}.hdr h1{font-size:16px;color:#2d7ff9;margin-bottom:5px}",
    ".mt{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin:15px 0;font-size:10px}.mi{border:1px solid #ddd;padding:6px 10px;border-radius:4px}.mi strong{color:#2d7ff9}",
    ".sec{margin:20px 0}.sec h2{font-size:13px;color:#2d7ff9;border-bottom:2px solid #2d7ff9;padding-bottom:4px;margin-bottom:10px}.sec p{line-height:1.6}",
    "table{width:100%;border-collapse:collapse;margin:10px 0;font-size:10px}th{background:#f0f4f8;border:1px solid #ccc;padding:6px;font-size:9px;text-transform:uppercase}",
    ".sg{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin:15px 0}.sc{border:1px solid #ddd;border-radius:8px;padding:10px;text-align:center}.sc .v{font-size:24px;font-weight:bold}",
    ".ft{margin-top:30px;border-top:2px solid #1a1a2e;padding-top:10px;text-align:center;font-size:9px;color:#666}",
    "@media print{body{padding:15px}}</style></head><body>",
    "<div class='hdr'><p style='font-size:10px;color:#666'>ISO 19011:2018</p><h1>" + (r.titulo || "INFORME DE AUDITORIA") + "</h1><h2>" + (r.normas_referencia || "") + "</h2><p>N: " + (r.numero || "") + " | Fecha: " + (r.fecha || "") + "</p></div>",
    "<div class='mt'><div class='mi'><strong>Tipo:</strong> " + (r.tipo_auditoria || "") + "</div><div class='mi'><strong>Normas:</strong> " + (r.normas_referencia || "") + "</div><div class='mi'><strong>Area:</strong> " + (r.area_auditada || "") + "</div><div class='mi'><strong>Auditor:</strong> " + (r.auditor_lider || "") + "</div><div class='mi'><strong>Equipo:</strong> " + (r.equipo_auditor || "") + "</div><div class='mi'><strong>Metodo:</strong> " + (r.metodo || "") + "</div></div>",
    "<div class='sec'><h2>1. OBJETIVO</h2><p>" + (r.objetivo || "") + "</p></div>",
    "<div class='sec'><h2>2. ALCANCE</h2><p>" + (r.alcance || "") + "</p></div>",
    "<div class='sec'><h2>3. CRITERIOS</h2><p>" + (r.criterios_auditoria || "") + "</p></div>",
    "<div class='sec'><h2>4. RESUMEN EJECUTIVO</h2><p>" + (r.resumen_ejecutivo || "") + "</p></div>",
    "<div class='sec'><h2>5. RESUMEN DE HALLAZGOS</h2><div class='sg'>",
    "<div class='sc' style='border-color:#d63040'><div class='v' style='color:#d63040'>" + (rs.nc_mayores || 0) + "</div><div>NC Mayores</div></div>",
    "<div class='sc' style='border-color:#e09500'><div class='v' style='color:#e09500'>" + (rs.nc_menores || 0) + "</div><div>NC Menores</div></div>",
    "<div class='sc' style='border-color:#2d7ff9'><div class='v' style='color:#2d7ff9'>" + (rs.observaciones || 0) + "</div><div>Observaciones</div></div>",
    "<div class='sc' style='border-color:#8c6bfa'><div class='v' style='color:#8c6bfa'>" + (rs.oportunidades_mejora || 0) + "</div><div>Oport. Mejora</div></div>",
    "<div class='sc' style='border-color:#00b377'><div class='v' style='color:#00b377'>" + (rs.fortalezas || 0) + "</div><div>Fortalezas</div></div>",
    "</div></div>",
    "<div class='sec'><h2>6. HALLAZGOS</h2><table><thead><tr><th>No</th><th>Tipo</th><th>Clausula</th><th>Norma</th><th>Descripcion</th><th>Evidencia</th><th>Riesgo</th><th>Recomendacion</th></tr></thead><tbody>" + hRows + "</tbody></table></div>",
    "<div class='sec'><h2>7. CONCLUSIONES</h2><p>" + (r.conclusion || "") + "</p></div>",
    "<div class='sec'><h2>8. RECOMENDACIONES</h2><ul>" + recItems + "</ul></div>",
    "<div class='sec'><h2>9. PLAN DE ACCION</h2><table><thead><tr><th>Hallazgo</th><th>Accion</th><th>Responsable</th><th>Plazo</th></tr></thead><tbody>" + pRows + "</tbody></table></div>",
    "<div class='sec'><h2>10. PROXIMA AUDITORIA</h2><p>" + (r.proxima_auditoria || "") + "</p></div>",
    "<div class='ft'><p><strong>" + (r.declaracion_confidencialidad || "Documento confidencial") + "</strong></p><p>SIG Construccion 360 | ISO 19011:2018</p></div>",
    "</body></html>"
  ].join("\n");
}

function downloadHTML(name, html) {
  var blob = new Blob([html], { type: "text/html;charset=utf-8" });
  var url = URL.createObjectURL(blob);
  var a = document.createElement("a");
  a.href = url;
  a.download = name;
  a.click();
  URL.revokeObjectURL(url);
}

// ═══ SECTORS LIST ═══
var SECTORS = [
  "Construccion","Mineria","Energia y Gas","Petroleo y Petroquimica","Manufactura",
  "Agroindustria","Pesca y Acuicultura","Transporte y Logistica","Telecomunicaciones",
  "Salud y Farmaceutica","Educacion","Turismo y Hoteleria","Servicios Financieros",
  "Tecnologia e Informatica","Alimentos y Bebidas","Textil y Confecciones",
  "Quimica e Industria","Inmobiliaria","Retail y Comercio","Saneamiento y Agua",
  "Metalurgia y Siderurgia","Cementos y Materiales","Automotriz","Defensa y Seguridad",
  "Gobierno y Sector Publico","Medio Ambiente y Residuos","Consultoria"
];

// ═══ DOCUMENT DATABASE ═══
var DOCUMENTS = [
  { id:"DOC-001", name:"Manual del SIG", iso:"9001", area:"Direccion", pdca:"P", status:"vigente", version:"4.0", date:"2025-11-10", pages:42 },
  { id:"DOC-002", name:"Politica Integrada SIG", iso:"multi", area:"Direccion", pdca:"P", status:"vigente", version:"3.2", date:"2025-10-15", pages:4 },
  { id:"DOC-003", name:"Mapa de Procesos", iso:"9001", area:"Calidad", pdca:"P", status:"vigente", version:"2.1", date:"2025-09-20", pages:8 },
  { id:"DOC-004", name:"Matriz IPERC", iso:"45001", area:"SSOMA", pdca:"P", status:"vigente", version:"5.0", date:"2025-12-01", pages:35 },
  { id:"DOC-005", name:"Plan de Gestion Ambiental", iso:"14001", area:"Ambiental", pdca:"P", status:"vigente", version:"3.0", date:"2025-11-05", pages:28 },
  { id:"DOC-006", name:"Procedimiento Control Documentos", iso:"9001", area:"Calidad", pdca:"D", status:"vigente", version:"4.1", date:"2025-10-22", pages:12 },
  { id:"DOC-007", name:"PETAR - Trabajos en Altura", iso:"45001", area:"SSOMA", pdca:"D", status:"vigente", version:"3.3", date:"2025-11-18", pages:6 },
  { id:"DOC-008", name:"ATS - Analisis de Trabajo Seguro", iso:"45001", area:"SSOMA", pdca:"D", status:"vigente", version:"2.8", date:"2025-12-10", pages:4 },
  { id:"DOC-009", name:"Procedimiento Gestion Residuos", iso:"14001", area:"Ambiental", pdca:"D", status:"vigente", version:"2.5", date:"2025-10-30", pages:15 },
  { id:"DOC-010", name:"Registro No Conformidades", iso:"9001", area:"Calidad", pdca:"C", status:"vigente", version:"3.7", date:"2025-11-25", pages:18 },
  { id:"DOC-011", name:"Informe Auditoria Interna", iso:"multi", area:"Calidad", pdca:"C", status:"revision", version:"2.0", date:"2025-12-05", pages:32 },
  { id:"DOC-012", name:"Accion Correctiva AC-2025-041", iso:"9001", area:"Produccion", pdca:"A", status:"abierto", version:"1.0", date:"2025-12-12", pages:3 },
  { id:"DOC-013", name:"Plan Emergencias y Evacuacion", iso:"45001", area:"SSOMA", pdca:"P", status:"vigente", version:"4.2", date:"2025-09-15", pages:45 },
  { id:"DOC-014", name:"Matriz Aspectos Ambientales", iso:"14001", area:"Ambiental", pdca:"P", status:"vigente", version:"3.1", date:"2025-10-08", pages:22 },
  { id:"DOC-015", name:"Politica Antisoborno", iso:"37001", area:"Compliance", pdca:"P", status:"vigente", version:"2.0", date:"2025-08-20", pages:8 },
  { id:"DOC-016", name:"Registro Due Diligence", iso:"37001", area:"Compliance", pdca:"D", status:"vigente", version:"1.5", date:"2025-11-30", pages:14 },
  { id:"DOC-017", name:"Procedimiento LOTO", iso:"45001", area:"SSOMA", pdca:"D", status:"vigente", version:"2.2", date:"2025-10-12", pages:10 },
  { id:"DOC-018", name:"Plan de Capacitacion Anual", iso:"multi", area:"RRHH", pdca:"P", status:"vigente", version:"2.0", date:"2025-08-01", pages:16 },
  { id:"DOC-019", name:"Procedimiento Excavaciones", iso:"45001", area:"SSOMA", pdca:"D", status:"vigente", version:"3.0", date:"2025-09-25", pages:12 },
  { id:"DOC-020", name:"Matriz de Riesgos Soborno", iso:"37001", area:"Compliance", pdca:"P", status:"vigente", version:"2.3", date:"2025-11-20", pages:20 },
  { id:"DOC-021", name:"Procedimiento Izaje y Gruas", iso:"45001", area:"SSOMA", pdca:"D", status:"vigente", version:"3.5", date:"2025-10-05", pages:14 },
  { id:"DOC-022", name:"Control Operacional Ambiental", iso:"14001", area:"Ambiental", pdca:"D", status:"vigente", version:"2.8", date:"2025-11-15", pages:18 },
  { id:"DOC-023", name:"Revision por la Direccion", iso:"multi", area:"Direccion", pdca:"C", status:"vigente", version:"2.1", date:"2025-12-01", pages:25 },
  { id:"DOC-024", name:"Programa Auditorias Anuales", iso:"multi", area:"Calidad", pdca:"C", status:"vigente", version:"2.0", date:"2025-07-15", pages:10 },
  { id:"DOC-025", name:"Canal de Denuncias Etico", iso:"37001", area:"Compliance", pdca:"D", status:"vigente", version:"1.8", date:"2025-09-10", pages:8 },
];

// ═══ LEGAL REQUIREMENTS DATABASE ═══
var LEGAL_DB = [
  { id:"LEG-001", norma:"Ley 29783", titulo:"Ley de Seguridad y Salud en el Trabajo", tipo:"Ley", entidad:"Congreso", aplica:["Construccion","Mineria","Manufactura","Energia y Gas","Todas"], iso:"45001", estado:"vigente", ultima:"DS 001-2025-TR (Feb 2025)", riesgo:"critico", cumplimiento:88 },
  { id:"LEG-002", norma:"DS 005-2012-TR", titulo:"Reglamento de la Ley 29783", tipo:"Decreto Supremo", entidad:"MTPE", aplica:["Todas"], iso:"45001", estado:"vigente", ultima:"DS 020-2024-TR (Nov 2024)", riesgo:"critico", cumplimiento:85 },
  { id:"LEG-003", norma:"G.050", titulo:"Seguridad durante la Construccion", tipo:"Norma Tecnica", entidad:"MVCS", aplica:["Construccion"], iso:"45001", estado:"vigente", ultima:"RM 050-2024-VIVIENDA", riesgo:"critico", cumplimiento:90 },
  { id:"LEG-004", norma:"Ley 28611", titulo:"Ley General del Ambiente", tipo:"Ley", entidad:"Congreso", aplica:["Todas"], iso:"14001", estado:"vigente", ultima:"DL 1613 (Dic 2024)", riesgo:"alto", cumplimiento:82 },
  { id:"LEG-005", norma:"DS 017-2015-PRODUCE", titulo:"Reglamento de Gestion Ambiental Industrial", tipo:"Decreto Supremo", entidad:"PRODUCE", aplica:["Manufactura","Quimica e Industria"], iso:"14001", estado:"vigente", ultima:"Mod. 2024", riesgo:"medio", cumplimiento:78 },
  { id:"LEG-006", norma:"DS 011-2019-TR", titulo:"Reglamento SST en Construccion", tipo:"Decreto Supremo", entidad:"MTPE", aplica:["Construccion"], iso:"45001", estado:"vigente", ultima:"RM 245-2024-TR (Set 2024)", riesgo:"critico", cumplimiento:92 },
  { id:"LEG-007", norma:"Ley 27446", titulo:"Ley del SEIA", tipo:"Ley", entidad:"Congreso", aplica:["Construccion","Mineria","Energia y Gas","Inmobiliaria"], iso:"14001", estado:"vigente", ultima:"DS 004-2024-MINAM", riesgo:"alto", cumplimiento:75 },
  { id:"LEG-008", norma:"Ley 30424", titulo:"Responsabilidad Administrativa de PJ", tipo:"Ley", entidad:"Congreso", aplica:["Todas"], iso:"37001", estado:"vigente", ultima:"DL 1610 (Nov 2024)", riesgo:"alto", cumplimiento:70 },
  { id:"LEG-009", norma:"DS 002-2019-JUS", titulo:"Reglamento Ley 30424 - Compliance", tipo:"Decreto Supremo", entidad:"MINJUS", aplica:["Todas"], iso:"37001", estado:"vigente", ultima:"DS 010-2024-JUS (Oct 2024)", riesgo:"alto", cumplimiento:68 },
  { id:"LEG-010", norma:"Ley 29325", titulo:"Ley del SINEFA", tipo:"Ley", entidad:"Congreso", aplica:["Mineria","Energia y Gas","Construccion"], iso:"14001", estado:"vigente", ultima:"DL 1607 (2024)", riesgo:"medio", cumplimiento:80 },
  { id:"LEG-011", norma:"DS 024-2016-EM", titulo:"Reglamento SST en Mineria", tipo:"Decreto Supremo", entidad:"MINEM", aplica:["Mineria"], iso:"45001", estado:"vigente", ultima:"DS 023-2024-EM (Ago 2024)", riesgo:"critico", cumplimiento:87 },
  { id:"LEG-012", norma:"Ley 26842", titulo:"Ley General de Salud", tipo:"Ley", entidad:"Congreso", aplica:["Todas"], iso:"45001", estado:"vigente", ultima:"Mod. DL 1620 (2025)", riesgo:"medio", cumplimiento:90 },
  { id:"LEG-013", norma:"DS 003-2013-VIVIENDA", titulo:"Reglamento para Gestion de Residuos Solidos de la Construccion", tipo:"Decreto Supremo", entidad:"MVCS", aplica:["Construccion"], iso:"14001", estado:"vigente", ultima:"RM 120-2024-VIVIENDA", riesgo:"alto", cumplimiento:73 },
  { id:"LEG-014", norma:"Ley 28256", titulo:"Ley de Transporte de Materiales Peligrosos", tipo:"Ley", entidad:"Congreso", aplica:["Transporte y Logistica","Quimica e Industria","Mineria"], iso:"45001", estado:"vigente", ultima:"DS 005-2024-MTC", riesgo:"alto", cumplimiento:80 },
  { id:"LEG-015", norma:"DS 015-2006-EM", titulo:"Reglamento Proteccion Ambiental Electricidad", tipo:"Decreto Supremo", entidad:"MINEM", aplica:["Energia y Gas"], iso:"14001", estado:"vigente", ultima:"RM 380-2024-MINEM", riesgo:"medio", cumplimiento:76 },
];

// ═══ REUSABLE COMPONENTS ═══
function Btn(props) {
  var base = {
    padding: props.sm ? "5px 10px" : "8px 16px",
    borderRadius: 8, border: "1px solid " + C.bd, cursor: "pointer",
    fontSize: props.sm ? 10 : 11, fontWeight: 600, display: "inline-flex",
    alignItems: "center", gap: 6, transition: "all 0.2s",
    fontFamily: "inherit",
  };
  if (props.primary) {
    base.background = C.pr; base.color = "#fff"; base.border = "none";
  } else if (props.accent) {
    base.background = C.ac; base.color = "#000"; base.border = "none";
  } else if (props.danger) {
    base.background = C.dn; base.color = "#fff"; base.border = "none";
  } else {
    base.background = C.sa; base.color = C.tm;
  }
  return React.createElement("button", {
    style: Object.assign({}, base, props.style || {}),
    onClick: props.onClick, disabled: props.disabled
  }, props.children);
}

function Card(props) {
  return React.createElement("div", {
    style: Object.assign({
      background: C.card, border: "1px solid " + C.bd, borderRadius: 12,
      padding: props.p || 16, overflow: "hidden",
    }, props.style || {}),
    onClick: props.onClick,
  }, props.children);
}

function Badge(props) {
  var colors = {
    green: { bg: C.ac + "20", color: C.ac },
    red: { bg: C.dn + "20", color: C.dn },
    yellow: { bg: C.wn + "20", color: C.wn },
    blue: { bg: C.pr + "20", color: C.pr },
    purple: { bg: C.pp + "20", color: C.pp },
    cyan: { bg: C.cy + "20", color: C.cy },
  };
  var c = colors[props.color] || colors.blue;
  return React.createElement("span", {
    style: {
      padding: "3px 8px", borderRadius: 6, fontSize: 9, fontWeight: 700,
      background: c.bg, color: c.color, letterSpacing: 0.5,
      textTransform: "uppercase"
    }
  }, props.children);
}

function Modal(props) {
  if (!props.open) return null;
  return React.createElement("div", {
    style: {
      position: "fixed", inset: 0, zIndex: 2000,
      display: "flex", alignItems: "center", justifyContent: "center",
      background: "rgba(0,0,0,0.7)", backdropFilter: "blur(4px)"
    },
    onClick: function(e) { if (e.target === e.currentTarget) props.onClose(); }
  },
    React.createElement("div", {
      style: {
        background: C.sf, border: "1px solid " + C.bd, borderRadius: 16,
        width: props.wide ? "90%" : "560px", maxWidth: props.wide ? 1000 : 560,
        maxHeight: "85vh", overflow: "auto", padding: 24,
      }
    },
      React.createElement("div", {
        style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 16 }
      },
        React.createElement("h3", { style: { margin: 0, fontSize: 16, fontWeight: 700, color: C.tx } }, props.title),
        React.createElement("button", {
          onClick: props.onClose,
          style: { background: "none", border: "none", color: C.tm, cursor: "pointer" }
        }, React.createElement(Icons.X))
      ),
      props.children
    )
  );
}

function TabBar(props) {
  return React.createElement("div", {
    style: {
      display: "flex", gap: 2, padding: 3, background: C.sa,
      borderRadius: 10, marginBottom: 16, flexWrap: "wrap",
    }
  }, props.tabs.map(function(t) {
    var active = props.active === t.key;
    return React.createElement("button", {
      key: t.key,
      onClick: function() { props.onChange(t.key); },
      style: {
        padding: "7px 14px", borderRadius: 8, border: "none", cursor: "pointer",
        fontSize: 10, fontWeight: 600, fontFamily: "inherit",
        background: active ? C.pr : "transparent",
        color: active ? "#fff" : C.tm,
        transition: "all 0.2s",
      }
    }, t.icon ? React.createElement("span", { style: { marginRight: 5 } }, React.createElement(t.icon)) : null, t.label);
  }));
}

function KPICard(props) {
  var glow = props.glow || C.pr;
  return React.createElement("div", {
    style: {
      background: C.card, border: "1px solid " + C.bd, borderRadius: 12,
      padding: 16, position: "relative", overflow: "hidden", flex: 1, minWidth: 150,
    }
  },
    React.createElement("div", {
      style: {
        position: "absolute", top: -20, right: -20, width: 60, height: 60,
        borderRadius: "50%", background: glow, opacity: 0.08, filter: "blur(12px)"
      }
    }),
    React.createElement("div", {
      style: { display: "flex", alignItems: "center", gap: 8, marginBottom: 8 }
    },
      React.createElement("div", {
        style: {
          width: 32, height: 32, borderRadius: 8,
          background: glow + "18", display: "flex",
          alignItems: "center", justifyContent: "center", color: glow,
        }
      }, props.icon),
      React.createElement("span", { style: { fontSize: 10, color: C.tm, fontWeight: 500 } }, props.label)
    ),
    React.createElement("div", {
      style: { fontSize: 22, fontWeight: 800, color: C.tx, marginBottom: 4 }
    }, props.value),
    props.sub ? React.createElement("div", {
      style: { fontSize: 9, color: props.subColor || C.ac, fontWeight: 600 }
    }, props.sub) : null
  );
}

function ProgressBar(props) {
  var pct = props.value || 0;
  var clr = pct >= 85 ? C.ac : pct >= 60 ? C.wn : C.dn;
  return React.createElement("div", {
    style: { width: "100%", height: props.h || 6, borderRadius: 4, background: C.sa, overflow: "hidden" }
  },
    React.createElement("div", {
      style: {
        height: "100%", borderRadius: 4,
        width: pct + "%", background: props.color || clr,
        transition: "width 0.5s ease",
      }
    })
  );
}

function SelectField(props) {
  return React.createElement("div", { style: { marginBottom: 12 } },
    props.label ? React.createElement("label", {
      style: { fontSize: 10, fontWeight: 600, color: C.tm, display: "block", marginBottom: 4 }
    }, props.label) : null,
    React.createElement("select", {
      value: props.value, onChange: function(e) { props.onChange(e.target.value); },
      style: {
        width: "100%", padding: "8px 12px", borderRadius: 8, fontSize: 11,
        background: C.sa, border: "1px solid " + C.bd, color: C.tx,
        fontFamily: "inherit", outline: "none",
      }
    },
      React.createElement("option", { value: "" }, props.placeholder || "Seleccionar..."),
      (props.options || []).map(function(o) {
        var val = typeof o === "string" ? o : o.value;
        var lab = typeof o === "string" ? o : o.label;
        return React.createElement("option", { key: val, value: val }, lab);
      })
    )
  );
}

function InputField(props) {
  return React.createElement("div", { style: { marginBottom: 12 } },
    props.label ? React.createElement("label", {
      style: { fontSize: 10, fontWeight: 600, color: C.tm, display: "block", marginBottom: 4 }
    }, props.label) : null,
    React.createElement("input", {
      type: props.type || "text", value: props.value,
      onChange: function(e) { props.onChange(e.target.value); },
      placeholder: props.placeholder || "",
      style: {
        width: "100%", padding: "8px 12px", borderRadius: 8, fontSize: 11,
        background: C.sa, border: "1px solid " + C.bd, color: C.tx,
        fontFamily: "inherit", outline: "none", boxSizing: "border-box",
      }
    })
  );
}

// ═══ DOC TEMPLATE GENERATOR ═══
function generateDocHTML(doc) {
  var html = "<!DOCTYPE html><html><head><meta charset='UTF-8'><title>" + doc.name + "</title>";
  html += "<style>body{font-family:Calibri,sans-serif;margin:40px;color:#222}";
  html += ".header{border:2px solid #333;padding:12px;display:flex;justify-content:space-between;margin-bottom:20px}";
  html += ".header-logo{width:120px;height:60px;border:1px dashed #999;display:flex;align-items:center;justify-content:center;color:#999;font-size:11px}";
  html += ".header-info{text-align:right;font-size:11px;line-height:1.6}";
  html += ".header-title{text-align:center;flex:1;font-size:16px;font-weight:bold}";
  html += "h1{color:#1a5276;border-bottom:2px solid #2d7ff9;padding-bottom:8px}";
  html += "h2{color:#2d7ff9;margin-top:24px}h3{color:#444}";
  html += "table{width:100%;border-collapse:collapse;margin:12px 0}";
  html += "th,td{border:1px solid #ccc;padding:8px;text-align:left;font-size:12px}";
  html += "th{background:#2d7ff9;color:white}";
  html += ".footer{margin-top:40px;border-top:2px solid #333;padding-top:12px;font-size:10px;color:#666}";
  html += ".signatures{display:flex;justify-content:space-between;margin-top:40px}";
  html += ".sig-block{text-align:center;width:30%;border-top:1px solid #333;padding-top:8px;font-size:11px}";
  html += "</style></head><body>";
  html += "<div class='header'><div class='header-logo'>[LOGO]</div>";
  html += "<div class='header-title'>" + doc.name.toUpperCase() + "</div>";
  html += "<div class='header-info'>Codigo: " + doc.id + "<br>Version: " + doc.version + "<br>Fecha: " + doc.date + "<br>Paginas: " + doc.pages + "</div></div>";
  html += "<h1>1. OBJETIVO</h1><p>Establecer los lineamientos para " + doc.name.toLowerCase() + " en conformidad con la norma ISO " + doc.iso + ".</p>";
  html += "<h1>2. ALCANCE</h1><p>Aplica a todas las actividades del area de " + doc.area + " y procesos relacionados.</p>";
  html += "<h1>3. REFERENCIAS NORMATIVAS</h1><ul><li>ISO " + doc.iso + "</li><li>Politica Integrada SIG</li><li>Manual del SIG</li></ul>";
  html += "<h1>4. DEFINICIONES</h1><p>[Definiciones aplicables al documento]</p>";
  html += "<h1>5. RESPONSABILIDADES</h1><table><tr><th>Cargo</th><th>Responsabilidad</th></tr>";
  html += "<tr><td>Gerente de Area</td><td>Aprobar y asegurar cumplimiento</td></tr>";
  html += "<tr><td>Supervisor</td><td>Implementar y supervisar actividades</td></tr>";
  html += "<tr><td>Trabajadores</td><td>Cumplir lineamientos establecidos</td></tr></table>";
  html += "<h1>6. DESARROLLO</h1><p>[Contenido principal del procedimiento]</p>";
  html += "<h1>7. REGISTROS</h1><table><tr><th>Codigo</th><th>Nombre</th><th>Responsable</th><th>Retencion</th></tr>";
  html += "<tr><td>" + doc.id + "-R01</td><td>Registro asociado</td><td>" + doc.area + "</td><td>3 anios</td></tr></table>";
  html += "<h1>8. CONTROL DE CAMBIOS</h1><table><tr><th>Version</th><th>Fecha</th><th>Descripcion</th></tr>";
  html += "<tr><td>" + doc.version + "</td><td>" + doc.date + "</td><td>Version vigente</td></tr></table>";
  html += "<div class='signatures'><div class='sig-block'>Elaborado por<br><br><br>_________________</div>";
  html += "<div class='sig-block'>Revisado por<br><br><br>_________________</div>";
  html += "<div class='sig-block'>Aprobado por<br><br><br>_________________</div></div>";
  html += "<div class='footer'>Documento confidencial - SIG Construccion 360 | ISO " + doc.iso + " | Ciclo PDCA: " + doc.pdca + "</div>";
  html += "</body></html>";
  return html;
}

function downloadDoc(doc) {
  var html = generateDocHTML(doc);
  var blob = new Blob([html], { type: "text/html" });
  var url = URL.createObjectURL(blob);
  var a = document.createElement("a");
  a.href = url; a.download = doc.id + "_" + doc.name.replace(/\s+/g, "_") + ".html";
  document.body.appendChild(a); a.click(); document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// ═══════════════════════════════════════════════════════════════════════════
// MAIN APP
// ═══════════════════════════════════════════════════════════════════════════
function SIGConstruccion360() {
  var _s = useState, _e = useEffect, _m = useMemo, _c = useCallback;
  var s = _s("dashboard"), view = s[0], setView = s[1];
  var s2 = _s(true), sbOpen = s2[0], setSbOpen = s2[1];
  var s3 = _s(false), mobMenu = s3[0], setMobMenu = s3[1];
  var s4 = _s(""), empresa = s4[0], setEmpresa = s4[1];
  var s5 = _s(null), previewDoc = s5[0], setPreviewDoc = s5[1];
  var s6 = _s("general"), dashTab = s6[0], setDashTab = s6[1];
  var s7 = _s(0), legalStep = s7[0], setLegalStep = s7[1];
  var s8 = _s({ sector: "Construccion", alcance: "", workers: "100-500" }), legalProfile = s8[0], setLegalProfile = s8[1];
  var s9 = _s(""), docSearch = s9[0], setDocSearch = s9[1];
  var s10 = _s("all"), docFilter = s10[0], setDocFilter = s10[1];
  var s11 = _s(0), aiStep = s11[0], setAiStep = s11[1];
  var s12 = _s({ tipo: "", sistemas: [], alcance: "", area: "", objetivo: "", auditor_lider: "", equipo: "", fecha: _aToday() }), aiConfig = s12[0], setAiConfig = s12[1];
  var s13 = _s([]), aiFiles = s13[0], setAiFiles = s13[1];
  var s14 = _s({}), aiFileContents = s14[0], setAiFileContents = s14[1];
  var sA1 = _s(false), aiAnalyzing = sA1[0], setAiAnalyzing = sA1[1];
  var sA2 = _s(0), aiProgress = sA2[0], setAiProgress = sA2[1];
  var sA3 = _s(null), aiReport = sA3[0], setAiReport = sA3[1];
  var sA4 = _s([]), aiMessages = sA4[0], setAiMessages = sA4[1];
  var sA5 = _s([]), auditReports = sA5[0], setAuditReports = sA5[1];
  var fileInputRef = useRef(null);
  var s15 = _s("dashboard-q"), qTab = s15[0], setQTab = s15[1];
  var s16 = _s("dashboard-a"), aTab = s16[0], setATab = s16[1];
  var s17 = _s("dashboard-s"), sTab = s17[0], setSTab = s17[1];
  var s18 = _s("dashboard-ab"), abTab = s18[0], setAbTab = s18[1];
  var s19 = _s([]), ncList = s19[0], setNcList = s19[1];
  var s20 = _s(false), showNcForm = s20[0], setShowNcForm = s20[1];
  var s21 = _s({ tipo:"menor", proceso:"", desc:"", responsable:"", plazo:"" }), ncForm = s21[0], setNcForm = s21[1];
  var s22 = _s([]), inspList = s22[0], setInspList = s22[1];

  // ═══ EDITABLE DATABASES STATE ═══
  var s23 = _s([
    {id:"INC-001",tipo:"Incidente Peligroso",fecha:"2025-12-08",area:"Obras civiles",desc:"Desprendimiento de material en excavacion profunda sin previo aviso",lesion:"Ninguna",diasP:0,invest:"Completa",accion:"Reforzar entibado + vigias permanentes",est:"cerrado"},
    {id:"INC-002",tipo:"Cuasi Accidente",fecha:"2025-12-15",area:"Estructura",desc:"Herramienta cae desde andamio 3er nivel hacia zona de transito",lesion:"Ninguna",diasP:0,invest:"Completa",accion:"Rodapie en andamios + malla perimetral",est:"cerrado"},
    {id:"INC-003",tipo:"Accidente Leve",fecha:"2025-12-20",area:"Almacen",desc:"Corte superficial en mano por manipulacion de laminas metalicas sin guante",lesion:"Corte leve",diasP:0,invest:"Completa",accion:"Capacitacion uso EPP + supervision",est:"cerrado"},
    {id:"INC-004",tipo:"Incidente Peligroso",fecha:"2025-12-28",area:"Inst. electricas",desc:"Arco electrico en tablero provisional por conexion defectuosa",lesion:"Ninguna",diasP:0,invest:"En curso",accion:"Revision total tableros + LOTO obligatorio",est:"abierto"},
    {id:"INC-005",tipo:"Cuasi Accidente",fecha:"2026-01-05",area:"Equipos pesados",desc:"Retroexcavadora gira sin verificar punto ciego con personal cercano",lesion:"Ninguna",diasP:0,invest:"Completa",accion:"Vigia obligatorio + alarma retroceso",est:"cerrado"},
  ]), incidentsDB = s23[0], setIncidentsDB = s23[1];
  var s24 = _s(false), showIncForm = s24[0], setShowIncForm = s24[1];
  var s25 = _s({tipo:"",fecha:"",area:"",desc:"",lesion:"Ninguna",diasP:0}), incForm = s25[0], setIncForm = s25[1];
  var s26 = _s(null), editDbRow = s26[0], setEditDbRow = s26[1];
  var s27 = _s(null), editDbModule = s27[0], setEditDbModule = s27[1];
  var s28 = _s(""), mlSearch = s28[0], setMlSearch = s28[1];
  var s29 = _s("all"), mlFilter = s29[0], setMlFilter = s29[1];
  var s30 = _s(false), showImport = s30[0], setShowImport = s30[1];
  var s31 = _s(""), importText = s31[0], setImportText = s31[1];
  var s32 = _s(DOCUMENTS.map(function(d,i){ return Object.assign({},d,{mlId:i+1,origen:"Sistema",fechaAlta:d.date,responsable:"Coord. SIG",ubicacion:"Servidor SIG",retencion:"3 anios"});})), masterListDB = s32[0], setMasterListDB = s32[1];
  var s33 = _s("dashboard-s"), sTab2 = s33[0], setSTab2 = s33[1]; // separate from sTab for incidentes

  var titles = {
    dashboard: "Dashboard BI",
    documents: "Control Documental",
    "ai-audit": "Auditoria IA",
    legal: "Requisitos Legales",
    "lista-maestra": "Lista Maestra de Documentos",
    recursos: "Recursos PDCA",
    "iso9001-v2": "ISO 9001 Calidad v02",
    "iso14001-v2": "ISO 14001 Ambiente v02",
    "iso45001-v2": "ISO 45001 SST v02",
    "iso37001-v2": "ISO 37001 Antisoborno v02",
    settings: "Configuracion",
  };

  var navItems = [
    { key: "dashboard", icon: Icons.Dash, label: "Dashboard BI" },
    { key: "documents", icon: Icons.Doc, label: "Control Documental" },
    { key: "lista-maestra", icon: Icons.ListIcon, label: "Lista Maestra" },
    { key: "recursos", icon: Icons.Package, label: "Recursos PDCA" },
    { key: "ai-audit", icon: Icons.Brain, label: "Auditoria IA" },
    { key: "legal", icon: Icons.Scale, label: "Requisitos Legales" },
    { key: "iso9001-v2", icon: Icons.Star, label: "ISO 9001 v02" },
    { key: "iso14001-v2", icon: Icons.Leaf, label: "ISO 14001 v02" },
    { key: "iso45001-v2", icon: Icons.Shield, label: "ISO 45001 v02" },
    { key: "iso37001-v2", icon: Icons.Gavel, label: "ISO 37001 v02" },
    { key: "settings", icon: Icons.Settings, label: "Configuracion" },
  ];

  // ═══ SIDEBAR ═══
  function Sidebar(props) {
    var mobile = props && props.mobile;
    return React.createElement("div", {
      style: {
        width: sbOpen || mobile ? 220 : 56, background: C.sf,
        borderRight: "1px solid " + C.bd, display: "flex", flexDirection: "column",
        transition: "width 0.25s", flexShrink: 0, overflow: "hidden",
        position: mobile ? "fixed" : "relative",
        top: 0, left: 0, bottom: 0, zIndex: mobile ? 1000 : 1,
      }
    },
      React.createElement("div", {
        style: {
          padding: sbOpen || mobile ? "16px 14px" : "16px 10px",
          borderBottom: "1px solid " + C.bd,
          display: "flex", alignItems: "center", gap: 10,
        }
      },
        React.createElement("div", {
          style: {
            width: 32, height: 32, borderRadius: 10,
            background: C.g1, display: "flex",
            alignItems: "center", justifyContent: "center",
            fontWeight: 800, fontSize: 14, color: "#fff", flexShrink: 0,
          }
        }, "S"),
        (sbOpen || mobile) ? React.createElement("div", null,
          React.createElement("div", { style: { fontSize: 13, fontWeight: 800, color: C.tx, lineHeight: 1.2 } }, "SIG 360"),
          React.createElement("div", { style: { fontSize: 8, color: C.td, fontWeight: 500 } }, "v7.0 Enterprise")
        ) : null
      ),
      React.createElement("nav", { style: { padding: "8px 6px", flex: 1 } },
        navItems.map(function(item) {
          var active = view === item.key;
          return React.createElement("button", {
            key: item.key,
            onClick: function() { setView(item.key); if (mobile) setMobMenu(false); },
            style: {
              display: "flex", alignItems: "center", gap: 10,
              width: "100%", padding: sbOpen || mobile ? "9px 12px" : "9px 0",
              justifyContent: sbOpen || mobile ? "flex-start" : "center",
              borderRadius: 8, border: "none", cursor: "pointer",
              background: active ? C.pr + "18" : "transparent",
              color: active ? C.pl : C.tm, fontSize: 11, fontWeight: 600,
              marginBottom: 2, transition: "all 0.15s", fontFamily: "inherit",
            }
          },
            React.createElement(item.icon),
            (sbOpen || mobile) ? React.createElement("span", null, item.label) : null
          );
        })
      ),
      (sbOpen || mobile) ? React.createElement("div", {
        style: { padding: 12, borderTop: "1px solid " + C.bd }
      },
        React.createElement("div", {
          style: {
            padding: "8px 10px", borderRadius: 8, background: C.sa,
            fontSize: 9, color: C.td, textAlign: "center"
          }
        }, "ISO 9001 \u00B7 14001 \u00B7 45001 \u00B7 37001")
      ) : null
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // EDITABLE DB VIEW (Reusable for all ISO modules)
  // ═══════════════════════════════════════════════════════════════════════
  function EditableDBView(props) {
    var _ed = _s(null), editing = _ed[0], setEditing = _ed[1];
    var _rd = _s(props.rows), rows = _rd[0], setRows = _rd[1];
    var _nf = _s(false), showNew = _nf[0], setShowNew = _nf[1];
    var _nr = _s(props.columns.map(function(){return "";})), newRow = _nr[0], setNewRow = _nr[1];

    function saveEdit(id, colIdx, val) {
      setRows(rows.map(function(r) {
        if (r.id === id) { var v = r.vals.slice(); v[colIdx] = val; return Object.assign({}, r, {vals:v}); }
        return r;
      }));
    }
    function addRow() {
      var nr = { id: rows.length + 1, vals: newRow.slice() };
      setRows(rows.concat([nr]));
      setNewRow(props.columns.map(function(){return "";}));
      setShowNew(false);
    }
    function deleteRow(id) { setRows(rows.filter(function(r){return r.id!==id;})); }

    return React.createElement("div", null,
      React.createElement(Card, { style: { padding: 16 } },
        React.createElement("div", { style: { display:"flex", justifyContent:"space-between", alignItems:"center", marginBottom:14 } },
          React.createElement("div", null,
            React.createElement("div", { style: { fontSize:13, fontWeight:700, color:C.tx } }, props.title),
            React.createElement("div", { style: { fontSize:9, color:C.td, marginTop:2 } }, "Datos editables — Fuente de Dashboard | " + rows.length + " registros")
          ),
          React.createElement("div", { style: { display:"flex", gap:6 } },
            React.createElement(Btn, { primary:true, onClick:function(){setShowNew(!showNew);} }, React.createElement(Icons.Plus), " Agregar"),
            React.createElement(Btn, { onClick:function(){ alert("Datos guardados exitosamente"); } }, React.createElement(Icons.Check), " Guardar")
          )
        ),
        showNew ? React.createElement("div", { style: { padding:12, background:C.sa, borderRadius:10, marginBottom:12 } },
          React.createElement("div", { style: { fontSize:11, fontWeight:600, color:C.tx, marginBottom:8 } }, "Nuevo Registro"),
          React.createElement("div", { style: { display:"grid", gridTemplateColumns:"repeat("+props.columns.length+",1fr)", gap:6 } },
            props.columns.map(function(col, ci) {
              return React.createElement("input", { key:ci, placeholder:col, value:newRow[ci],
                onChange:function(e){ var nr2=newRow.slice(); nr2[ci]=e.target.value; setNewRow(nr2); },
                style: { padding:"6px 8px", borderRadius:6, border:"1px solid "+C.bd, background:C.card, color:C.tx, fontSize:10, fontFamily:"inherit" }
              });
            })
          ),
          React.createElement("div", { style: { display:"flex", gap:6, marginTop:8, justifyContent:"flex-end" } },
            React.createElement(Btn, { onClick:function(){setShowNew(false);} }, "Cancelar"),
            React.createElement(Btn, { accent:true, onClick:addRow }, React.createElement(Icons.Check), " Agregar")
          )
        ) : null,
        React.createElement("div", { style: { overflowX:"auto" } },
          React.createElement("table", { style: { width:"100%", borderCollapse:"collapse", fontSize:10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom:"1px solid "+C.bd } },
              React.createElement("th", { style: { padding:"10px 8px", textAlign:"left", fontSize:8, fontWeight:700, color:C.td, textTransform:"uppercase", width:30 } }, "#"),
              props.columns.map(function(h) {
                return React.createElement("th", { key:h, style: { padding:"10px 8px", textAlign:"left", fontSize:8, fontWeight:700, color:C.td, textTransform:"uppercase" } }, h);
              }),
              React.createElement("th", { style: { padding:"10px 8px", textAlign:"center", fontSize:8, fontWeight:700, color:C.td, textTransform:"uppercase", width:80 } }, "Acciones")
            )),
            React.createElement("tbody", null, rows.map(function(r) {
              return React.createElement("tr", { key:r.id, style: { borderBottom:"1px solid "+C.bd+"50" },
                onMouseEnter:function(e){e.currentTarget.style.background=C.cardH;}, onMouseLeave:function(e){e.currentTarget.style.background="transparent";} },
                React.createElement("td", { style: { padding:"8px", color:C.td, fontSize:9 } }, r.id),
                r.vals.map(function(v, ci) {
                  var isEd = editing && editing.id === r.id && editing.col === ci;
                  return React.createElement("td", { key:ci, style: { padding:"4px 6px" } },
                    isEd ? React.createElement("input", { autoFocus:true, value:v,
                      onChange:function(e){ saveEdit(r.id, ci, e.target.value); },
                      onBlur:function(){setEditing(null);},
                      onKeyDown:function(e){if(e.key==="Enter")setEditing(null);},
                      style: { padding:"4px 6px", borderRadius:4, border:"1px solid "+props.color, background:C.sa, color:C.tx, fontSize:10, fontFamily:"inherit", width:"100%", boxSizing:"border-box" }
                    })
                    : React.createElement("span", {
                      onClick:function(){setEditing({id:r.id,col:ci});},
                      style: { cursor:"pointer", padding:"4px 6px", borderRadius:4, display:"inline-block",
                        color: ci===0?C.tx:ci===props.columns.length-1?(v==="\u2191"?C.ac:v==="\u2193"?C.ac:C.wn):C.tm,
                        fontWeight: ci===0?600:400, fontSize:10 }
                    }, v, " ", React.createElement("span",{style:{fontSize:8,color:C.td}},"\u270E"))
                  );
                }),
                React.createElement("td", { style: { padding:"8px", textAlign:"center" } },
                  React.createElement("button", { onClick:function(){deleteRow(r.id);},
                    style: { background:"none", border:"none", color:C.dn, cursor:"pointer", fontSize:10, fontWeight:600 }
                  }, "\u2716 Eliminar")
                )
              );
            }))
          )
        ),
        React.createElement("div", { style: { padding:"10px 0", fontSize:9, color:C.td, display:"flex", gap:12 } },
          React.createElement("span", null, "\u270E Click en celda para editar"),
          React.createElement("span", null, "\u2716 Eliminar registros"),
          React.createElement("span", null, "\u2713 Guardar cambios"),
          React.createElement("span", { style:{color:props.color} }, "Los cambios se reflejan en Dashboard")
        )
      )
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // DASHBOARD BI VIEW
  // ═══════════════════════════════════════════════════════════════════════
  function DashboardView() {
    var dashTabs = [
      { key: "general", label: "General", icon: Icons.Dash },
      { key: "iso9001", label: "ISO 9001 Calidad", icon: Icons.Star },
      { key: "iso14001", label: "ISO 14001 Ambiente", icon: Icons.Leaf },
      { key: "iso45001", label: "ISO 45001 SST", icon: Icons.Shield },
      { key: "iso37001", label: "ISO 37001 Antisoborno", icon: Icons.Gavel },
    ];

    // Data generators
    var trendData = [
      { mes: "Jul", calidad: 78, ambiente: 72, sst: 80, compliance: 65 },
      { mes: "Ago", calidad: 80, ambiente: 75, sst: 82, compliance: 68 },
      { mes: "Sep", calidad: 83, ambiente: 78, sst: 79, compliance: 72 },
      { mes: "Oct", calidad: 85, ambiente: 80, sst: 85, compliance: 75 },
      { mes: "Nov", calidad: 87, ambiente: 82, sst: 88, compliance: 78 },
      { mes: "Dic", calidad: 89, ambiente: 84, sst: 90, compliance: 80 },
    ];

    var radarData = [
      { subject: "Liderazgo", A: 88 }, { subject: "Planificacion", A: 82 },
      { subject: "Apoyo", A: 75 }, { subject: "Operacion", A: 90 },
      { subject: "Evaluacion", A: 78 }, { subject: "Mejora", A: 85 },
    ];

    var docsByIso = [
      { name: "ISO 9001", value: 8, color: C.i9 },
      { name: "ISO 14001", value: 5, color: C.i14 },
      { name: "ISO 45001", value: 8, color: C.i45 },
      { name: "ISO 37001", value: 4, color: C.i37 },
    ];

    var ncData = [
      { mes: "Jul", mayores: 3, menores: 8, obs: 12 },
      { mes: "Ago", mayores: 2, menores: 7, obs: 10 },
      { mes: "Sep", mayores: 1, menores: 6, obs: 9 },
      { mes: "Oct", mayores: 2, menores: 5, obs: 8 },
      { mes: "Nov", mayores: 1, menores: 4, obs: 7 },
      { mes: "Dic", mayores: 0, menores: 3, obs: 5 },
    ];

    var riskMatrix = [
      { area: "Produccion", riesgo: 85 }, { area: "SSOMA", riesgo: 92 },
      { area: "Ambiental", riesgo: 78 }, { area: "Calidad", riesgo: 88 },
      { area: "Compliance", riesgo: 72 }, { area: "Logistica", riesgo: 80 },
    ];

    function GeneralDash() {
      return React.createElement("div", null,
        // KPI Row
        React.createElement("div", {
          style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" }
        },
          React.createElement(KPICard, {
            icon: React.createElement(Icons.Star), label: "Cumplimiento SIG",
            value: "86.2%", sub: "\u2191 3.1% vs mes anterior", glow: C.ac
          }),
          React.createElement(KPICard, {
            icon: React.createElement(Icons.Doc), label: "Docs Vigentes",
            value: "22/25", sub: "88% al dia", glow: C.pr
          }),
          React.createElement(KPICard, {
            icon: React.createElement(Icons.Alert), label: "NC Abiertas",
            value: "3", sub: "\u2193 57% reduccion", subColor: C.ac, glow: C.wn
          }),
          React.createElement(KPICard, {
            icon: React.createElement(Icons.Shield), label: "Dias sin Accidentes",
            value: "127", sub: "Record: 145 dias", glow: C.i45
          }),
          React.createElement(KPICard, {
            icon: React.createElement(Icons.Scale), label: "Cumplimiento Legal",
            value: "82%", sub: "15 normas rastreadas", glow: C.pp
          })
        ),
        // Charts Row 1
        React.createElement("div", {
          style: { display: "grid", gridTemplateColumns: "2fr 1fr", gap: 12, marginBottom: 12 }
        },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", {
              style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }
            }, "Tendencia de Cumplimiento por Sistema"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 220 },
              React.createElement(AreaChart, { data: trendData },
                React.createElement("defs", null,
                  React.createElement("linearGradient", { id: "gc", x1: 0, y1: 0, x2: 0, y2: 1 },
                    React.createElement("stop", { offset: "5%", stopColor: C.i9, stopOpacity: 0.3 }),
                    React.createElement("stop", { offset: "95%", stopColor: C.i9, stopOpacity: 0 })
                  ),
                  React.createElement("linearGradient", { id: "ga", x1: 0, y1: 0, x2: 0, y2: 1 },
                    React.createElement("stop", { offset: "5%", stopColor: C.i14, stopOpacity: 0.3 }),
                    React.createElement("stop", { offset: "95%", stopColor: C.i14, stopOpacity: 0 })
                  ),
                  React.createElement("linearGradient", { id: "gs", x1: 0, y1: 0, x2: 0, y2: 1 },
                    React.createElement("stop", { offset: "5%", stopColor: C.i45, stopOpacity: 0.3 }),
                    React.createElement("stop", { offset: "95%", stopColor: C.i45, stopOpacity: 0 })
                  )
                ),
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
                React.createElement(YAxis, { stroke: C.td, fontSize: 10, domain: [60, 100] }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Area, { type: "monotone", dataKey: "calidad", stroke: C.i9, fill: "url(#gc)", strokeWidth: 2, name: "Calidad" }),
                React.createElement(Area, { type: "monotone", dataKey: "ambiente", stroke: C.i14, fill: "url(#ga)", strokeWidth: 2, name: "Ambiente" }),
                React.createElement(Area, { type: "monotone", dataKey: "sst", stroke: C.i45, fill: "url(#gs)", strokeWidth: 2, name: "SST" }),
                React.createElement(Line, { type: "monotone", dataKey: "compliance", stroke: C.i37, strokeWidth: 2, dot: false, name: "Compliance" }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 10 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", {
              style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }
            }, "Madurez Organizacional"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 220 },
              React.createElement(RadarChart, { data: radarData, outerRadius: 70 },
                React.createElement(PolarGrid, { stroke: C.bd }),
                React.createElement(PolarAngleAxis, { dataKey: "subject", fontSize: 9, stroke: C.tm }),
                React.createElement(Radar, { dataKey: "A", stroke: C.cy, fill: C.cy, fillOpacity: 0.2, strokeWidth: 2 })
              )
            )
          )
        ),
        // Charts Row 2
        React.createElement("div", {
          style: { display: "grid", gridTemplateColumns: "1fr 1fr 1fr", gap: 12 }
        },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", {
              style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }
            }, "Documentos por ISO"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 180 },
              React.createElement(PieChart, null,
                React.createElement(Pie, {
                  data: docsByIso, dataKey: "value", nameKey: "name",
                  cx: "50%", cy: "50%", innerRadius: 35, outerRadius: 60,
                  paddingAngle: 3, strokeWidth: 0,
                },
                  docsByIso.map(function(entry, i) {
                    return React.createElement(Cell, { key: i, fill: entry.color });
                  })
                ),
                React.createElement(Legend, { wrapperStyle: { fontSize: 9 } }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", {
              style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }
            }, "No Conformidades (Tendencia)"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 180 },
              React.createElement(BarChart, { data: ncData },
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 9 }),
                React.createElement(YAxis, { stroke: C.td, fontSize: 9 }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Bar, { dataKey: "mayores", fill: C.dn, radius: [3, 3, 0, 0], name: "Mayores" }),
                React.createElement(Bar, { dataKey: "menores", fill: C.wn, radius: [3, 3, 0, 0], name: "Menores" }),
                React.createElement(Bar, { dataKey: "obs", fill: C.pr, radius: [3, 3, 0, 0], name: "Observaciones" }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", {
              style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }
            }, "Gestion de Riesgos por Area"),
            React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 8, marginTop: 8 } },
              riskMatrix.map(function(r) {
                return React.createElement("div", { key: r.area },
                  React.createElement("div", {
                    style: { display: "flex", justifyContent: "space-between", fontSize: 10, color: C.tm, marginBottom: 3 }
                  },
                    React.createElement("span", null, r.area),
                    React.createElement("span", { style: { fontWeight: 700, color: r.riesgo >= 85 ? C.ac : r.riesgo >= 70 ? C.wn : C.dn } }, r.riesgo + "%")
                  ),
                  React.createElement(ProgressBar, { value: r.riesgo })
                );
              })
            )
          )
        )
      );
    }

    // ═══ ISO 9001 DASH ═══
    function ISO9001Dash() {
      var satisfData = [
        { mes: "Jul", score: 4.1 }, { mes: "Ago", score: 4.2 }, { mes: "Sep", score: 4.0 },
        { mes: "Oct", score: 4.3 }, { mes: "Nov", score: 4.4 }, { mes: "Dic", score: 4.5 },
      ];
      var processData = [
        { proceso: "Diseno", eficacia: 92 }, { proceso: "Adquisiciones", eficacia: 85 },
        { proceso: "Ejecucion", eficacia: 88 }, { proceso: "Entrega", eficacia: 91 },
        { proceso: "Postventa", eficacia: 78 },
      ];
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Star), label: "Satisfaccion Cliente", value: "4.5/5", sub: "\u2191 0.3 pts", glow: C.i9 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Check), label: "Productos Conformes", value: "97.2%", sub: "Meta: 95%", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "NC Calidad", value: "2", sub: "\u2193 60% vs trim. anterior", subColor: C.ac, glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.RefreshCw), label: "Acciones Correctivas", value: "89%", sub: "Cierre efectivo", glow: C.pr })
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Satisfaccion del Cliente (Tendencia)"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 200 },
              React.createElement(LineChart, { data: satisfData },
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
                React.createElement(YAxis, { stroke: C.td, fontSize: 10, domain: [3.5, 5] }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Line, { type: "monotone", dataKey: "score", stroke: C.i9, strokeWidth: 3, dot: { fill: C.i9, r: 4 }, name: "Score" })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Eficacia de Procesos Clave"),
            React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 10 } },
              processData.map(function(p) {
                return React.createElement("div", { key: p.proceso },
                  React.createElement("div", { style: { display: "flex", justifyContent: "space-between", fontSize: 10, color: C.tm, marginBottom: 3 } },
                    React.createElement("span", null, p.proceso),
                    React.createElement("span", { style: { fontWeight: 700, color: p.eficacia >= 90 ? C.ac : p.eficacia >= 80 ? C.wn : C.dn } }, p.eficacia + "%")
                  ),
                  React.createElement(ProgressBar, { value: p.eficacia, color: C.i9 })
                );
              })
            )
          )
        )
      );
    }

    // ═══ ISO 14001 DASH ═══
    function ISO14001Dash() {
      var emissionData = [
        { mes: "Jul", co2: 45, residuos: 12, agua: 320 },
        { mes: "Ago", co2: 42, residuos: 11, agua: 310 },
        { mes: "Sep", co2: 40, residuos: 10, agua: 295 },
        { mes: "Oct", co2: 38, residuos: 9, agua: 280 },
        { mes: "Nov", co2: 36, residuos: 8, agua: 270 },
        { mes: "Dic", co2: 34, residuos: 8, agua: 260 },
      ];
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Leaf), label: "Huella Carbono", value: "34 tCO2e", sub: "\u2193 24% vs semestre", subColor: C.ac, glow: C.i14 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "Incidentes Ambientales", value: "0", sub: "Sin derrames / fugas", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.RefreshCw), label: "Residuos Reciclados", value: "72%", sub: "Meta: 70%", glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Bar), label: "Consumo Agua", value: "260 m3", sub: "\u2193 19% ahorro", subColor: C.ac, glow: C.cy })
        ),
        React.createElement(Card, { style: { padding: 16 } },
          React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Indicadores Ambientales (Tendencia Semestral)"),
          React.createElement(ResponsiveContainer, { width: "100%", height: 230 },
            React.createElement(ComposedChart, { data: emissionData },
              React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
              React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { yAxisId: "left", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { yAxisId: "right", orientation: "right", stroke: C.td, fontSize: 10 }),
              React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
              React.createElement(Bar, { yAxisId: "left", dataKey: "co2", fill: C.i14, radius: [3, 3, 0, 0], name: "CO2 (ton)" }),
              React.createElement(Bar, { yAxisId: "left", dataKey: "residuos", fill: C.wn, radius: [3, 3, 0, 0], name: "Residuos (ton)" }),
              React.createElement(Line, { yAxisId: "right", type: "monotone", dataKey: "agua", stroke: C.cy, strokeWidth: 2, dot: { fill: C.cy }, name: "Agua (m3)" }),
              React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
            )
          )
        )
      );
    }

    // ═══ ISO 45001 DASH ═══
    function ISO45001Dash() {
      var accidentData = [
        { mes: "Jul", IF: 2.1, IS: 45, IA: 0 },
        { mes: "Ago", IF: 1.8, IS: 38, IA: 0 },
        { mes: "Sep", IF: 1.5, IS: 30, IA: 0 },
        { mes: "Oct", IF: 1.2, IS: 25, IA: 0 },
        { mes: "Nov", IF: 0.9, IS: 18, IA: 0 },
        { mes: "Dic", IF: 0.7, IS: 12, IA: 0 },
      ];
      var inspData = [
        { tipo: "EPP", cumpl: 95 }, { tipo: "Senalizacion", cumpl: 88 },
        { tipo: "Herramientas", cumpl: 92 }, { tipo: "Orden y Limpieza", cumpl: 85 },
        { tipo: "Protecciones", cumpl: 90 },
      ];
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Shield), label: "Indice Frecuencia", value: "0.7", sub: "Meta < 1.0 \u2713", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "Accidentes Incapac.", value: "0", sub: "127 dias sin accidentes", glow: C.i45 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Users), label: "Capacitaciones SST", value: "98%", sub: "Personal capacitado", glow: C.pr }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Clipboard), label: "Inspecciones", value: "45", sub: "12 hallazgos abiertos", subColor: C.wn, glow: C.wn })
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Indices de Siniestralidad"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 200 },
              React.createElement(LineChart, { data: accidentData },
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
                React.createElement(YAxis, { stroke: C.td, fontSize: 10 }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Line, { type: "monotone", dataKey: "IF", stroke: C.i45, strokeWidth: 2, dot: { fill: C.i45, r: 4 }, name: "Ind. Frecuencia" }),
                React.createElement(Line, { type: "monotone", dataKey: "IS", stroke: C.dn, strokeWidth: 2, dot: { fill: C.dn, r: 4 }, name: "Ind. Severidad" }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Cumplimiento por Inspeccion"),
            React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 10 } },
              inspData.map(function(p) {
                return React.createElement("div", { key: p.tipo },
                  React.createElement("div", { style: { display: "flex", justifyContent: "space-between", fontSize: 10, color: C.tm, marginBottom: 3 } },
                    React.createElement("span", null, p.tipo),
                    React.createElement("span", { style: { fontWeight: 700 } }, p.cumpl + "%")
                  ),
                  React.createElement(ProgressBar, { value: p.cumpl, color: C.i45 })
                );
              })
            )
          )
        )
      );
    }

    // ═══ ISO 37001 DASH ═══
    function ISO37001Dash() {
      var ddData = [
        { mes: "Jul", evaluaciones: 8, riesgo_alto: 2 },
        { mes: "Ago", evaluaciones: 12, riesgo_alto: 3 },
        { mes: "Sep", evaluaciones: 10, riesgo_alto: 1 },
        { mes: "Oct", evaluaciones: 15, riesgo_alto: 2 },
        { mes: "Nov", evaluaciones: 11, riesgo_alto: 1 },
        { mes: "Dic", evaluaciones: 14, riesgo_alto: 0 },
      ];
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Gavel), label: "Due Diligence", value: "70", sub: "Evaluaciones realizadas", glow: C.i37 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "Denuncias Canal Etico", value: "3", sub: "2 resueltas, 1 en proceso", subColor: C.wn, glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Users), label: "Capacitacion Antisoborno", value: "94%", sub: "Personal capacitado", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Shield), label: "Riesgo Residual", value: "Bajo", sub: "Matriz actualizada Dic 2025", glow: C.ac })
        ),
        React.createElement(Card, { style: { padding: 16 } },
          React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Due Diligence - Evaluaciones Mensuales"),
          React.createElement(ResponsiveContainer, { width: "100%", height: 220 },
            React.createElement(BarChart, { data: ddData },
              React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
              React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { stroke: C.td, fontSize: 10 }),
              React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
              React.createElement(Bar, { dataKey: "evaluaciones", fill: C.i37, radius: [3, 3, 0, 0], name: "Evaluaciones" }),
              React.createElement(Bar, { dataKey: "riesgo_alto", fill: C.dn, radius: [3, 3, 0, 0], name: "Riesgo Alto" }),
              React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
            )
          )
        )
      );
    }

    return React.createElement("div", null,
      React.createElement(TabBar, {
        tabs: dashTabs, active: dashTab, onChange: setDashTab
      }),
      dashTab === "general" ? React.createElement(GeneralDash) : null,
      dashTab === "iso9001" ? React.createElement(ISO9001Dash) : null,
      dashTab === "iso14001" ? React.createElement(ISO14001Dash) : null,
      dashTab === "iso45001" ? React.createElement(ISO45001Dash) : null,
      dashTab === "iso37001" ? React.createElement(ISO37001Dash) : null
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // DOCUMENT CONTROL VIEW
  // ═══════════════════════════════════════════════════════════════════════
  function DocumentsView() {
    var filteredDocs = DOCUMENTS.filter(function(d) {
      var matchSearch = docSearch === "" || d.name.toLowerCase().indexOf(docSearch.toLowerCase()) >= 0 || d.id.toLowerCase().indexOf(docSearch.toLowerCase()) >= 0;
      var matchFilter = docFilter === "all" || d.iso === docFilter || (docFilter === "vigente" && d.status === "vigente") || (docFilter === "revision" && d.status === "revision") || (docFilter === "abierto" && d.status === "abierto");
      return matchSearch && matchFilter;
    });

    var statusColor = { vigente: "green", revision: "yellow", abierto: "red" };
    var isoColor = { "9001": "blue", "14001": "green", "45001": "yellow", "37001": "purple", multi: "cyan" };
    var pdcaLabels = { P: "Plan", D: "Do", C: "Check", A: "Act" };

    return React.createElement("div", null,
      // Toolbar
      React.createElement("div", {
        style: { display: "flex", gap: 10, marginBottom: 16, flexWrap: "wrap", alignItems: "center" }
      },
        React.createElement("div", {
          style: {
            flex: 1, minWidth: 200, display: "flex", alignItems: "center", gap: 8,
            background: C.sa, border: "1px solid " + C.bd, borderRadius: 8, padding: "6px 12px",
          }
        },
          React.createElement(Icons.Search),
          React.createElement("input", {
            value: docSearch, onChange: function(e) { setDocSearch(e.target.value); },
            placeholder: "Buscar documento por nombre o codigo...",
            style: {
              flex: 1, background: "none", border: "none", color: C.tx,
              fontSize: 11, outline: "none", fontFamily: "inherit",
            }
          })
        ),
        React.createElement("select", {
          value: docFilter, onChange: function(e) { setDocFilter(e.target.value); },
          style: {
            padding: "8px 12px", borderRadius: 8, background: C.sa,
            border: "1px solid " + C.bd, color: C.tx, fontSize: 11, fontFamily: "inherit",
          }
        },
          React.createElement("option", { value: "all" }, "Todos"),
          React.createElement("option", { value: "9001" }, "ISO 9001"),
          React.createElement("option", { value: "14001" }, "ISO 14001"),
          React.createElement("option", { value: "45001" }, "ISO 45001"),
          React.createElement("option", { value: "37001" }, "ISO 37001"),
          React.createElement("option", { value: "vigente" }, "Vigentes"),
          React.createElement("option", { value: "revision" }, "En Revision"),
          React.createElement("option", { value: "abierto" }, "Abiertos")
        ),
        React.createElement(Btn, { primary: true }, React.createElement(Icons.Plus), " Nuevo Documento")
      ),
      // Stats
      React.createElement("div", {
        style: { display: "flex", gap: 10, marginBottom: 16, flexWrap: "wrap" }
      },
        React.createElement(Badge, { color: "blue" }, "Total: " + filteredDocs.length),
        React.createElement(Badge, { color: "green" }, "Vigentes: " + filteredDocs.filter(function(d) { return d.status === "vigente"; }).length),
        React.createElement(Badge, { color: "yellow" }, "Revision: " + filteredDocs.filter(function(d) { return d.status === "revision"; }).length),
        React.createElement(Badge, { color: "red" }, "Abiertos: " + filteredDocs.filter(function(d) { return d.status === "abierto"; }).length)
      ),
      // Table
      React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", {
            style: { width: "100%", borderCollapse: "collapse", fontSize: 11 }
          },
            React.createElement("thead", null,
              React.createElement("tr", {
                style: { borderBottom: "1px solid " + C.bd }
              },
                ["Codigo", "Documento", "ISO", "Area", "PDCA", "Version", "Estado", "Acciones"].map(function(h) {
                  return React.createElement("th", {
                    key: h,
                    style: {
                      padding: "10px 12px", textAlign: "left", fontSize: 9, fontWeight: 700,
                      color: C.td, textTransform: "uppercase", letterSpacing: 0.5,
                    }
                  }, h);
                })
              )
            ),
            React.createElement("tbody", null,
              filteredDocs.map(function(doc) {
                return React.createElement("tr", {
                  key: doc.id,
                  style: {
                    borderBottom: "1px solid " + C.bd + "50",
                    transition: "background 0.15s",
                  },
                  onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; },
                  onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; },
                },
                  React.createElement("td", { style: { padding: "10px 12px", fontWeight: 600, color: C.pr } }, doc.id),
                  React.createElement("td", { style: { padding: "10px 12px", color: C.tx, fontWeight: 500 } }, doc.name),
                  React.createElement("td", { style: { padding: "10px 12px" } },
                    React.createElement(Badge, { color: isoColor[doc.iso] || "blue" }, "ISO " + doc.iso)
                  ),
                  React.createElement("td", { style: { padding: "10px 12px", color: C.tm } }, doc.area),
                  React.createElement("td", { style: { padding: "10px 12px" } },
                    React.createElement(Badge, { color: doc.pdca === "P" ? "blue" : doc.pdca === "D" ? "green" : doc.pdca === "C" ? "yellow" : "purple" }, pdcaLabels[doc.pdca])
                  ),
                  React.createElement("td", { style: { padding: "10px 12px", color: C.tm } }, "v" + doc.version),
                  React.createElement("td", { style: { padding: "10px 12px" } },
                    React.createElement(Badge, { color: statusColor[doc.status] }, doc.status)
                  ),
                  React.createElement("td", { style: { padding: "10px 12px" } },
                    React.createElement("div", { style: { display: "flex", gap: 4 } },
                      React.createElement(Btn, {
                        sm: true,
                        onClick: function() { setPreviewDoc(doc); },
                        style: { padding: "4px 8px" }
                      }, React.createElement(Icons.Eye)),
                      React.createElement(Btn, {
                        sm: true,
                        onClick: function() { downloadDoc(doc); },
                        style: { padding: "4px 8px" }
                      }, React.createElement(Icons.Download))
                    )
                  )
                );
              })
            )
          )
        )
      ),
      // Preview Modal
      React.createElement(Modal, {
        open: !!previewDoc, onClose: function() { setPreviewDoc(null); },
        title: previewDoc ? previewDoc.name : "", wide: true
      },
        previewDoc ? React.createElement("div", null,
          React.createElement("div", {
            style: {
              display: "grid", gridTemplateColumns: "1fr 1fr 1fr 1fr", gap: 12, marginBottom: 16,
              padding: 12, background: C.sa, borderRadius: 10,
            }
          },
            React.createElement("div", null,
              React.createElement("div", { style: { fontSize: 9, color: C.td, marginBottom: 2 } }, "CODIGO"),
              React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.pr } }, previewDoc.id)
            ),
            React.createElement("div", null,
              React.createElement("div", { style: { fontSize: 9, color: C.td, marginBottom: 2 } }, "ISO"),
              React.createElement(Badge, { color: isoColor[previewDoc.iso] || "blue" }, "ISO " + previewDoc.iso)
            ),
            React.createElement("div", null,
              React.createElement("div", { style: { fontSize: 9, color: C.td, marginBottom: 2 } }, "VERSION"),
              React.createElement("div", { style: { fontSize: 12, fontWeight: 600, color: C.tx } }, "v" + previewDoc.version)
            ),
            React.createElement("div", null,
              React.createElement("div", { style: { fontSize: 9, color: C.td, marginBottom: 2 } }, "FECHA"),
              React.createElement("div", { style: { fontSize: 12, fontWeight: 600, color: C.tx } }, previewDoc.date)
            )
          ),
          // Doc content preview
          React.createElement("div", {
            style: {
              background: "#fff", color: "#222", borderRadius: 8, padding: 24,
              fontSize: 12, lineHeight: 1.8, maxHeight: 400, overflow: "auto",
            }
          },
            React.createElement("div", {
              style: {
                display: "flex", justifyContent: "space-between", borderBottom: "2px solid #333",
                paddingBottom: 12, marginBottom: 16
              }
            },
              React.createElement("div", {
                style: {
                  width: 100, height: 50, border: "1px dashed #999", display: "flex",
                  alignItems: "center", justifyContent: "center", fontSize: 10, color: "#999"
                }
              }, "[LOGO]"),
              React.createElement("div", { style: { textAlign: "center", flex: 1, fontWeight: 700, fontSize: 14 } }, previewDoc.name.toUpperCase()),
              React.createElement("div", { style: { textAlign: "right", fontSize: 10 } },
                "Cod: " + previewDoc.id,
                React.createElement("br"),
                "Ver: " + previewDoc.version,
                React.createElement("br"),
                "Pag: 1 de " + previewDoc.pages
              )
            ),
            React.createElement("h3", { style: { color: "#1a5276", borderBottom: "2px solid #2d7ff9", paddingBottom: 4 } }, "1. OBJETIVO"),
            React.createElement("p", null, "Establecer los lineamientos para ", previewDoc.name.toLowerCase(), " en conformidad con los requisitos ISO ", previewDoc.iso, " aplicables al sector construccion."),
            React.createElement("h3", { style: { color: "#1a5276", borderBottom: "2px solid #2d7ff9", paddingBottom: 4 } }, "2. ALCANCE"),
            React.createElement("p", null, "Este documento aplica a todas las actividades del area de ", previewDoc.area, " y procesos relacionados dentro de la organizacion."),
            React.createElement("h3", { style: { color: "#1a5276", borderBottom: "2px solid #2d7ff9", paddingBottom: 4 } }, "3. REFERENCIAS NORMATIVAS"),
            React.createElement("p", null, "ISO ", previewDoc.iso, " | Politica Integrada SIG | Manual del Sistema de Gestion Integrado"),
            React.createElement("div", {
              style: { textAlign: "center", padding: 20, color: "#999", fontStyle: "italic", borderTop: "1px solid #eee", marginTop: 20 }
            }, "[Contenido completo disponible en la descarga del documento]")
          ),
          React.createElement("div", {
            style: { display: "flex", gap: 8, justifyContent: "flex-end", marginTop: 16 }
          },
            React.createElement(Btn, {
              primary: true,
              onClick: function() { downloadDoc(previewDoc); }
            }, React.createElement(Icons.Download), " Descargar HTML"),
            React.createElement(Btn, { onClick: function() { setPreviewDoc(null); } }, "Cerrar")
          )
        ) : null
      )
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // AUDITOR INTELIGENTE IA (v17)
  // ═══════════════════════════════════════════════════════════════════════

  function handleFileUpload(files) {
    var newFiles = Array.from(files);
    setAiFiles(function(prev) { return prev.concat(newFiles); });
    newFiles.forEach(function(file) {
      var reader = new FileReader();
      reader.onload = function(e) {
        var content = e.target.result;
        setAiFileContents(function(prev) {
          var n = Object.assign({}, prev);
          n[file.name] = typeof content === "string" ? content : "[Archivo binario: " + file.name + "]";
          return n;
        });
      };
      reader.readAsText(file);
    });
  }

  var runAIAudit = useCallback(async function() {
    setAiAnalyzing(true);
    setAiProgress(5);
    setAiMessages(function(p) { return p.concat([{ role: "system", text: "Iniciando proceso de auditor\u00eda inteligente..." }]); });

    var sistemasText = aiConfig.sistemas.map(function(s) { return "ISO " + s; }).join(", ");
    var tipoObj = AUDIT_TYPES.find(function(t) { return t.id === aiConfig.tipo; });
    var tipoLabel = tipoObj ? tipoObj.label : aiConfig.tipo;

    var docsSummary = "";
    Object.keys(aiFileContents).forEach(function(name) {
      docsSummary += "\n\n=== DOCUMENTO: " + name + " ===\n" + aiFileContents[name].substring(0, 3000);
    });
    if (aiFiles.length > 0 && !docsSummary) {
      docsSummary = "\nDocumentos: " + aiFiles.map(function(f) { return f.name; }).join(", ");
    }

    var checklistText = "";
    var systems = aiConfig.sistemas.indexOf("integrado") >= 0 ? ["9001", "14001", "45001", "37001"] : aiConfig.sistemas;
    systems.forEach(function(sys) {
      var items = AUDIT_CHECKLISTS[sys] || [];
      checklistText += "\n\n=== REQUISITOS ISO " + sys + " ===\n";
      items.forEach(function(it) {
        checklistText += "Cl\u00e1usula " + it.clausula + ": " + it.req + "\n  Docs: " + it.docs.join(", ") + "\n";
      });
    });

    setAiProgress(15);
    setAiMessages(function(p) { return p.concat([{ role: "system", text: "Analizando documentos contra requisitos normativos..." }]); });

    var systemPrompt = "Eres un AUDITOR LIDER SENIOR con mas de 25 anios de experiencia en auditorias de sistemas de gestion. Experiencia: Auditor Lider ISO 9001, 14001, 45001, 37001. Auditorias internas, MINTRA/SUNAFIL, homologacion, certificacion (SGS, Bureau Veritas, TUV). Oficial de Cumplimiento experto ISO 37001. Sector CONSTRUCCION Peru. Dominio ISO 19011:2018.\n\nGenera un INFORME DE AUDITORIA COMPLETO en JSON valido sin markdown ni backticks. Estructura:\n{\"informe\":{\"titulo\":\"...\",\"numero\":\"INF-AUD-2026-001\",\"fecha\":\"" + aiConfig.fecha + "\",\"tipo_auditoria\":\"" + tipoLabel + "\",\"normas_referencia\":\"" + sistemasText + "\",\"objetivo\":\"" + (aiConfig.objetivo || "") + "\",\"alcance\":\"" + (aiConfig.alcance || "") + "\",\"criterios_auditoria\":\"...\",\"area_auditada\":\"" + (aiConfig.area || "") + "\",\"auditor_lider\":\"" + (aiConfig.auditor_lider || "Auditor IA") + "\",\"equipo_auditor\":\"" + (aiConfig.equipo || "Sistema IA") + "\",\"metodo\":\"Revision documental con IA\",\"resumen_ejecutivo\":\"...\",\"hallazgos\":[{\"numero\":\"H-001\",\"tipo\":\"nc_mayor|nc_menor|observacion|oportunidad_mejora|fortaleza\",\"clausula\":\"X.X\",\"norma\":\"ISO XXXXX\",\"descripcion\":\"...\",\"evidencia\":\"...\",\"requisito_incumplido\":\"...\",\"riesgo\":\"alto|medio|bajo\",\"recomendacion\":\"...\"}],\"resumen_hallazgos\":{\"nc_mayores\":0,\"nc_menores\":0,\"observaciones\":0,\"oportunidades_mejora\":0,\"fortalezas\":0,\"total\":0},\"conclusion\":\"...\",\"recomendaciones_generales\":[\"...\"],\"plan_accion_sugerido\":[{\"hallazgo\":\"H-001\",\"accion\":\"...\",\"responsable\":\"...\",\"plazo\":\"30 dias\"}],\"proxima_auditoria\":\"...\",\"declaracion_confidencialidad\":\"Documento confidencial.\"}}\n\nGenera 8-12 hallazgos variados, especificos al sector CONSTRUCCION. Cita clausulas exactas.";

    var userMessage = "AUDITORIA:\nTipo: " + tipoLabel + "\nSistemas: " + sistemasText + "\nAlcance: " + (aiConfig.alcance || "") + "\nArea: " + (aiConfig.area || "") + "\nObjetivo: " + (aiConfig.objetivo || "") + "\n\nCHECKLIST:" + checklistText + "\n\nDOCUMENTOS:" + (docsSummary || "\nSin documentos. Usar checklist estandar construccion.");

    try {
      setAiProgress(30);
      setAiMessages(function(p) { return p.concat([{ role: "system", text: "Ejecutando an\u00e1lisis con IA especializada..." }]); });

      var response = await fetch("https://api.anthropic.com/v1/messages", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          model: "claude-sonnet-4-20250514",
          max_tokens: 4096,
          system: systemPrompt,
          messages: [{ role: "user", content: userMessage }]
        })
      });

      setAiProgress(70);
      setAiMessages(function(p) { return p.concat([{ role: "system", text: "Procesando resultados..." }]); });

      var data = await response.json();
      var text = (data.content || []).map(function(i) { return i.text || ""; }).join("\n");

      var report;
      try {
        var clean = text.replace(/```json/g, "").replace(/```/g, "").trim();
        report = JSON.parse(clean);
      } catch (e2) {
        var jsonMatch = text.match(/\{[\s\S]*\}/);
        if (jsonMatch) {
          report = JSON.parse(jsonMatch[0]);
        } else {
          throw new Error("No se pudo parsear la respuesta");
        }
      }

      setAiProgress(90);
      var finalReport = report.informe || report;
      setAiReport(finalReport);
      setAuditReports(function(prev) { return prev.concat([Object.assign({ id: _aUid(), fecha_generacion: new Date().toISOString(), generado_por: "IA" }, finalReport)]); });
      setAiProgress(100);
      setAiMessages(function(p) { return p.concat([{ role: "success", text: "\u2705 Auditor\u00eda completada. Informe ISO 19011 generado." }]); });
      setAiStep(4);
    } catch (err) {
      setAiMessages(function(p) { return p.concat([{ role: "error", text: "Error: " + err.message + ". Generando informe con checklist..." }]); });

      var fallbackH = [];
      var hNum = 1;
      systems.forEach(function(sys) {
        var items = AUDIT_CHECKLISTS[sys] || [];
        items.slice(0, 3).forEach(function(item) {
          var tipos = ["nc_menor", "observacion", "oportunidad_mejora", "fortaleza"];
          var tipo = tipos[Math.floor(Math.random() * tipos.length)];
          fallbackH.push({
            numero: "H-" + String(hNum++).padStart(3, "0"), tipo: tipo, clausula: item.clausula,
            norma: "ISO " + sys, descripcion: "Verificaci\u00f3n de " + item.req,
            evidencia: "Revisi\u00f3n de: " + item.docs.join(", "), requisito_incumplido: item.req,
            riesgo: tipo === "nc_mayor" ? "alto" : tipo === "nc_menor" ? "medio" : "bajo",
            recomendacion: "Verificar y actualizar " + item.docs[0]
          });
        });
      });

      var fb = {
        titulo: "Informe de Auditor\u00eda " + tipoLabel, numero: "INF-AUD-2026-" + String(auditReports.length + 1).padStart(3, "0"),
        fecha: aiConfig.fecha, tipo_auditoria: tipoLabel, normas_referencia: sistemasText,
        objetivo: aiConfig.objetivo, alcance: aiConfig.alcance,
        criterios_auditoria: "Requisitos " + sistemasText, area_auditada: aiConfig.area,
        auditor_lider: aiConfig.auditor_lider || "Auditor IA", equipo_auditor: aiConfig.equipo || "Sistema IA",
        metodo: "Revisi\u00f3n documental + checklist normativo", resumen_ejecutivo: "Auditor\u00eda basada en checklist normativo.",
        hallazgos: fallbackH,
        resumen_hallazgos: {
          nc_mayores: fallbackH.filter(function(hx) { return hx.tipo === "nc_mayor"; }).length,
          nc_menores: fallbackH.filter(function(hx) { return hx.tipo === "nc_menor"; }).length,
          observaciones: fallbackH.filter(function(hx) { return hx.tipo === "observacion"; }).length,
          oportunidades_mejora: fallbackH.filter(function(hx) { return hx.tipo === "oportunidad_mejora"; }).length,
          fortalezas: fallbackH.filter(function(hx) { return hx.tipo === "fortaleza"; }).length,
          total: fallbackH.length
        },
        conclusion: "Auditor\u00eda completada con checklist normativo.", recomendaciones_generales: ["Completar documentaci\u00f3n faltante", "Programar auditor\u00eda de seguimiento"],
        plan_accion_sugerido: fallbackH.filter(function(hx) { return hx.tipo.indexOf("nc") >= 0; }).map(function(hx) { return { hallazgo: hx.numero, accion: hx.recomendacion, responsable: aiConfig.area, plazo: "30 d\u00edas" }; }),
        proxima_auditoria: "Seguimiento en 90 d\u00edas", declaracion_confidencialidad: "Documento confidencial."
      };

      setAiReport(fb);
      setAuditReports(function(prev) { return prev.concat([Object.assign({ id: _aUid(), fecha_generacion: new Date().toISOString(), generado_por: "Checklist" }, fb)]); });
      setAiProgress(100);
      setAiStep(4);
    }
    setAiAnalyzing(false);
  }, [aiConfig, aiFiles, aiFileContents, auditReports.length]);

  function AIAuditorView() {
    function _ABadge(props) {
      var st = { display: "inline-flex", alignItems: "center", padding: "2px 8px", borderRadius: 20, fontSize: 9, fontWeight: 700, letterSpacing: 0.3, background: (props.color || C.tm) + "18", color: props.color || C.tm, textTransform: "uppercase", whiteSpace: "nowrap" };
      return <span style={st}>{props.text}</span>;
    }
    function _ANormBadge(props) {
      var cc = { "9001": C.i9, "14001": C.i14, "45001": C.i45, "37001": C.i37 };
      return <_ABadge text={"ISO " + props.norm} color={cc[props.norm] || C.pr} />;
    }

    var stepNames = ["Tipo de Auditor\u00eda", "Sistema y Alcance", "Documentos", "An\u00e1lisis IA", "Informe ISO 19011"];

    var reqChecklist = useMemo(function() {
      if (!aiConfig.sistemas.length) return [];
      var sysList = aiConfig.sistemas.indexOf("integrado") >= 0 ? ["9001", "14001", "45001", "37001"] : aiConfig.sistemas;
      var all = [];
      sysList.forEach(function(s) { (AUDIT_CHECKLISTS[s] || []).forEach(function(item) { all.push(Object.assign({}, item, { norma: s })); }); });
      return all;
    }, [aiConfig.sistemas]);

    function StepBar() {
      return (
        <div style={{ display: "flex", alignItems: "center", marginBottom: 20, gap: 4 }}>
          {stepNames.map(function(s, i) {
            return (
              <div key={i} style={{ display: "flex", alignItems: "center", gap: 4, flex: i < stepNames.length - 1 ? 1 : "none" }}>
                <div onClick={function() { if (i < aiStep) setAiStep(i); }} style={{ width: 28, height: 28, borderRadius: "50%", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, fontWeight: 800, cursor: i < aiStep ? "pointer" : "default", background: i < aiStep ? C.ac : i === aiStep ? "linear-gradient(135deg,#8c6bfa,#d946ef)" : C.sa, color: i <= aiStep ? "#fff" : C.td, border: "2px solid " + (i <= aiStep ? i === aiStep ? "#ff6b9d" : C.ac : C.bd) }}>{i < aiStep ? "\u2713" : i + 1}</div>
                <span style={{ fontSize: 9, fontWeight: i === aiStep ? 700 : 400, color: i === aiStep ? "#ff6b9d" : i < aiStep ? C.ac : C.td, whiteSpace: "nowrap" }}>{s}</span>
                {i < stepNames.length - 1 && <div style={{ flex: 1, height: 2, background: i < aiStep ? C.ac : C.bd, minWidth: 20 }} />}
              </div>
            );
          })}
        </div>
      );
    }

    // Step 0
    function Step0() {
      return (
        <div>
          <div style={{ textAlign: "center", marginBottom: 20 }}>
            <div style={{ fontSize: 36, marginBottom: 6 }}>{"\uD83E\uDD16"}</div>
            <h2 style={{ fontSize: 16, fontWeight: 800, color: C.tx, margin: 0 }}>Auditor Inteligente IA</h2>
            <p style={{ fontSize: 11, color: C.tm, marginTop: 4 }}>Auditor L\u00edder Senior {"\u00b7"} +25 a\u00f1os de experiencia {"\u00b7"} ISO 19011:2018</p>
            <p style={{ fontSize: 9, color: C.td, marginTop: 2 }}>Experto en auditor\u00edas internas, MINTRA/SUNAFIL, homologaci\u00f3n y certificaci\u00f3n</p>
          </div>
          <h3 style={{ fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }}>{"\u00bfQu\u00e9 tipo de auditor\u00eda desea realizar?"}</h3>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fill,minmax(240px,1fr))", gap: 10 }}>
            {AUDIT_TYPES.map(function(type) {
              return (
                <div key={type.id} onClick={function() { setAiConfig(function(p) { return Object.assign({}, p, { tipo: type.id }); }); setAiStep(1); }} style={{ background: C.card, borderRadius: 10, padding: 16, border: "2px solid " + (aiConfig.tipo === type.id ? type.color : C.bd), cursor: "pointer", transition: "all .2s" }}>
                  <div style={{ fontSize: 28, marginBottom: 6 }}>{type.icon}</div>
                  <div style={{ fontSize: 12, fontWeight: 700, color: type.color }}>{type.label}</div>
                  <div style={{ fontSize: 9, color: C.tm, marginTop: 4, lineHeight: 1.4 }}>{type.desc}</div>
                </div>
              );
            })}
          </div>
        </div>
      );
    }

    // Step 1
    function Step1() {
      return (
        <div>
          <h3 style={{ fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }}>Seleccione sistema(s) a auditar</h3>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fill,minmax(280px,1fr))", gap: 10, marginBottom: 16 }}>
            {AUDIT_SYSTEMS.map(function(sys) {
              var sel = aiConfig.sistemas.indexOf(sys.id) >= 0;
              return (
                <div key={sys.id} onClick={function() {
                  if (sys.id === "integrado") { setAiConfig(function(p) { return Object.assign({}, p, { sistemas: sel ? [] : ["integrado"] }); }); }
                  else { setAiConfig(function(p) { return Object.assign({}, p, { sistemas: sel ? p.sistemas.filter(function(x) { return x !== sys.id && x !== "integrado"; }) : p.sistemas.filter(function(x) { return x !== "integrado"; }).concat([sys.id]) }); }); }
                }} style={{ background: sel ? sys.color + "12" : C.card, borderRadius: 10, padding: 14, border: "2px solid " + (sel ? sys.color : C.bd), cursor: "pointer", display: "flex", alignItems: "center", gap: 10 }}>
                  <div style={{ fontSize: 22 }}>{sys.icon}</div>
                  <div style={{ flex: 1, fontSize: 11, fontWeight: 700, color: sel ? sys.color : C.tx }}>{sys.label}</div>
                  <div style={{ width: 20, height: 20, borderRadius: 4, border: "2px solid " + (sel ? sys.color : C.bd), background: sel ? sys.color : "transparent", display: "flex", alignItems: "center", justifyContent: "center" }}>{sel && <span style={{ color: "#fff", fontSize: 12, fontWeight: 800 }}>{"\u2713"}</span>}</div>
                </div>
              );
            })}
          </div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10, marginBottom: 12 }}>
            <div><label style={{ fontSize: 9, color: C.td, fontWeight: 700, display: "block", marginBottom: 3 }}>\u00c1REA A AUDITAR *</label><select value={aiConfig.area} onChange={function(e) { setAiConfig(function(p) { return Object.assign({}, p, { area: e.target.value }); }); }} style={_aSelectS}><option value="">Seleccione...</option>{["Toda la organizaci\u00f3n", "Operaciones", "SST", "Medio Ambiente", "Calidad", "Cumplimiento", "RRHH", "Log\u00edstica"].map(function(a) { return <option key={a}>{a}</option>; })}</select></div>
            <div><label style={{ fontSize: 9, color: C.td, fontWeight: 700, display: "block", marginBottom: 3 }}>FECHA</label><input type="date" value={aiConfig.fecha} onChange={function(e) { setAiConfig(function(p) { return Object.assign({}, p, { fecha: e.target.value }); }); }} style={_aInputS} /></div>
          </div>
          <div style={{ marginBottom: 10 }}><label style={{ fontSize: 9, color: C.td, fontWeight: 700, display: "block", marginBottom: 3 }}>ALCANCE *</label><textarea value={aiConfig.alcance} onChange={function(e) { setAiConfig(function(p) { return Object.assign({}, p, { alcance: e.target.value }); }); }} style={Object.assign({}, _aInputS, { minHeight: 60 })} placeholder="Ej: Verificaci\u00f3n del cumplimiento de requisitos ISO en procesos operativos..." /></div>
          <div style={{ marginBottom: 10 }}><label style={{ fontSize: 9, color: C.td, fontWeight: 700, display: "block", marginBottom: 3 }}>OBJETIVO *</label><textarea value={aiConfig.objetivo} onChange={function(e) { setAiConfig(function(p) { return Object.assign({}, p, { objetivo: e.target.value }); }); }} style={Object.assign({}, _aInputS, { minHeight: 50 })} placeholder="Ej: Evaluar la eficacia del sistema de gesti\u00f3n..." /></div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10 }}>
            <div><label style={{ fontSize: 9, color: C.td, fontWeight: 700, display: "block", marginBottom: 3 }}>AUDITOR L\u00cdDER</label><input value={aiConfig.auditor_lider} onChange={function(e) { setAiConfig(function(p) { return Object.assign({}, p, { auditor_lider: e.target.value }); }); }} style={_aInputS} /></div>
            <div><label style={{ fontSize: 9, color: C.td, fontWeight: 700, display: "block", marginBottom: 3 }}>EQUIPO AUDITOR</label><input value={aiConfig.equipo} onChange={function(e) { setAiConfig(function(p) { return Object.assign({}, p, { equipo: e.target.value }); }); }} style={_aInputS} /></div>
          </div>
          <div style={{ marginTop: 16, display: "flex", gap: 8, justifyContent: "space-between" }}>
            <button onClick={function() { setAiStep(0); }} style={_aBtnS(C.sa, C.tm)}>{"\u2190"} Anterior</button>
            <button onClick={function() { setAiStep(2); }} disabled={!aiConfig.sistemas.length || !aiConfig.alcance || !aiConfig.area} style={Object.assign({}, _aBtnS(aiConfig.sistemas.length && aiConfig.alcance && aiConfig.area ? "#ff6b9d" : C.bd), { opacity: aiConfig.sistemas.length && aiConfig.alcance && aiConfig.area ? 1 : 0.5 })}>Siguiente {"\u2192"}</button>
          </div>
        </div>
      );
    }

    // Step 2
    function Step2() {
      var [dragOver, setDragOver] = useState(false);
      return (
        <div>
          <h3 style={{ fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 }}>Documentos para Auditor\u00eda</h3>
          <div style={{ background: C.card, borderRadius: 10, border: "1px solid " + C.bd, marginBottom: 14, maxHeight: 250, overflow: "auto" }}>
            <div style={{ padding: "10px 14px", borderBottom: "1px solid " + C.bd, position: "sticky", top: 0, background: C.card, zIndex: 1 }}>
              <div style={{ fontSize: 10, fontWeight: 700, color: "#ff6b9d" }}>{"\uD83D\uDCCB"} Check List de Verificaci\u00f3n</div>
              <div style={{ fontSize: 8, color: C.td }}>Seg\u00fan {aiConfig.sistemas.map(function(s) { return "ISO " + s; }).join(", ")}</div>
            </div>
            <div style={{ padding: 10 }}>
              {reqChecklist.map(function(item, i) {
                return (
                  <div key={i} style={{ padding: "5px 0", borderBottom: "1px dashed " + C.bd + "20", display: "flex", gap: 8, alignItems: "flex-start" }}>
                    <_ANormBadge norm={item.norma} />
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: 9, fontWeight: 700, color: C.tx }}>Cl. {item.clausula}: {item.req}</div>
                      <div style={{ fontSize: 8, color: C.td, marginTop: 2 }}>{"\uD83D\uDCCE"} {item.docs.join(" \u00b7 ")}</div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
          <div onDrop={function(e) { e.preventDefault(); setDragOver(false); handleFileUpload(e.dataTransfer.files); }} onDragOver={function(e) { e.preventDefault(); setDragOver(true); }} onDragLeave={function() { setDragOver(false); }} onClick={function() { if (fileInputRef.current) fileInputRef.current.click(); }} style={{ border: "2px dashed " + (dragOver ? "#ff6b9d" : C.bd), borderRadius: 12, background: dragOver ? "#ff6b9d08" : C.sa, padding: 24, textAlign: "center", cursor: "pointer", marginBottom: 14 }}>
            <input ref={fileInputRef} type="file" multiple style={{ display: "none" }} onChange={function(e) { handleFileUpload(e.target.files); }} accept=".pdf,.doc,.docx,.xls,.xlsx,.txt,.html,.csv,.json,.xml" />
            <div style={{ fontSize: 28, marginBottom: 6 }}>{"\uD83D\uDCE5"}</div>
            <div style={{ fontSize: 12, fontWeight: 700, color: C.tx }}>Arrastra documentos o haz clic para seleccionar</div>
            <div style={{ fontSize: 9, color: C.td, marginTop: 4 }}>PDF, Word, Excel, TXT, HTML, CSV, JSON, XML</div>
          </div>
          {aiFiles.length > 0 && (
            <div style={{ marginBottom: 14 }}>
              <div style={{ fontSize: 10, fontWeight: 700, color: C.ac, marginBottom: 6 }}>{aiFiles.length} documento(s) cargado(s)</div>
              {aiFiles.map(function(f, i) {
                return (
                  <div key={i} style={{ display: "flex", alignItems: "center", gap: 8, padding: "4px 8px", background: C.card, borderRadius: 6, marginBottom: 4, border: "1px solid " + C.bd }}>
                    <span style={{ fontSize: 12 }}>{"\uD83D\uDCC4"}</span>
                    <span style={{ fontSize: 10, color: C.tx, flex: 1 }}>{f.name}</span>
                    <span style={{ fontSize: 8, color: C.td }}>{(f.size / 1024).toFixed(1)} KB</span>
                    <span style={{ fontSize: 8, color: aiFileContents[f.name] ? C.ac : C.wn }}>{aiFileContents[f.name] ? "\u2705" : "\u23F3"}</span>
                    <button onClick={function() { setAiFiles(function(p) { return p.filter(function(_, j) { return j !== i; }); }); }} style={{ background: "none", border: "none", color: C.dn, cursor: "pointer", padding: 2 }}><Icons.X /></button>
                  </div>
                );
              })}
            </div>
          )}
          <div style={{ background: C.wn + "10", borderRadius: 8, padding: 10, border: "1px solid " + C.wn + "30", marginBottom: 14 }}>
            <div style={{ fontSize: 10, fontWeight: 700, color: C.wn }}>{"\uD83D\uDCA1"} Nota importante</div>
            <div style={{ fontSize: 9, color: C.tm, marginTop: 2 }}>Puede continuar sin documentos. El Auditor IA generar\u00e1 hallazgos basados en el checklist normativo. Con documentos, el an\u00e1lisis ser\u00e1 m\u00e1s preciso.</div>
          </div>
          <div style={{ display: "flex", gap: 8, justifyContent: "space-between" }}>
            <button onClick={function() { setAiStep(1); }} style={_aBtnS(C.sa, C.tm)}>{"\u2190"} Anterior</button>
            <button onClick={function() { setAiStep(3); setTimeout(runAIAudit, 500); }} style={_aBtnS("#ff6b9d")}>{"\uD83E\uDD16"} Iniciar Auditor\u00eda {"\u2192"}</button>
          </div>
        </div>
      );
    }

    // Step 3
    function Step3() {
      return (
        <div style={{ textAlign: "center", padding: "30px 20px" }}>
          <style>{["@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}", "@keyframes spin{to{transform:rotate(360deg)}}"].join("")}</style>
          <div style={{ fontSize: 50, marginBottom: 12, animation: "pulse 2s infinite" }}>{"\uD83E\uDD16"}</div>
          <h2 style={{ fontSize: 16, fontWeight: 800, color: "#ff6b9d", margin: "0 0 8px" }}>Auditor Inteligente en Proceso</h2>
          <p style={{ fontSize: 11, color: C.tm, marginBottom: 16 }}>Analizando documentaci\u00f3n contra requisitos normativos...</p>
          <div style={{ width: "100%", maxWidth: 400, margin: "0 auto 20px", background: C.sa, borderRadius: 10, height: 8, overflow: "hidden" }}>
            <div style={{ height: "100%", background: "linear-gradient(90deg,#ff6b9d,#8c6bfa)", borderRadius: 10, width: aiProgress + "%", transition: "width 0.5s" }} />
          </div>
          <div style={{ fontSize: 12, fontWeight: 700, color: "#ff6b9d", marginBottom: 16 }}>{aiProgress}%</div>
          <div style={{ maxWidth: 500, margin: "0 auto", textAlign: "left", background: C.card, borderRadius: 10, padding: 14, border: "1px solid " + C.bd, maxHeight: 200, overflow: "auto" }}>
            {aiMessages.map(function(msg, i) {
              var icon = msg.role === "error" ? "\u274C" : msg.role === "success" ? "\u2705" : "\u26A1";
              var color = msg.role === "error" ? C.dn : msg.role === "success" ? C.ac : C.tm;
              return <div key={i} style={{ display: "flex", alignItems: "flex-start", gap: 6, padding: "4px 0", borderBottom: "1px dashed " + C.bd + "20" }}><span style={{ fontSize: 10 }}>{icon}</span><span style={{ fontSize: 9, color: color }}>{msg.text}</span></div>;
            })}
            {aiAnalyzing && <div style={{ display: "flex", alignItems: "center", gap: 6, padding: "4px 0" }}><div style={{ width: 10, height: 10, border: "2px solid #ff6b9d", borderTop: "2px solid transparent", borderRadius: "50%", animation: "spin .8s linear infinite" }} /><span style={{ fontSize: 9, color: "#ff6b9d" }}>Procesando...</span></div>}
          </div>
        </div>
      );
    }

    // Step 4
    function Step4() {
      if (!aiReport) return <div style={{ textAlign: "center", padding: 40, color: C.td }}>No hay informe</div>;
      var r = aiReport;
      var h = r.hallazgos || [];
      var rs = r.resumen_hallazgos || {};
      var hcMap = {
        nc_mayor: { bg: C.dn + "15", color: C.dn, label: "NC MAYOR" },
        nc_menor: { bg: C.wn + "15", color: C.wn, label: "NC MENOR" },
        observacion: { bg: C.pr + "15", color: C.pr, label: "OBSERVACI\u00d3N" },
        oportunidad_mejora: { bg: C.pp + "15", color: C.pp, label: "OPORT. MEJORA" },
        fortaleza: { bg: C.ac + "15", color: C.ac, label: "FORTALEZA" }
      };
      var summaryItems = [["NC Mayores", rs.nc_mayores || 0, C.dn], ["NC Menores", rs.nc_menores || 0, C.wn], ["Observaciones", rs.observaciones || 0, C.pr], ["Oport. Mejora", rs.oportunidades_mejora || 0, C.pp], ["Fortalezas", rs.fortalezas || 0, C.ac]];
      var metaItems = [["Tipo", r.tipo_auditoria, C.pr], ["\u00c1rea", r.area_auditada, C.ac], ["Auditor", r.auditor_lider, C.pp], ["M\u00e9todo", r.metodo, C.cy]];

      return (
        <div>
          <div style={{ background: "linear-gradient(135deg,#1a0a2e,#0c1220)", borderRadius: 12, padding: 20, border: "1px solid " + C.bd, marginBottom: 16, textAlign: "center" }}>
            <div style={{ fontSize: 9, color: "#ff6b9d", fontWeight: 700, letterSpacing: 1, textTransform: "uppercase" }}>ISO 19011:2018</div>
            <h2 style={{ fontSize: 16, fontWeight: 800, color: C.tx, margin: "8px 0 4px" }}>{r.titulo}</h2>
            <div style={{ fontSize: 11, color: C.tm }}>{r.normas_referencia} {"\u00b7"} {_aFmtDate(r.fecha)}</div>
            <div style={{ fontSize: 10, color: C.pp, marginTop: 4 }}>N\u00b0 {r.numero}</div>
          </div>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit,minmax(180px,1fr))", gap: 8, marginBottom: 16 }}>
            {metaItems.map(function(m) { return <div key={m[0]} style={{ background: C.card, borderRadius: 8, padding: 10, border: "1px solid " + C.bd }}><div style={{ fontSize: 8, color: C.td, fontWeight: 700, textTransform: "uppercase" }}>{m[0]}</div><div style={{ fontSize: 10, color: m[2], fontWeight: 600, marginTop: 2 }}>{m[1]}</div></div>; })}
          </div>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(5,1fr)", gap: 8, marginBottom: 16 }}>
            {summaryItems.map(function(s) { return <div key={s[0]} style={{ background: s[2] + "10", borderRadius: 8, padding: 10, border: "1px solid " + s[2] + "30", textAlign: "center" }}><div style={{ fontSize: 24, fontWeight: 800, color: s[2] }}>{s[1]}</div><div style={{ fontSize: 8, color: C.tm, fontWeight: 600 }}>{s[0]}</div></div>; })}
          </div>
          <div style={{ background: C.card, borderRadius: 10, padding: 14, border: "1px solid " + C.bd, marginBottom: 14 }}>
            <h4 style={{ margin: "0 0 6px", fontSize: 11, fontWeight: 700, color: C.pl }}>{"\uD83D\uDCCA"} Resumen Ejecutivo</h4>
            <p style={{ fontSize: 10, color: C.tm, lineHeight: 1.6, margin: 0 }}>{r.resumen_ejecutivo}</p>
          </div>
          <div style={{ background: C.card, borderRadius: 10, border: "1px solid " + C.bd, marginBottom: 14, overflow: "hidden" }}>
            <div style={{ padding: "10px 14px", borderBottom: "1px solid " + C.bd, background: C.pp + "08" }}>
              <h4 style={{ margin: 0, fontSize: 12, fontWeight: 700, color: C.pp }}>{"\uD83D\uDD0E"} Hallazgos ({h.length})</h4>
            </div>
            <div style={{ maxHeight: 400, overflow: "auto" }}>
              {h.map(function(hx, i) {
                var hc = hcMap[hx.tipo] || hcMap.observacion;
                return (
                  <div key={i} style={{ padding: 12, borderBottom: "1px solid " + C.bd + "20", background: i % 2 === 0 ? "transparent" : C.sa + "50" }}>
                    <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 6, flexWrap: "wrap" }}>
                      <span style={{ fontSize: 11, fontWeight: 800, color: C.tx }}>{hx.numero}</span>
                      <_ABadge text={hc.label} color={hc.color} />
                      <_ABadge text={"Cl. " + hx.clausula} color={C.cy} />
                      <_ABadge text={hx.norma} color={C.pl} />
                      {hx.riesgo && <_ABadge text={"Riesgo: " + hx.riesgo} color={hx.riesgo === "alto" ? C.dn : hx.riesgo === "medio" ? C.wn : C.ac} />}
                    </div>
                    <div style={{ fontSize: 10, color: C.tx, fontWeight: 600, marginBottom: 4 }}>{hx.descripcion}</div>
                    {hx.evidencia && <div style={{ fontSize: 9, color: C.tm, marginBottom: 3 }}>{"\uD83D\uDCCE"} <strong>Evidencia:</strong> {hx.evidencia}</div>}
                    {hx.requisito_incumplido && <div style={{ fontSize: 9, color: C.wn, marginBottom: 3 }}>{"\u26A0\uFE0F"} <strong>Requisito:</strong> {hx.requisito_incumplido}</div>}
                    {hx.recomendacion && <div style={{ fontSize: 9, color: C.ac }}>{"\uD83D\uDCA1"} <strong>Recomendaci\u00f3n:</strong> {hx.recomendacion}</div>}
                  </div>
                );
              })}
            </div>
          </div>
          <div style={{ background: C.card, borderRadius: 10, padding: 14, border: "1px solid " + C.bd, marginBottom: 14 }}>
            <h4 style={{ margin: "0 0 6px", fontSize: 11, fontWeight: 700, color: "#ff6b9d" }}>{"\uD83D\uDCDD"} Conclusiones</h4>
            <p style={{ fontSize: 10, color: C.tm, lineHeight: 1.6, margin: 0 }}>{r.conclusion}</p>
          </div>
          {(r.recomendaciones_generales || []).length > 0 && (
            <div style={{ background: C.card, borderRadius: 10, padding: 14, border: "1px solid " + C.bd, marginBottom: 14 }}>
              <h4 style={{ margin: "0 0 8px", fontSize: 11, fontWeight: 700, color: C.pr }}>{"\uD83D\uDCCC"} Recomendaciones</h4>
              {r.recomendaciones_generales.map(function(rec, i) { return <div key={i} style={{ display: "flex", gap: 6, padding: "3px 0" }}><span style={{ color: C.pr, fontSize: 10, fontWeight: 700 }}>{i + 1}.</span><span style={{ fontSize: 10, color: C.tm }}>{rec}</span></div>; })}
            </div>
          )}
          {(r.plan_accion_sugerido || []).length > 0 && (
            <div style={{ background: C.card, borderRadius: 10, border: "1px solid " + C.bd, marginBottom: 14, overflow: "hidden" }}>
              <div style={{ padding: "10px 14px", borderBottom: "1px solid " + C.bd, background: C.wn + "08" }}>
                <h4 style={{ margin: 0, fontSize: 11, fontWeight: 700, color: C.wn }}>{"\uD83D\uDCCB"} Plan de Acci\u00f3n</h4>
              </div>
              <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 9 }}>
                <thead><tr style={{ background: C.sa }}>
                  {["Hallazgo", "Acci\u00f3n", "Responsable", "Plazo"].map(function(hh) { return <th key={hh} style={{ padding: "6px 10px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, borderBottom: "1px solid " + C.bd }}>{hh}</th>; })}
                </tr></thead>
                <tbody>
                  {r.plan_accion_sugerido.map(function(pa, i) { return <tr key={i} style={{ borderBottom: "1px solid " + C.bd + "15" }}><td style={{ padding: "5px 10px", fontWeight: 700, color: C.wn }}>{pa.hallazgo}</td><td style={{ padding: "5px 10px", color: C.tx }}>{pa.accion}</td><td style={{ padding: "5px 10px", color: C.tm }}>{pa.responsable}</td><td style={{ padding: "5px 10px", color: C.ac, fontWeight: 600 }}>{pa.plazo}</td></tr>; })}
                </tbody>
              </table>
            </div>
          )}
          <div style={{ display: "flex", gap: 8, justifyContent: "space-between", flexWrap: "wrap" }}>
            <button onClick={function() { setAiStep(0); setAiReport(null); setAiFiles([]); setAiFileContents({}); setAiMessages([]); setAiConfig({ tipo: "", sistemas: [], alcance: "", area: "", objetivo: "", auditor_lider: "", equipo: "", fecha: _aToday() }); }} style={_aBtnS(C.sa, C.tm)}>{"\uD83D\uDD04"} Nueva Auditor\u00eda</button>
            <div style={{ display: "flex", gap: 8 }}>
              <button onClick={function() { downloadHTML((r.numero || "Informe") + ".html", buildReportHTML(r)); }} style={_aBtnS(C.ac, "#000")}><Icons.Download /> Descargar HTML</button>
              <button onClick={function() { if (navigator.clipboard) navigator.clipboard.writeText(JSON.stringify(r, null, 2)); }} style={_aBtnS(C.pp)}><Icons.Doc /> Copiar JSON</button>
            </div>
          </div>
        </div>
      );
    }

    return (
      <div>
        <StepBar />
        {aiStep === 0 && <Step0 />}
        {aiStep === 1 && <Step1 />}
        {aiStep === 2 && <Step2 />}
        {aiStep === 3 && <Step3 />}
        {aiStep === 4 && <Step4 />}
      </div>
    );
  }


  // ═══════════════════════════════════════════════════════════════════════
  // LEGAL COMPLIANCE VIEW
  // ═══════════════════════════════════════════════════════════════════════
  function LegalView() {
    var filteredLegal = useMemo(function() {
      return LEGAL_DB.filter(function(l) {
        if (legalStep < 2) return false;
        var sectorMatch = l.aplica.indexOf("Todas") >= 0 || l.aplica.indexOf(legalProfile.sector) >= 0;
        return sectorMatch;
      });
    }, [legalStep, legalProfile.sector]);

    // Step 0: Profile Wizard
    function WizardStep() {
      var steps = [
        { num: 0, label: "Perfil Empresa" },
        { num: 1, label: "Configuracion" },
        { num: 2, label: "Matriz Legal" },
      ];

      return React.createElement("div", null,
        // Progress
        React.createElement("div", {
          style: { display: "flex", alignItems: "center", gap: 0, marginBottom: 24, padding: "0 20px" }
        },
          steps.map(function(st, i) {
            var done = legalStep > st.num;
            var active = legalStep === st.num;
            return React.createElement(React.Fragment, { key: st.num },
              React.createElement("div", {
                style: { display: "flex", alignItems: "center", gap: 8 }
              },
                React.createElement("div", {
                  style: {
                    width: 28, height: 28, borderRadius: "50%",
                    background: done ? C.ac : active ? C.pr : C.sa,
                    color: done || active ? "#fff" : C.td,
                    display: "flex", alignItems: "center", justifyContent: "center",
                    fontSize: 11, fontWeight: 700,
                  }
                }, done ? React.createElement(Icons.Check) : st.num + 1),
                React.createElement("span", {
                  style: { fontSize: 11, fontWeight: active ? 700 : 500, color: active ? C.tx : C.tm }
                }, st.label)
              ),
              i < steps.length - 1 ? React.createElement("div", {
                style: {
                  flex: 1, height: 2, background: done ? C.ac : C.bd, margin: "0 12px",
                }
              }) : null
            );
          })
        ),

        // Step Content
        legalStep === 0 ? React.createElement(Card, { style: { padding: 24, maxWidth: 600, margin: "0 auto" } },
          React.createElement("div", {
            style: { display: "flex", alignItems: "center", gap: 10, marginBottom: 20 }
          },
            React.createElement("div", {
              style: { width: 40, height: 40, borderRadius: 12, background: C.g4, display: "flex", alignItems: "center", justifyContent: "center" }
            }, React.createElement(Icons.Building)),
            React.createElement("div", null,
              React.createElement("div", { style: { fontSize: 14, fontWeight: 800, color: C.tx } }, "Perfil de la Organizacion"),
              React.createElement("div", { style: { fontSize: 10, color: C.td } }, "Defina los datos basicos para generar la matriz legal")
            )
          ),
          React.createElement(InputField, {
            label: "Razon Social / Nombre de la Empresa",
            value: legalProfile.alcance,
            onChange: function(v) { setLegalProfile(Object.assign({}, legalProfile, { alcance: v })); },
            placeholder: "Ej: Constructora ABC S.A.C."
          }),
          React.createElement(SelectField, {
            label: "Sector / Rubro Principal",
            value: legalProfile.sector,
            onChange: function(v) { setLegalProfile(Object.assign({}, legalProfile, { sector: v })); },
            options: SECTORS, placeholder: "Seleccionar sector..."
          }),
          React.createElement(SelectField, {
            label: "Numero de Trabajadores",
            value: legalProfile.workers,
            onChange: function(v) { setLegalProfile(Object.assign({}, legalProfile, { workers: v })); },
            options: [
              { value: "1-20", label: "Micro (1-20 trabajadores)" },
              { value: "21-100", label: "Pequena (21-100 trabajadores)" },
              { value: "100-500", label: "Mediana (100-500 trabajadores)" },
              { value: "500+", label: "Grande (500+ trabajadores)" },
            ]
          }),
          React.createElement("div", { style: { display: "flex", justifyContent: "flex-end", marginTop: 16 } },
            React.createElement(Btn, { primary: true, onClick: function() { setLegalStep(1); } }, "Siguiente ", React.createElement(Icons.ChevRight))
          )
        ) : null,

        legalStep === 1 ? React.createElement(Card, { style: { padding: 24, maxWidth: 600, margin: "0 auto" } },
          React.createElement("div", {
            style: { display: "flex", alignItems: "center", gap: 10, marginBottom: 20 }
          },
            React.createElement("div", {
              style: { width: 40, height: 40, borderRadius: 12, background: C.g1, display: "flex", alignItems: "center", justifyContent: "center" }
            }, React.createElement(Icons.Settings)),
            React.createElement("div", null,
              React.createElement("div", { style: { fontSize: 14, fontWeight: 800, color: C.tx } }, "Configuracion del Alcance"),
              React.createElement("div", { style: { fontSize: 10, color: C.td } }, "Defina las normas ISO que aplican a su organizacion")
            )
          ),
          React.createElement("div", { style: { marginBottom: 16 } },
            React.createElement("label", { style: { fontSize: 10, fontWeight: 600, color: C.tm, display: "block", marginBottom: 8 } }, "Sistemas de Gestion Implementados"),
            [
              { code: "ISO 9001:2015", label: "Sistema de Gestion de Calidad", color: C.i9 },
              { code: "ISO 14001:2015", label: "Sistema de Gestion Ambiental", color: C.i14 },
              { code: "ISO 45001:2018", label: "Sistema de Gestion SST", color: C.i45 },
              { code: "ISO 37001:2016", label: "Sistema de Gestion Antisoborno", color: C.i37 },
            ].map(function(iso) {
              return React.createElement("div", {
                key: iso.code,
                style: {
                  display: "flex", alignItems: "center", gap: 10, padding: "10px 14px",
                  background: C.sa, borderRadius: 8, marginBottom: 6,
                  border: "1px solid " + iso.color + "30",
                }
              },
                React.createElement("div", {
                  style: { width: 18, height: 18, borderRadius: 4, background: iso.color, display: "flex", alignItems: "center", justifyContent: "center" }
                }, React.createElement(Icons.Check)),
                React.createElement("div", null,
                  React.createElement("div", { style: { fontSize: 11, fontWeight: 700, color: C.tx } }, iso.code),
                  React.createElement("div", { style: { fontSize: 9, color: C.td } }, iso.label)
                )
              );
            })
          ),
          React.createElement("div", {
            style: { padding: 12, background: C.pr + "10", borderRadius: 8, marginBottom: 16 }
          },
            React.createElement("div", { style: { fontSize: 10, color: C.pl, fontWeight: 600 } },
              "Sector: " + legalProfile.sector + " | Trabajadores: " + legalProfile.workers
            ),
            React.createElement("div", { style: { fontSize: 9, color: C.tm, marginTop: 4 } },
              "Se generara una matriz con las normas legales aplicables a su perfil."
            )
          ),
          React.createElement("div", { style: { display: "flex", justifyContent: "space-between", marginTop: 16 } },
            React.createElement(Btn, { onClick: function() { setLegalStep(0); } }, "Anterior"),
            React.createElement(Btn, { primary: true, onClick: function() { setLegalStep(2); } }, "Generar Matriz ", React.createElement(Icons.ChevRight))
          )
        ) : null,

        legalStep === 2 ? React.createElement("div", null,
          // Profile summary bar
          React.createElement("div", {
            style: {
              display: "flex", justifyContent: "space-between", alignItems: "center",
              padding: "10px 16px", background: C.sa, borderRadius: 10, marginBottom: 16,
            }
          },
            React.createElement("div", { style: { display: "flex", gap: 16, alignItems: "center", flexWrap: "wrap" } },
              React.createElement(Badge, { color: "blue" }, legalProfile.sector),
              React.createElement(Badge, { color: "cyan" }, legalProfile.workers + " trabajadores"),
              React.createElement(Badge, { color: "green" }, filteredLegal.length + " normas aplicables")
            ),
            React.createElement(Btn, { sm: true, onClick: function() { setLegalStep(0); } }, React.createElement(Icons.Settings), " Editar Perfil")
          ),
          // KPIs
          React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
            React.createElement(KPICard, {
              icon: React.createElement(Icons.Scale), label: "Normas Rastreadas",
              value: String(filteredLegal.length), glow: C.pp
            }),
            React.createElement(KPICard, {
              icon: React.createElement(Icons.Check), label: "Cumplimiento Promedio",
              value: Math.round(filteredLegal.reduce(function(a, b) { return a + b.cumplimiento; }, 0) / (filteredLegal.length || 1)) + "%",
              glow: C.ac,
              sub: filteredLegal.filter(function(l) { return l.cumplimiento >= 85; }).length + " normas al dia"
            }),
            React.createElement(KPICard, {
              icon: React.createElement(Icons.Alert), label: "Riesgo Critico",
              value: String(filteredLegal.filter(function(l) { return l.riesgo === "critico"; }).length),
              glow: C.dn, sub: "Requieren atencion inmediata", subColor: C.dn
            }),
            React.createElement(KPICard, {
              icon: React.createElement(Icons.Clock), label: "Actualizaciones Recientes",
              value: String(filteredLegal.filter(function(l) { return l.ultima.indexOf("2025") >= 0 || l.ultima.indexOf("2024") >= 0; }).length),
              glow: C.wn, sub: "Normas modificadas 2024-2025"
            })
          ),
          // Matrix Table
          React.createElement(Card, { p: 0 },
            React.createElement("div", {
              style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd, display: "flex", justifyContent: "space-between", alignItems: "center" }
            },
              React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Matriz de Seguimiento por Norma"),
              React.createElement("div", { style: { display: "flex", gap: 6 } },
                React.createElement(Badge, { color: "red" }, "Critico: " + filteredLegal.filter(function(l) { return l.riesgo === "critico"; }).length),
                React.createElement(Badge, { color: "yellow" }, "Alto: " + filteredLegal.filter(function(l) { return l.riesgo === "alto"; }).length),
                React.createElement(Badge, { color: "blue" }, "Medio: " + filteredLegal.filter(function(l) { return l.riesgo === "medio"; }).length)
              )
            ),
            React.createElement("div", { style: { overflowX: "auto" } },
              React.createElement("table", {
                style: { width: "100%", borderCollapse: "collapse", fontSize: 10 }
              },
                React.createElement("thead", null,
                  React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } },
                    ["Norma", "Titulo", "Tipo", "ISO", "Riesgo", "Cumpl.", "Ultima Actualizacion"].map(function(h) {
                      return React.createElement("th", {
                        key: h,
                        style: {
                          padding: "10px 10px", textAlign: "left", fontSize: 8, fontWeight: 700,
                          color: C.td, textTransform: "uppercase", letterSpacing: 0.5,
                          whiteSpace: "nowrap",
                        }
                      }, h);
                    })
                  )
                ),
                React.createElement("tbody", null,
                  filteredLegal.map(function(l) {
                    var riskColor = l.riesgo === "critico" ? "red" : l.riesgo === "alto" ? "yellow" : "blue";
                    return React.createElement("tr", {
                      key: l.id,
                      style: { borderBottom: "1px solid " + C.bd + "50" },
                      onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; },
                      onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; },
                    },
                      React.createElement("td", { style: { padding: "10px", fontWeight: 700, color: C.pr, whiteSpace: "nowrap" } }, l.norma),
                      React.createElement("td", { style: { padding: "10px", color: C.tx, fontWeight: 500, maxWidth: 220 } }, l.titulo),
                      React.createElement("td", { style: { padding: "10px", color: C.tm, whiteSpace: "nowrap" } }, l.tipo),
                      React.createElement("td", { style: { padding: "10px" } },
                        React.createElement(Badge, { color: l.iso === "45001" ? "yellow" : l.iso === "14001" ? "green" : l.iso === "37001" ? "purple" : "blue" }, l.iso)
                      ),
                      React.createElement("td", { style: { padding: "10px" } },
                        React.createElement(Badge, { color: riskColor }, l.riesgo)
                      ),
                      React.createElement("td", { style: { padding: "10px" } },
                        React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 6, minWidth: 80 } },
                          React.createElement("div", {
                            style: { width: 50, height: 5, borderRadius: 3, background: C.sa, overflow: "hidden" }
                          },
                            React.createElement("div", {
                              style: {
                                height: "100%", borderRadius: 3,
                                width: l.cumplimiento + "%",
                                background: l.cumplimiento >= 85 ? C.ac : l.cumplimiento >= 70 ? C.wn : C.dn,
                              }
                            })
                          ),
                          React.createElement("span", {
                            style: { fontSize: 10, fontWeight: 700, color: l.cumplimiento >= 85 ? C.ac : l.cumplimiento >= 70 ? C.wn : C.dn }
                          }, l.cumplimiento + "%")
                        )
                      ),
                      React.createElement("td", { style: { padding: "10px" } },
                        React.createElement("div", {
                          style: {
                            fontSize: 9, color: C.wn, background: C.wn + "10",
                            padding: "4px 8px", borderRadius: 6, maxWidth: 220,
                          }
                        }, l.ultima)
                      )
                    );
                  })
                )
              )
            )
          )
        ) : null
      );
    }

    return React.createElement("div", null,
      React.createElement(WizardStep)
    );
  }


  // ═══════════════════════════════════════════════════════════════════════
  // ISO 9001:2015 v02 — SISTEMA DE GESTION DE CALIDAD (Dashboard Propio)
  // ═══════════════════════════════════════════════════════════════════════
  function ISO9001V2View() {
    var tabs = [
      { key: "dashboard-q", label: "Dashboard Calidad", icon: Icons.Dash },
      { key: "procesos", label: "Mapa de Procesos", icon: Icons.Bar },
      { key: "nc-ac", label: "NC / Acciones", icon: Icons.Alert },
      { key: "satisfaccion", label: "Satisfaccion Cliente", icon: Icons.Users },
      { key: "indicadores-q", label: "Indicadores", icon: Icons.Trend },
      { key: "revision-dir", label: "Revision Direccion", icon: Icons.Clipboard },
      { key: "db-q", label: "Base de Datos", icon: Icons.Database },
    ];

    var satisfTrend = [
      { mes:"Ene",enc:4.0,rec:12,nps:62},{mes:"Feb",enc:4.1,rec:10,nps:65},{mes:"Mar",enc:4.2,rec:8,nps:68},
      {mes:"Abr",enc:4.3,rec:7,nps:70},{mes:"May",enc:4.1,rec:9,nps:67},{mes:"Jun",enc:4.4,rec:6,nps:72},
      {mes:"Jul",enc:4.3,rec:5,nps:74},{mes:"Ago",enc:4.5,rec:4,nps:76},{mes:"Sep",enc:4.4,rec:6,nps:73},
      {mes:"Oct",enc:4.6,rec:3,nps:78},{mes:"Nov",enc:4.5,rec:4,nps:77},{mes:"Dic",enc:4.7,rec:2,nps:80},
    ];
    var procesoData = [
      {name:"Gestion Comercial",eficacia:91,meta:85,dueno:"Gerencia Comercial",tipo:"Core",docs:8,nc:1},
      {name:"Diseno y Desarrollo",eficacia:88,meta:85,dueno:"Ing. Proyectos",tipo:"Core",docs:12,nc:2},
      {name:"Adquisiciones",eficacia:85,meta:80,dueno:"Logistica",tipo:"Core",docs:6,nc:1},
      {name:"Ejecucion de Obra",eficacia:92,meta:90,dueno:"Residente de Obra",tipo:"Core",docs:15,nc:0},
      {name:"Control de Calidad",eficacia:94,meta:90,dueno:"Jefe QA/QC",tipo:"Core",docs:10,nc:0},
      {name:"Entrega y Cierre",eficacia:87,meta:85,dueno:"Gerencia Proyectos",tipo:"Core",docs:5,nc:1},
      {name:"Gestion RRHH",eficacia:82,meta:80,dueno:"Jefe RRHH",tipo:"Soporte",docs:7,nc:0},
      {name:"Gestion Financiera",eficacia:90,meta:85,dueno:"Contabilidad",tipo:"Soporte",docs:4,nc:0},
      {name:"Planificacion SIG",eficacia:86,meta:85,dueno:"Coord. SIG",tipo:"Estrategico",docs:9,nc:1},
      {name:"Mejora Continua",eficacia:83,meta:80,dueno:"Coord. SIG",tipo:"Estrategico",docs:6,nc:2},
    ];
    var ncTrend = [
      {mes:"Jul",abiertas:8,cerradas:5,vencidas:2},{mes:"Ago",abiertas:7,cerradas:6,vencidas:1},
      {mes:"Sep",abiertas:6,cerradas:7,vencidas:1},{mes:"Oct",abiertas:5,cerradas:5,vencidas:0},
      {mes:"Nov",abiertas:4,cerradas:6,vencidas:0},{mes:"Dic",abiertas:3,cerradas:4,vencidas:0},
    ];
    var ncDB = [
      {id:"NC-2025-041",tipo:"Mayor",proceso:"Adquisiciones",desc:"Evaluacion de proveedores criticos sin evidencia documentada de criterios de seleccion",estado:"abierta",fecha:"2025-12-12",responsable:"J. Lopez",plazo:"2026-01-15",avance:40},
      {id:"NC-2025-038",tipo:"Menor",proceso:"Ejecucion de Obra",desc:"Registros de inspeccion de materiales incompletos en recepcion de acero",estado:"en proceso",fecha:"2025-11-28",responsable:"M. Torres",plazo:"2026-01-10",avance:70},
      {id:"NC-2025-035",tipo:"Menor",proceso:"Diseno",desc:"Planos de detalle sin control de version actualizado en carpeta de obra",estado:"cerrada",fecha:"2025-11-15",responsable:"R. Diaz",plazo:"2025-12-15",avance:100},
      {id:"NC-2025-032",tipo:"Mayor",proceso:"Control de Calidad",desc:"Ensayos de concreto sin certificacion de laboratorio vigente",estado:"cerrada",fecha:"2025-10-20",responsable:"C. Vargas",plazo:"2025-11-20",avance:100},
      {id:"NC-2025-029",tipo:"Menor",proceso:"Mejora Continua",desc:"Indicadores de proceso sin analisis de tendencia en ultimo trimestre",estado:"abierta",fecha:"2025-10-05",responsable:"A. Ruiz",plazo:"2026-01-05",avance:55},
      {id:"OBS-2025-018",tipo:"Observacion",proceso:"Gestion RRHH",desc:"Perfiles de puesto no alineados con competencias ISO 9001 Cl.7.2",estado:"abierta",fecha:"2025-12-01",responsable:"P. Mendez",plazo:"2026-02-01",avance:20},
    ];
    var costoCalidad = [{cat:"Prevencion",valor:45000},{cat:"Evaluacion",valor:32000},{cat:"Falla Interna",valor:28000},{cat:"Falla Externa",valor:23000}];
    var ccColors = [C.ac, C.pr, C.wn, C.dn];
    var productConf = [
      {mes:"Jul",conforme:96.2,reproceso:2.8,rechazo:1.0},{mes:"Ago",conforme:96.8,reproceso:2.4,rechazo:0.8},
      {mes:"Sep",conforme:97.0,reproceso:2.2,rechazo:0.8},{mes:"Oct",conforme:97.3,reproceso:2.0,rechazo:0.7},
      {mes:"Nov",conforme:97.5,reproceso:1.8,rechazo:0.7},{mes:"Dic",conforme:97.8,reproceso:1.6,rechazo:0.6},
    ];
    var radarCap = [
      {cap:"Contexto(4)",val:85},{cap:"Liderazgo(5)",val:90},{cap:"Planific.(6)",val:82},
      {cap:"Apoyo(7)",val:78},{cap:"Operacion(8)",val:92},{cap:"Evaluac.(9)",val:80},{cap:"Mejora(10)",val:85},
    ];
    var revDirItems = [
      {tema:"Estado de acciones previas",estado:"cumplido",detalle:"8 de 10 acciones cerradas"},
      {tema:"Cambios cuestiones externas e internas",estado:"actualizado",detalle:"Analisis FODA revisado Nov 2025"},
      {tema:"Desempeno de procesos y conformidad",estado:"cumplido",detalle:"Eficacia promedio 88.4%"},
      {tema:"No conformidades y acciones correctivas",estado:"en proceso",detalle:"3 NC abiertas"},
      {tema:"Resultados de seguimiento y medicion",estado:"cumplido",detalle:"KPIs al dia en 9 de 10 procesos"},
      {tema:"Resultados de auditorias",estado:"cumplido",detalle:"Auditoria interna ciclo II completada"},
      {tema:"Desempeno de proveedores externos",estado:"en proceso",detalle:"Reevaluacion Q4 pendiente 3 proveedores"},
      {tema:"Adecuacion de recursos",estado:"cumplido",detalle:"Presupuesto SIG aprobado 2026"},
      {tema:"Eficacia acciones para riesgos",estado:"cumplido",detalle:"Matriz de riesgos actualizada"},
      {tema:"Oportunidades de mejora",estado:"pendiente",detalle:"5 propuestas de mejora en evaluacion"},
    ];

    function QualityDashboard() {
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Star), label: "Satisfaccion Cliente", value: "4.7/5.0", sub: "\u2191 0.5 pts en 12 meses", glow: C.i9 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Check), label: "Producto Conforme", value: "97.8%", sub: "Meta: 95% \u2713", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "NC Abiertas", value: "3", sub: "0 vencidas", subColor: C.ac, glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Trend), label: "Eficacia Procesos", value: "88.4%", sub: "\u2191 2.1% vs sem. anterior", glow: C.pr }),
          React.createElement(KPICard, { icon: React.createElement(Icons.RefreshCw), label: "Cierre AC/AP", value: "92%", sub: "Efectividad acciones", glow: C.pp })
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "3fr 2fr", gap: 12, marginBottom: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 4 } }, "Conformidad del Producto (6M)"),
            React.createElement("div", { style: { fontSize: 9, color: C.td, marginBottom: 10 } }, "Cl. 8.6 Liberacion de productos"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 200 },
              React.createElement(AreaChart, { data: productConf },
                React.createElement("defs", null,
                  React.createElement("linearGradient", { id: "gconf", x1: 0, y1: 0, x2: 0, y2: 1 },
                    React.createElement("stop", { offset: "5%", stopColor: C.ac, stopOpacity: 0.4 }),
                    React.createElement("stop", { offset: "95%", stopColor: C.ac, stopOpacity: 0 })
                  )
                ),
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
                React.createElement(YAxis, { stroke: C.td, fontSize: 10, domain: [94, 100] }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Area, { type: "monotone", dataKey: "conforme", stroke: C.ac, fill: "url(#gconf)", strokeWidth: 2.5, name: "% Conforme" }),
                React.createElement(Line, { type: "monotone", dataKey: "reproceso", stroke: C.wn, strokeWidth: 2, dot: { fill: C.wn, r: 3 }, name: "% Reproceso" }),
                React.createElement(Line, { type: "monotone", dataKey: "rechazo", stroke: C.dn, strokeWidth: 2, dot: { fill: C.dn, r: 3 }, name: "% Rechazo" }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 4 } }, "Costo de Calidad"),
            React.createElement("div", { style: { fontSize: 9, color: C.td, marginBottom: 10 } }, "Distribucion PEN"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 140 },
              React.createElement(PieChart, null,
                React.createElement(Pie, { data: costoCalidad, dataKey: "valor", nameKey: "cat", cx: "50%", cy: "50%", innerRadius: 30, outerRadius: 55, paddingAngle: 3, strokeWidth: 0 },
                  costoCalidad.map(function(e, i) { return React.createElement(Cell, { key: i, fill: ccColors[i] }); })
                ),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 }, formatter: function(v) { return "S/ " + v.toLocaleString(); } }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
              )
            ),
            React.createElement("div", { style: { textAlign: "center", fontSize: 10, color: C.tm, marginTop: 4 } }, "Total: S/ 128,000")
          )
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12, marginBottom: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 10 } }, "Satisfaccion Cliente (12M)"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 180 },
              React.createElement(ComposedChart, { data: satisfTrend },
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 9 }),
                React.createElement(YAxis, { yAxisId: "left", stroke: C.td, fontSize: 9, domain: [3.5, 5] }),
                React.createElement(YAxis, { yAxisId: "right", orientation: "right", stroke: C.td, fontSize: 9 }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Area, { yAxisId: "right", type: "monotone", dataKey: "nps", stroke: C.pp, fill: C.pp + "15", strokeWidth: 1.5, name: "NPS" }),
                React.createElement(Line, { yAxisId: "left", type: "monotone", dataKey: "enc", stroke: C.i9, strokeWidth: 2.5, dot: { fill: C.i9, r: 3 }, name: "Encuesta" }),
                React.createElement(Bar, { yAxisId: "right", dataKey: "rec", fill: C.dn + "60", radius: [3, 3, 0, 0], name: "Reclamos" }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 10 } }, "Madurez por Capitulo ISO 9001"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 180 },
              React.createElement(RadarChart, { data: radarCap, outerRadius: 60 },
                React.createElement(PolarGrid, { stroke: C.bd }),
                React.createElement(PolarAngleAxis, { dataKey: "cap", fontSize: 8, stroke: C.tm }),
                React.createElement(PolarRadiusAxis, { fontSize: 8, stroke: C.td, domain: [0, 100] }),
                React.createElement(Radar, { dataKey: "val", stroke: C.i9, fill: C.i9, fillOpacity: 0.2, strokeWidth: 2 })
              )
            )
          )
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 10 } }, "Tendencia NC / AC (6M)"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 180 },
              React.createElement(BarChart, { data: ncTrend },
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
                React.createElement(YAxis, { stroke: C.td, fontSize: 10 }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Bar, { dataKey: "abiertas", fill: C.dn, radius: [3, 3, 0, 0], name: "Abiertas" }),
                React.createElement(Bar, { dataKey: "cerradas", fill: C.ac, radius: [3, 3, 0, 0], name: "Cerradas" }),
                React.createElement(Bar, { dataKey: "vencidas", fill: C.wn, radius: [3, 3, 0, 0], name: "Vencidas" }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 10 } }, "Eficacia por Proceso"),
            React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 6 } },
              procesoData.slice(0, 6).map(function(p) {
                var met = p.eficacia >= p.meta;
                return React.createElement("div", { key: p.name },
                  React.createElement("div", { style: { display: "flex", justifyContent: "space-between", fontSize: 10, color: C.tm, marginBottom: 2 } },
                    React.createElement("span", null, p.name),
                    React.createElement("span", { style: { fontWeight: 700, color: met ? C.ac : C.dn } }, p.eficacia + "% ", met ? "\u2713" : "\u2717")
                  ),
                  React.createElement(ProgressBar, { value: p.eficacia, color: C.i9 })
                );
              })
            )
          )
        )
      );
    }

    function ProcesosView() {
      var tipoColor = { Core: "blue", Soporte: "cyan", Estrategico: "purple" };
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 8, marginBottom: 16 } },
          React.createElement(Badge, { color: "blue" }, "Core: " + procesoData.filter(function(p) { return p.tipo === "Core"; }).length),
          React.createElement(Badge, { color: "cyan" }, "Soporte: " + procesoData.filter(function(p) { return p.tipo === "Soporte"; }).length),
          React.createElement(Badge, { color: "purple" }, "Estrategico: " + procesoData.filter(function(p) { return p.tipo === "Estrategico"; }).length)
        ),
        React.createElement(Card, { p: 0 },
          React.createElement("div", { style: { overflowX: "auto" } },
            React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 11 } },
              React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } },
                ["Proceso","Tipo","Dueno","Eficacia","Meta","Docs","NC","Estado"].map(function(h) {
                  return React.createElement("th", { key: h, style: { padding: "10px", textAlign: "left", fontSize: 9, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h);
                })
              )),
              React.createElement("tbody", null, procesoData.map(function(p) {
                var met = p.eficacia >= p.meta;
                return React.createElement("tr", { key: p.name, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                  React.createElement("td", { style: { padding: "10px", fontWeight: 600, color: C.tx } }, p.name),
                  React.createElement("td", { style: { padding: "10px" } }, React.createElement(Badge, { color: tipoColor[p.tipo] }, p.tipo)),
                  React.createElement("td", { style: { padding: "10px", color: C.tm, fontSize: 10 } }, p.dueno),
                  React.createElement("td", { style: { padding: "10px" } }, React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 6 } }, React.createElement(ProgressBar, { value: p.eficacia, color: C.i9 }), React.createElement("span", { style: { fontSize: 10, fontWeight: 700, color: met ? C.ac : C.dn, minWidth: 35 } }, p.eficacia + "%"))),
                  React.createElement("td", { style: { padding: "10px", color: C.tm } }, p.meta + "%"),
                  React.createElement("td", { style: { padding: "10px", color: C.pr, fontWeight: 600 } }, p.docs),
                  React.createElement("td", { style: { padding: "10px" } }, p.nc > 0 ? React.createElement(Badge, { color: "red" }, p.nc) : React.createElement(Badge, { color: "green" }, "0")),
                  React.createElement("td", { style: { padding: "10px" } }, React.createElement(Badge, { color: met ? "green" : "red" }, met ? "Conforme" : "No Conforme"))
                );
              }))
            )
          )
        )
      );
    }

    function NCACView() {
      var estadoColor = { abierta: "red", "en proceso": "yellow", cerrada: "green" };
      var tipoC = { Mayor: "red", Menor: "yellow", Observacion: "blue" };
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 16, flexWrap: "wrap", gap: 8 } },
          React.createElement("div", { style: { display: "flex", gap: 8 } },
            React.createElement(Badge, { color: "red" }, "Abiertas: " + ncDB.filter(function(n) { return n.estado === "abierta"; }).length),
            React.createElement(Badge, { color: "yellow" }, "En Proceso: " + ncDB.filter(function(n) { return n.estado === "en proceso"; }).length),
            React.createElement(Badge, { color: "green" }, "Cerradas: " + ncDB.filter(function(n) { return n.estado === "cerrada"; }).length)
          ),
          React.createElement(Btn, { primary: true, onClick: function() { setShowNcForm(!showNcForm); } }, React.createElement(Icons.Plus), " Registrar NC")
        ),
        showNcForm ? React.createElement(Card, { style: { padding: 16, marginBottom: 12 } },
          React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Nuevo Registro NC"),
          React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10 } },
            React.createElement(SelectField, { label: "Tipo", value: ncForm.tipo, onChange: function(v) { setNcForm(Object.assign({}, ncForm, { tipo: v })); }, options: ["Mayor","Menor","Observacion"] }),
            React.createElement(SelectField, { label: "Proceso", value: ncForm.proceso, onChange: function(v) { setNcForm(Object.assign({}, ncForm, { proceso: v })); }, options: procesoData.map(function(p) { return p.name; }) }),
            React.createElement(InputField, { label: "Responsable", value: ncForm.responsable, onChange: function(v) { setNcForm(Object.assign({}, ncForm, { responsable: v })); }, placeholder: "Nombre" }),
            React.createElement(InputField, { label: "Plazo", value: ncForm.plazo, onChange: function(v) { setNcForm(Object.assign({}, ncForm, { plazo: v })); }, type: "date" })
          ),
          React.createElement(InputField, { label: "Descripcion", value: ncForm.desc, onChange: function(v) { setNcForm(Object.assign({}, ncForm, { desc: v })); }, placeholder: "Describir hallazgo..." }),
          React.createElement("div", { style: { display: "flex", gap: 8, justifyContent: "flex-end", marginTop: 8 } },
            React.createElement(Btn, { onClick: function() { setShowNcForm(false); } }, "Cancelar"),
            React.createElement(Btn, { accent: true, onClick: function() { setShowNcForm(false); } }, React.createElement(Icons.Check), " Guardar")
          )
        ) : null,
        React.createElement(Card, { p: 0 }, React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } },
              ["Codigo","Tipo","Proceso","Descripcion","Estado","Responsable","Plazo","Avance"].map(function(h) {
                return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase", whiteSpace: "nowrap" } }, h);
              })
            )),
            React.createElement("tbody", null, ncDB.map(function(nc) {
              return React.createElement("tr", { key: nc.id, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 700, color: C.pr, whiteSpace: "nowrap" } }, nc.id),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: tipoC[nc.tipo] }, nc.tipo)),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, nc.proceso),
                React.createElement("td", { style: { padding: "8px", color: C.tx, maxWidth: 200 } }, nc.desc),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: estadoColor[nc.estado] }, nc.estado)),
                React.createElement("td", { style: { padding: "8px", color: C.tm, whiteSpace: "nowrap" } }, nc.responsable),
                React.createElement("td", { style: { padding: "8px", color: C.tm, whiteSpace: "nowrap" } }, nc.plazo),
                React.createElement("td", { style: { padding: "8px", minWidth: 80 } }, React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 4 } }, React.createElement(ProgressBar, { value: nc.avance }), React.createElement("span", { style: { fontSize: 9, fontWeight: 600, color: nc.avance === 100 ? C.ac : C.tm } }, nc.avance + "%")))
              );
            }))
          )
        ))
      );
    }

    function SatisfaccionView() {
      var dims = [{dim:"Cumplimiento de plazo",score:4.5},{dim:"Calidad del acabado",score:4.8},{dim:"Atencion post-entrega",score:4.2},{dim:"Comunicacion",score:4.6},{dim:"Relacion precio-calidad",score:4.3},{dim:"Documentacion entregada",score:4.7}];
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Star), label: "Score General", value: "4.7/5.0", glow: C.i9 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Trend), label: "NPS", value: "+80", sub: "Promotores: 85%", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "Reclamos Mes", value: "2", sub: "\u2193 83% vs Ene", subColor: C.ac, glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Users), label: "Encuestados", value: "48", sub: "Tasa: 78%", glow: C.pr })
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Por Dimension"),
            dims.map(function(e) {
              return React.createElement("div", { key: e.dim, style: { marginBottom: 8 } },
                React.createElement("div", { style: { display: "flex", justifyContent: "space-between", fontSize: 10, color: C.tm, marginBottom: 3 } }, React.createElement("span", null, e.dim), React.createElement("span", { style: { fontWeight: 700, color: e.score >= 4.5 ? C.ac : C.wn } }, e.score + "/5")),
                React.createElement(ProgressBar, { value: e.score * 20, color: C.i9 })
              );
            })
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Evolucion Anual"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 220 },
              React.createElement(AreaChart, { data: satisfTrend },
                React.createElement("defs", null, React.createElement("linearGradient", { id: "gsat", x1: 0, y1: 0, x2: 0, y2: 1 }, React.createElement("stop", { offset: "5%", stopColor: C.i9, stopOpacity: 0.3 }), React.createElement("stop", { offset: "95%", stopColor: C.i9, stopOpacity: 0 }))),
                React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
                React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 9 }),
                React.createElement(YAxis, { stroke: C.td, fontSize: 9, domain: [3.5, 5] }),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
                React.createElement(Area, { type: "monotone", dataKey: "enc", stroke: C.i9, fill: "url(#gsat)", strokeWidth: 2.5, name: "Score" })
              )
            )
          )
        )
      );
    }

    function IndicadoresView() {
      var rows = [
        {ind:"Satisfaccion del cliente",cl:"9.1.2",form:"Promedio encuestas",meta:">=4.5",actual:"4.7",tend:"\u2191",ok:true},
        {ind:"Conformidad del producto",cl:"8.6",form:"(Conformes/Total)x100",meta:">=95%",actual:"97.8%",tend:"\u2191",ok:true},
        {ind:"Eficacia de procesos",cl:"4.4",form:"Promedio eficacia",meta:">=85%",actual:"88.4%",tend:"\u2191",ok:true},
        {ind:"Cierre de NC",cl:"10.2",form:"(Cerradas a tiempo/Total)x100",meta:">=90%",actual:"92%",tend:"\u2191",ok:true},
        {ind:"Reclamos clientes",cl:"9.1.2",form:"Cantidad mensual",meta:"<=5",actual:"2",tend:"\u2193",ok:true},
        {ind:"Desempeno proveedores",cl:"8.4",form:"Promedio evaluacion",meta:">=75%",actual:"81%",tend:"\u2192",ok:true},
        {ind:"Cumplimiento capacitacion",cl:"7.2",form:"(Ejecutado/Programado)x100",meta:">=90%",actual:"94%",tend:"\u2191",ok:true},
        {ind:"Costo de no calidad",cl:"10.1",form:"Falla int.+ext.",meta:"<=S/60K",actual:"S/51K",tend:"\u2193",ok:true},
        {ind:"Auditorias completadas",cl:"9.2",form:"(Ejecutadas/Programadas)x100",meta:"100%",actual:"83%",tend:"\u2192",ok:false},
        {ind:"Acciones de mejora",cl:"10.3",form:"Implementadas",meta:">=80%",actual:"72%",tend:"\u2191",ok:false},
      ];
      return React.createElement(Card, { style: { padding: 16 } },
        React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx, marginBottom: 14 } }, "Tablero de Indicadores ISO 9001"),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } },
              ["Indicador","Cl.","Formula","Meta","Actual","T","Estado"].map(function(h) {
                return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h);
              })
            )),
            React.createElement("tbody", null, rows.map(function(r, i) {
              return React.createElement("tr", { key: i, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 600, color: C.tx } }, r.ind),
                React.createElement("td", { style: { padding: "8px", color: C.pr } }, r.cl),
                React.createElement("td", { style: { padding: "8px", color: C.tm, fontSize: 9 } }, r.form),
                React.createElement("td", { style: { padding: "8px", color: C.cy, fontWeight: 600 } }, r.meta),
                React.createElement("td", { style: { padding: "8px", fontWeight: 700, color: r.ok ? C.ac : C.dn } }, r.actual),
                React.createElement("td", { style: { padding: "8px", fontSize: 14, color: r.tend === "\u2191" ? C.ac : r.tend === "\u2193" ? C.ac : C.wn } }, r.tend),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: r.ok ? "green" : "red" }, r.ok ? "En Meta" : "Bajo Meta"))
              );
            }))
          )
        )
      );
    }

    function RevisionDirView() {
      var ec = { cumplido: "green", actualizado: "green", "en proceso": "yellow", pendiente: "red" };
      var cc = { cumplido: C.ac, actualizado: C.ac, "en proceso": C.wn, pendiente: C.dn };
      return React.createElement(Card, { style: { padding: 16 } },
        React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 10, marginBottom: 16 } },
          React.createElement("div", { style: { width: 36, height: 36, borderRadius: 10, background: C.g1, display: "flex", alignItems: "center", justifyContent: "center" } }, React.createElement(Icons.Clipboard)),
          React.createElement("div", null,
            React.createElement("div", { style: { fontSize: 14, fontWeight: 800, color: C.tx } }, "Revision por la Direccion"),
            React.createElement("div", { style: { fontSize: 10, color: C.td } }, "Cl. 9.3 | Dic 2025")
          )
        ),
        React.createElement("div", { style: { display: "flex", gap: 8, marginBottom: 16 } },
          React.createElement(Badge, { color: "green" }, "Cumplidos: " + revDirItems.filter(function(r) { return r.estado === "cumplido" || r.estado === "actualizado"; }).length),
          React.createElement(Badge, { color: "yellow" }, "En Proceso: " + revDirItems.filter(function(r) { return r.estado === "en proceso"; }).length),
          React.createElement(Badge, { color: "red" }, "Pendientes: " + revDirItems.filter(function(r) { return r.estado === "pendiente"; }).length)
        ),
        revDirItems.map(function(item, i) {
          return React.createElement("div", { key: i, style: { padding: "10px 14px", background: C.sa, borderRadius: 10, marginBottom: 6, borderLeft: "3px solid " + cc[item.estado] } },
            React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 4 } },
              React.createElement("span", { style: { fontSize: 11, fontWeight: 600, color: C.tx } }, item.tema),
              React.createElement(Badge, { color: ec[item.estado] }, item.estado)
            ),
            React.createElement("div", { style: { fontSize: 10, color: C.tm } }, item.detalle)
          );
        })
      );
    }

    return React.createElement("div", null,
      React.createElement(TabBar, { tabs: tabs, active: qTab, onChange: setQTab }),
      qTab === "dashboard-q" ? React.createElement(QualityDashboard) : null,
      qTab === "procesos" ? React.createElement(ProcesosView) : null,
      qTab === "nc-ac" ? React.createElement(NCACView) : null,
      qTab === "satisfaccion" ? React.createElement(SatisfaccionView) : null,
      qTab === "indicadores-q" ? React.createElement(IndicadoresView) : null,
      qTab === "revision-dir" ? React.createElement(RevisionDirView) : null,
      qTab === "db-q" ? React.createElement(EditableDBView, {
        title: "Base de Datos ISO 9001 — Calidad",
        color: C.i9,
        columns: ["Indicador","Clausula","Meta","Actual","Tendencia"],
        rows: [
          {id:1,vals:["Satisfaccion del cliente","9.1.2",">=4.5","4.7","\u2191"]},
          {id:2,vals:["Conformidad del producto","8.6",">=95%","97.8%","\u2191"]},
          {id:3,vals:["Eficacia de procesos","4.4",">=85%","88.4%","\u2191"]},
          {id:4,vals:["Cierre de NC","10.2",">=90%","92%","\u2191"]},
          {id:5,vals:["Reclamos clientes","9.1.2","<=5","2","\u2193"]},
          {id:6,vals:["Desempeno proveedores","8.4",">=75%","81%","\u2192"]},
          {id:7,vals:["Cumplimiento capacitacion","7.2",">=90%","94%","\u2191"]},
          {id:8,vals:["Costo no calidad","10.1","<=S/60K","S/51K","\u2193"]},
          {id:9,vals:["Auditorias completadas","9.2","100%","83%","\u2192"]},
          {id:10,vals:["Acciones de mejora","10.3",">=80%","72%","\u2191"]},
        ]
      }) : null
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // ISO 14001:2015 v02 — SISTEMA DE GESTION AMBIENTAL
  // ═══════════════════════════════════════════════════════════════════════
  function ISO14001V2View() {
    var tabs = [
      { key: "dashboard-a", label: "Dashboard Ambiental", icon: Icons.Dash },
      { key: "aspectos", label: "Aspectos e Impactos", icon: Icons.Leaf },
      { key: "residuos", label: "Gestion Residuos", icon: Icons.RefreshCw },
      { key: "monitoreo", label: "Monitoreo", icon: Icons.Bar },
      { key: "db-a", label: "Base de Datos", icon: Icons.Database },
    ];
    var emTrend = [{mes:"Jul",co2:48,agua:340,energia:1200,residuos:14},{mes:"Ago",co2:45,agua:325,energia:1150,residuos:13},{mes:"Sep",co2:42,agua:310,energia:1100,residuos:12},{mes:"Oct",co2:40,agua:295,energia:1060,residuos:11},{mes:"Nov",co2:37,agua:280,energia:1020,residuos:10},{mes:"Dic",co2:34,agua:265,energia:980,residuos:9}];
    var aspectos = [
      {asp:"Generacion de polvo",imp:"Contamin. aire",sig:18,tipo:"Negativo",ctrl:"Riego + mallas",est:"controlado"},
      {asp:"Generacion de ruido",imp:"Afect. comunidad",sig:15,tipo:"Negativo",ctrl:"Horarios + barreras",est:"controlado"},
      {asp:"Uso de agua",imp:"Agotamiento recurso",sig:14,tipo:"Negativo",ctrl:"Recirculacion 60%",est:"controlado"},
      {asp:"Generacion RCD",imp:"Contamin. suelo",sig:16,tipo:"Negativo",ctrl:"Segregacion + disposicion",est:"en mejora"},
      {asp:"Emisiones vehiculares",imp:"Contamin. aire",sig:12,tipo:"Negativo",ctrl:"Mantenimiento flota",est:"controlado"},
      {asp:"Derrame combustible",imp:"Contamin. suelo/agua",sig:20,tipo:"Negativo",ctrl:"Bandejas + Kit antiderrame",est:"controlado"},
      {asp:"Revegetacion",imp:"Recuperacion ecosistema",sig:10,tipo:"Positivo",ctrl:"Plan de cierre",est:"en ejecucion"},
    ];
    var residuosData = [{tipo:"Desmonte",vol:450,pct:45,disp:"Relleno autorizado"},{tipo:"Chatarra",vol:80,pct:8,disp:"Reciclaje"},{tipo:"Madera",vol:120,pct:12,disp:"Reutilizacion"},{tipo:"Plasticos",vol:45,pct:4.5,disp:"Reciclaje"},{tipo:"Concreto",vol:200,pct:20,disp:"Reciclaje/Relleno"},{tipo:"Peligrosos",vol:25,pct:2.5,disp:"EO-RS autorizada"},{tipo:"Otros",vol:80,pct:8,disp:"Relleno sanitario"}];
    var resColors = [C.tm, C.i9, C.wn, C.cy, C.pp, C.dn, C.td];

    function AmbDash() {
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Leaf), label: "Huella Carbono", value: "34 tCO2e", sub: "\u2193 29%", subColor: C.ac, glow: C.i14 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "Incidentes Amb.", value: "0", sub: "365 dias sin incidentes", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.RefreshCw), label: "Tasa Reciclaje", value: "72%", sub: "Meta: 70% \u2713", glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Bar), label: "Ahorro Energia", value: "18%", sub: "\u2193 220 kWh/mes", subColor: C.ac, glow: C.cy })
        ),
        React.createElement(Card, { style: { padding: 16, marginBottom: 12 } },
          React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Indicadores Ambientales (Semestre)"),
          React.createElement(ResponsiveContainer, { width: "100%", height: 220 },
            React.createElement(ComposedChart, { data: emTrend },
              React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
              React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { yAxisId: "l", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { yAxisId: "r", orientation: "right", stroke: C.td, fontSize: 10 }),
              React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
              React.createElement(Bar, { yAxisId: "l", dataKey: "co2", fill: C.i14, radius: [3, 3, 0, 0], name: "CO2 (ton)" }),
              React.createElement(Bar, { yAxisId: "l", dataKey: "residuos", fill: C.wn, radius: [3, 3, 0, 0], name: "Residuos (ton)" }),
              React.createElement(Line, { yAxisId: "r", type: "monotone", dataKey: "agua", stroke: C.cy, strokeWidth: 2, dot: { fill: C.cy }, name: "Agua (m3)" }),
              React.createElement(Line, { yAxisId: "r", type: "monotone", dataKey: "energia", stroke: C.pp, strokeWidth: 2, dot: { fill: C.pp }, name: "Energia (kWh)" }),
              React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
            )
          )
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Composicion Residuos"),
            React.createElement(ResponsiveContainer, { width: "100%", height: 180 },
              React.createElement(PieChart, null,
                React.createElement(Pie, { data: residuosData, dataKey: "vol", nameKey: "tipo", cx: "50%", cy: "50%", innerRadius: 30, outerRadius: 60, paddingAngle: 2, strokeWidth: 0 }, residuosData.map(function(e, i) { return React.createElement(Cell, { key: i, fill: resColors[i] }); })),
                React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 }, formatter: function(v) { return v + " ton"; } }),
                React.createElement(Legend, { wrapperStyle: { fontSize: 8 } })
              )
            )
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Cumplimiento Ambiental"),
            [{l:"Monitoreo aire",v:95},{l:"Monitoreo agua",v:88},{l:"Monitoreo ruido",v:92},{l:"Gestion residuos",v:85},{l:"EIA actualizado",v:100},{l:"Permisos vigentes",v:90}].map(function(m) {
              return React.createElement("div", { key: m.l, style: { marginBottom: 6 } },
                React.createElement("div", { style: { display: "flex", justifyContent: "space-between", fontSize: 10, color: C.tm, marginBottom: 2 } }, React.createElement("span", null, m.l), React.createElement("span", { style: { fontWeight: 700, color: m.v >= 90 ? C.ac : C.wn } }, m.v + "%")),
                React.createElement(ProgressBar, { value: m.v, color: C.i14 })
              );
            })
          )
        )
      );
    }

    function AspView() {
      return React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd } }, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Matriz de Aspectos e Impactos"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "Cl. 6.1.2")),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } }, ["Aspecto","Impacto","Sig.","Tipo","Control","Estado"].map(function(h) { return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h); }))),
            React.createElement("tbody", null, aspectos.map(function(a, i) {
              return React.createElement("tr", { key: i, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 600, color: C.tx } }, a.asp),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, a.imp),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: a.sig >= 18 ? "red" : a.sig >= 14 ? "yellow" : "green" }, a.sig)),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: a.tipo === "Positivo" ? "green" : "yellow" }, a.tipo)),
                React.createElement("td", { style: { padding: "8px", color: C.tm, fontSize: 9 } }, a.ctrl),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: a.est === "controlado" ? "green" : "yellow" }, a.est))
              );
            }))
          )
        )
      );
    }

    function ResView() {
      return React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd } }, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Gestion de Residuos de Construccion"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "DS 003-2013-VIVIENDA | Total: 1,000 ton")),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } }, ["Tipo","Vol.(ton)","%","Disposicion","Estado"].map(function(h) { return React.createElement("th", { key: h, style: { padding: "10px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h); }))),
            React.createElement("tbody", null, residuosData.map(function(r, i) {
              return React.createElement("tr", { key: i, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "10px", fontWeight: 600, color: C.tx } }, r.tipo),
                React.createElement("td", { style: { padding: "10px", color: C.pr, fontWeight: 700 } }, r.vol),
                React.createElement("td", { style: { padding: "10px" } }, React.createElement(ProgressBar, { value: r.pct, color: resColors[i] })),
                React.createElement("td", { style: { padding: "10px", color: C.tm } }, r.disp),
                React.createElement("td", { style: { padding: "10px" } }, React.createElement(Badge, { color: r.tipo === "Peligrosos" ? "red" : "green" }, r.tipo === "Peligrosos" ? "Especial" : "Regular"))
              );
            }))
          )
        )
      );
    }

    function MonView() {
      var params = [{p:"PM10",lmp:"150 ug/m3",r:"85 ug/m3",ok:true,f:"Mensual"},{p:"PM2.5",lmp:"50 ug/m3",r:"28 ug/m3",ok:true,f:"Mensual"},{p:"Ruido Diurno",lmp:"80 dB",r:"72 dB",ok:true,f:"Quincenal"},{p:"Ruido Nocturno",lmp:"70 dB",r:"58 dB",ok:true,f:"Quincenal"},{p:"DBO5 efluentes",lmp:"100 mg/L",r:"45 mg/L",ok:true,f:"Trimestral"},{p:"pH efluentes",lmp:"6.5-8.5",r:"7.2",ok:true,f:"Trimestral"},{p:"Aceites y grasas",lmp:"20 mg/L",r:"8 mg/L",ok:true,f:"Trimestral"}];
      return React.createElement(Card, { style: { padding: 16 } },
        React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx, marginBottom: 14 } }, "Programa de Monitoreo Ambiental"),
        params.map(function(m, i) {
          return React.createElement("div", { key: i, style: { display: "grid", gridTemplateColumns: "2fr 1fr 1fr 1fr 1fr", padding: "8px 12px", background: i % 2 === 0 ? C.sa : "transparent", borderRadius: 6, alignItems: "center", gap: 8, fontSize: 10 } },
            React.createElement("span", { style: { color: C.tx, fontWeight: 500 } }, m.p),
            React.createElement("span", { style: { color: C.cy } }, m.lmp),
            React.createElement("span", { style: { color: m.ok ? C.ac : C.dn, fontWeight: 700 } }, m.r),
            React.createElement(Badge, { color: m.ok ? "green" : "red" }, m.ok ? "Cumple" : "Excede"),
            React.createElement("span", { style: { color: C.tm } }, m.f)
          );
        })
      );
    }

    return React.createElement("div", null,
      React.createElement(TabBar, { tabs: tabs, active: aTab, onChange: setATab }),
      aTab === "dashboard-a" ? React.createElement(AmbDash) : null,
      aTab === "aspectos" ? React.createElement(AspView) : null,
      aTab === "residuos" ? React.createElement(ResView) : null,
      aTab === "monitoreo" ? React.createElement(MonView) : null,
      aTab === "db-a" ? React.createElement(EditableDBView, {
        title: "Base de Datos ISO 14001 — Ambiental",
        color: C.i14,
        columns: ["Parametro","LMP","Resultado","Frecuencia","Cumple"],
        rows: [
          {id:1,vals:["PM10","150 ug/m3","85 ug/m3","Mensual","Si"]},
          {id:2,vals:["PM2.5","50 ug/m3","28 ug/m3","Mensual","Si"]},
          {id:3,vals:["Ruido Diurno","80 dB","72 dB","Quincenal","Si"]},
          {id:4,vals:["Ruido Nocturno","70 dB","58 dB","Quincenal","Si"]},
          {id:5,vals:["DBO5 efluentes","100 mg/L","45 mg/L","Trimestral","Si"]},
          {id:6,vals:["pH efluentes","6.5-8.5","7.2","Trimestral","Si"]},
          {id:7,vals:["CO2 mensual","50 ton","34 ton","Mensual","Si"]},
          {id:8,vals:["Tasa reciclaje","70%","72%","Mensual","Si"]},
          {id:9,vals:["Consumo agua","350 m3","265 m3","Mensual","Si"]},
          {id:10,vals:["Consumo energia","1300 kWh","980 kWh","Mensual","Si"]},
        ]
      }) : null
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // ISO 45001:2018 v02 — SISTEMA DE GESTION SST
  // ═══════════════════════════════════════════════════════════════════════
  function ISO45001V2View() {
    var tabs = [
      { key: "dashboard-s", label: "Dashboard SST", icon: Icons.Dash },
      { key: "iperc", label: "IPERC", icon: Icons.Alert },
      { key: "nc-sst", label: "NC / Acciones", icon: Icons.Clipboard },
      { key: "incidentes", label: "Incidentes / Accidentes", icon: Icons.Zap },
      { key: "inspecciones", label: "Inspecciones", icon: Icons.Clipboard },
      { key: "capacitaciones", label: "Capacitaciones", icon: Icons.Users },
      { key: "db-s", label: "Base de Datos", icon: Icons.Database },
    ];
    var sstTrend = [{mes:"Jul",IF:2.1,IS:48,IA:0.05},{mes:"Ago",IF:1.8,IS:40,IA:0.04},{mes:"Sep",IF:1.5,IS:32,IA:0.03},{mes:"Oct",IF:1.2,IS:25,IA:0.02},{mes:"Nov",IF:0.9,IS:18,IA:0.01},{mes:"Dic",IF:0.7,IS:12,IA:0.00}];
    var ipercData = [
      {act:"Excavacion >2m",pel:"Derrumbe/Atrapamiento",prob:3,sev:4,nrp:12,niv:"Intolerable",ctrl:"Entibado + vigias + PETAR"},
      {act:"Trabajo altura >1.8m",pel:"Caida distinto nivel",prob:3,sev:4,nrp:12,niv:"Intolerable",ctrl:"Arnes + linea vida + PETAR"},
      {act:"Izaje con grua",pel:"Caida carga suspendida",prob:2,sev:4,nrp:8,niv:"Importante",ctrl:"Rigger certificado + inspeccion"},
      {act:"Soldadura/Oxicorte",pel:"Quemaduras/Incendio",prob:2,sev:3,nrp:6,niv:"Moderado",ctrl:"EPP especifico + vigias"},
      {act:"Herramientas manuales",pel:"Golpes/Cortes",prob:3,sev:2,nrp:6,niv:"Moderado",ctrl:"Inspeccion pre-uso + ATS"},
      {act:"Trabajos electricos",pel:"Electrocucion",prob:2,sev:4,nrp:8,niv:"Importante",ctrl:"LOTO + PETAR"},
      {act:"Manipulacion quimicos",pel:"Intoxicacion",prob:2,sev:3,nrp:6,niv:"Moderado",ctrl:"MSDS + EPP + ventilacion"},
      {act:"Transporte materiales",pel:"Atropello/Volcadura",prob:2,sev:4,nrp:8,niv:"Importante",ctrl:"Vigia + vel. controlada"},
    ];
    var caps = [
      {tema:"Induccion General SST",tipo:"Obligatoria",h:8,a:100,f:"Al ingreso"},{tema:"Trabajos en Altura",tipo:"Especifica",h:4,a:98,f:"Semestral"},
      {tema:"Excavaciones y Zanjas",tipo:"Especifica",h:4,a:95,f:"Semestral"},{tema:"IPERC y ATS",tipo:"Obligatoria",h:4,a:97,f:"Trimestral"},
      {tema:"Primeros Auxilios",tipo:"Obligatoria",h:8,a:92,f:"Anual"},{tema:"Uso de Extintores",tipo:"Obligatoria",h:2,a:96,f:"Semestral"},
      {tema:"LOTO",tipo:"Especifica",h:4,a:90,f:"Semestral"},{tema:"Manejo Defensivo",tipo:"Especifica",h:4,a:88,f:"Anual"},
    ];
    var inspDB = [
      {id:"INS-125",tipo:"EPP",area:"Obras civiles",fecha:"2025-12-20",hall:2,crit:0,insp:"J. Perez",est:"cerrada"},
      {id:"INS-124",tipo:"Orden/Limpieza",area:"Almacen",fecha:"2025-12-18",hall:3,crit:1,insp:"M. Garcia",est:"abierta"},
      {id:"INS-123",tipo:"Herramientas",area:"Estructura",fecha:"2025-12-15",hall:1,crit:0,insp:"R. Torres",est:"cerrada"},
      {id:"INS-122",tipo:"Protecciones",area:"Fachada",fecha:"2025-12-12",hall:4,crit:2,insp:"C. Vargas",est:"abierta"},
      {id:"INS-121",tipo:"Senalizacion",area:"Perimetro",fecha:"2025-12-10",hall:2,crit:0,insp:"A. Ruiz",est:"cerrada"},
    ];

    function SSTDash() {
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Shield), label: "Ind. Frecuencia", value: "0.70", sub: "Meta <1.0 \u2713", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "Accid. Incapac.", value: "0", sub: "127 dias sin accidentes", glow: C.i45 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Users), label: "Personal Capac.", value: "98%", sub: "412/420", glow: C.pr }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Clipboard), label: "Inspecciones", value: "45", sub: "12 hallazgos abiertos", subColor: C.wn, glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Eye), label: "PETAR Emitidos", value: "189", sub: "Dic 2025", glow: C.cy })
        ),
        React.createElement(Card, { style: { padding: 16, marginBottom: 12 } },
          React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Indices de Siniestralidad"),
          React.createElement(ResponsiveContainer, { width: "100%", height: 200 },
            React.createElement(ComposedChart, { data: sstTrend },
              React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
              React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { yAxisId: "l", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { yAxisId: "r", orientation: "right", stroke: C.td, fontSize: 10 }),
              React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
              React.createElement(Line, { yAxisId: "l", type: "monotone", dataKey: "IF", stroke: C.i45, strokeWidth: 2.5, dot: { fill: C.i45, r: 4 }, name: "Ind. Frecuencia" }),
              React.createElement(Line, { yAxisId: "r", type: "monotone", dataKey: "IS", stroke: C.dn, strokeWidth: 2, dot: { fill: C.dn, r: 3 }, name: "Ind. Severidad" }),
              React.createElement(Bar, { yAxisId: "l", dataKey: "IA", fill: C.wn, radius: [3, 3, 0, 0], name: "Ind. Accidentab." }),
              React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
            )
          )
        ),
        React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 } },
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 10 } }, "Piramide de Accidentabilidad"),
            [{l:"Fatalidad",v:0,c:C.dn,w:"20%"},{l:"Accid. Incapacitante",v:0,c:C.dn+"cc",w:"35%"},{l:"Accidente Leve",v:2,c:C.wn,w:"50%"},{l:"Incidentes Peligrosos",v:5,c:C.wn+"88",w:"65%"},{l:"Cuasi Accidentes",v:18,c:C.i45,w:"80%"},{l:"Actos/Cond. Subestandar",v:45,c:C.pr,w:"100%"}].map(function(p, i) {
              return React.createElement("div", { key: i, style: { display: "flex", alignItems: "center", gap: 8, marginBottom: 6 } },
                React.createElement("div", { style: { width: p.w, height: 22, background: p.c, borderRadius: 4, display: "flex", alignItems: "center", paddingLeft: 8 } }, React.createElement("span", { style: { fontSize: 9, fontWeight: 700, color: "#fff" } }, p.v)),
                React.createElement("span", { style: { fontSize: 9, color: C.tm, whiteSpace: "nowrap" } }, p.l)
              );
            })
          ),
          React.createElement(Card, { style: { padding: 16 } },
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 10 } }, "Cumplimiento SST por Area"),
            [{a:"Obras civiles",v:92},{a:"Estructuras metalicas",v:88},{a:"Inst. electricas",v:90},{a:"Acabados",v:85},{a:"Almacen",v:87},{a:"Equipos pesados",v:94}].map(function(x) {
              return React.createElement("div", { key: x.a, style: { marginBottom: 6 } },
                React.createElement("div", { style: { display: "flex", justifyContent: "space-between", fontSize: 10, color: C.tm, marginBottom: 2 } }, React.createElement("span", null, x.a), React.createElement("span", { style: { fontWeight: 700, color: x.v >= 90 ? C.ac : C.wn } }, x.v + "%")),
                React.createElement(ProgressBar, { value: x.v, color: C.i45 })
              );
            })
          )
        )
      );
    }

    function IPERCView() {
      var nc = {Intolerable:"red",Importante:"yellow",Moderado:"blue",Tolerable:"green"};
      return React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd } }, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Matriz IPERC"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "Ley 29783 | G.050 | NRP = P x S")),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } }, ["Actividad","Peligro","P","S","NRP","Nivel","Control"].map(function(h) { return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase", whiteSpace: "nowrap" } }, h); }))),
            React.createElement("tbody", null, ipercData.map(function(r, i) {
              return React.createElement("tr", { key: i, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 600, color: C.tx } }, r.act),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, r.pel),
                React.createElement("td", { style: { padding: "8px", color: C.wn, fontWeight: 700, textAlign: "center" } }, r.prob),
                React.createElement("td", { style: { padding: "8px", color: C.dn, fontWeight: 700, textAlign: "center" } }, r.sev),
                React.createElement("td", { style: { padding: "8px", fontWeight: 800, color: r.nrp >= 12 ? C.dn : r.nrp >= 8 ? C.wn : C.ac, textAlign: "center" } }, r.nrp),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: nc[r.niv] }, r.niv)),
                React.createElement("td", { style: { padding: "8px", color: C.tm, fontSize: 9 } }, r.ctrl)
              );
            }))
          )
        )
      );
    }

    function InspView() {
      return React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd, display: "flex", justifyContent: "space-between", alignItems: "center" } },
          React.createElement("div", null, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Inspecciones SST"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "G.050 | DS 011-2019-TR")),
          React.createElement(Btn, { primary: true }, React.createElement(Icons.Plus), " Nueva")
        ),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } }, ["Codigo","Tipo","Area","Fecha","Hall.","Crit.","Inspector","Estado"].map(function(h) { return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h); }))),
            React.createElement("tbody", null, inspDB.map(function(ins) {
              return React.createElement("tr", { key: ins.id, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 700, color: C.pr } }, ins.id),
                React.createElement("td", { style: { padding: "8px", color: C.tx } }, ins.tipo),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, ins.area),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, ins.fecha),
                React.createElement("td", { style: { padding: "8px", fontWeight: 700, color: C.wn } }, ins.hall),
                React.createElement("td", { style: { padding: "8px" } }, ins.crit > 0 ? React.createElement(Badge, { color: "red" }, ins.crit) : React.createElement(Badge, { color: "green" }, "0")),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, ins.insp),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: ins.est === "cerrada" ? "green" : "yellow" }, ins.est))
              );
            }))
          )
        )
      );
    }

    function CapView() {
      return React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd } }, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Plan Capacitacion SST"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "Ley 29783 Art.35")),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } }, ["Tema","Tipo","Horas","Asistencia","Frecuencia"].map(function(h) { return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h); }))),
            React.createElement("tbody", null, caps.map(function(c, i) {
              return React.createElement("tr", { key: i, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 600, color: C.tx } }, c.tema),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: c.tipo === "Obligatoria" ? "yellow" : "cyan" }, c.tipo)),
                React.createElement("td", { style: { padding: "8px", color: C.pr, fontWeight: 700 } }, c.h + "h"),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 4 } }, React.createElement(ProgressBar, { value: c.a, color: C.i45 }), React.createElement("span", { style: { fontSize: 9, fontWeight: 600, color: c.a >= 95 ? C.ac : C.wn } }, c.a + "%"))),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, c.f)
              );
            }))
          )
        )
      );
    }

    function NCSSTView() {
      var ncSST = [
        {id:"NC-SST-012",tipo:"Mayor",area:"Obras civiles",desc:"IPERC no actualizada para actividades de excavacion >4m profundidad",estado:"abierta",fecha:"2025-12-18",resp:"J. Perez",plazo:"2026-01-20",avance:30},
        {id:"NC-SST-011",tipo:"Menor",area:"Estructura",desc:"Arneses de seguridad sin inspeccion trimestral documentada",estado:"en proceso",fecha:"2025-12-10",resp:"M. Torres",plazo:"2026-01-05",avance:65},
        {id:"NC-SST-010",tipo:"Menor",area:"Almacen",desc:"Extintores en zona de acopio sin revision mensual vigente",estado:"cerrada",fecha:"2025-11-25",resp:"R. Diaz",plazo:"2025-12-15",avance:100},
        {id:"NC-SST-009",tipo:"Mayor",area:"Inst. electricas",desc:"Procedimiento LOTO no aplicado en tablero general durante mantenimiento",estado:"cerrada",fecha:"2025-11-15",resp:"C. Vargas",plazo:"2025-12-10",avance:100},
        {id:"OBS-SST-005",tipo:"Observacion",area:"General",desc:"Senalizacion temporal insuficiente en desvio peatonal de obra",estado:"abierta",fecha:"2025-12-22",resp:"A. Ruiz",plazo:"2026-01-10",avance:15},
      ];
      var estC={abierta:"red","en proceso":"yellow",cerrada:"green"};
      var tipC={Mayor:"red",Menor:"yellow",Observacion:"blue"};
      return React.createElement("div", null,
        React.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14,flexWrap:"wrap",gap:8}},
          React.createElement("div",{style:{display:"flex",gap:8}},
            React.createElement(Badge,{color:"red"},"Abiertas: "+ncSST.filter(function(n){return n.estado==="abierta";}).length),
            React.createElement(Badge,{color:"yellow"},"En Proceso: "+ncSST.filter(function(n){return n.estado==="en proceso";}).length),
            React.createElement(Badge,{color:"green"},"Cerradas: "+ncSST.filter(function(n){return n.estado==="cerrada";}).length)
          ),
          React.createElement(Btn,{primary:true},React.createElement(Icons.Plus)," Registrar NC SST")
        ),
        React.createElement(Card,{p:0},React.createElement("div",{style:{overflowX:"auto"}},
          React.createElement("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:10}},
            React.createElement("thead",null,React.createElement("tr",{style:{borderBottom:"1px solid "+C.bd}},
              ["Codigo","Tipo","Area","Descripcion","Estado","Responsable","Plazo","Avance"].map(function(h){
                return React.createElement("th",{key:h,style:{padding:"10px 8px",textAlign:"left",fontSize:8,fontWeight:700,color:C.td,textTransform:"uppercase",whiteSpace:"nowrap"}},h);
              })
            )),
            React.createElement("tbody",null,ncSST.map(function(nc){
              return React.createElement("tr",{key:nc.id,style:{borderBottom:"1px solid "+C.bd+"50"},onMouseEnter:function(e){e.currentTarget.style.background=C.cardH;},onMouseLeave:function(e){e.currentTarget.style.background="transparent";}},
                React.createElement("td",{style:{padding:"8px",fontWeight:700,color:C.i45,whiteSpace:"nowrap"}},nc.id),
                React.createElement("td",{style:{padding:"8px"}},React.createElement(Badge,{color:tipC[nc.tipo]},nc.tipo)),
                React.createElement("td",{style:{padding:"8px",color:C.tm}},nc.area),
                React.createElement("td",{style:{padding:"8px",color:C.tx,maxWidth:220}},nc.desc),
                React.createElement("td",{style:{padding:"8px"}},React.createElement(Badge,{color:estC[nc.estado]},nc.estado)),
                React.createElement("td",{style:{padding:"8px",color:C.tm,whiteSpace:"nowrap"}},nc.resp),
                React.createElement("td",{style:{padding:"8px",color:C.tm,whiteSpace:"nowrap"}},nc.plazo),
                React.createElement("td",{style:{padding:"8px",minWidth:80}},React.createElement("div",{style:{display:"flex",alignItems:"center",gap:4}},React.createElement(ProgressBar,{value:nc.avance,color:C.i45}),React.createElement("span",{style:{fontSize:9,fontWeight:600,color:nc.avance===100?C.ac:C.tm}},nc.avance+"%")))
              );
            }))
          )
        ))
      );
    }

    function IncidentesView() {
      var tipC2={
        "Incidente Peligroso":"red","Cuasi Accidente":"yellow","Accidente Leve":"blue",
        "Accidente Incapacitante":"red","Fatalidad":"red"
      };
      var estC2={abierto:"yellow",cerrado:"green"};
      return React.createElement("div",null,
        React.createElement("div",{style:{display:"flex",gap:12,marginBottom:16,flexWrap:"wrap"}},
          React.createElement(KPICard,{icon:React.createElement(Icons.Zap),label:"Total Eventos 2025",value:String(incidentsDB.length),sub:"Registrados",glow:C.i45}),
          React.createElement(KPICard,{icon:React.createElement(Icons.Alert),label:"Incidentes Peligrosos",value:String(incidentsDB.filter(function(i){return i.tipo==="Incidente Peligroso";}).length),glow:C.dn}),
          React.createElement(KPICard,{icon:React.createElement(Icons.Shield),label:"Cuasi Accidentes",value:String(incidentsDB.filter(function(i){return i.tipo==="Cuasi Accidente";}).length),glow:C.wn}),
          React.createElement(KPICard,{icon:React.createElement(Icons.Check),label:"Investigados",value:String(incidentsDB.filter(function(i){return i.invest==="Completa";}).length)+"/"+incidentsDB.length,glow:C.ac})
        ),
        React.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}},
          React.createElement("div",{style:{display:"flex",gap:6}},
            React.createElement(Badge,{color:"yellow"},"Abiertos: "+incidentsDB.filter(function(i){return i.est==="abierto";}).length),
            React.createElement(Badge,{color:"green"},"Cerrados: "+incidentsDB.filter(function(i){return i.est==="cerrado";}).length)
          ),
          React.createElement(Btn,{primary:true,onClick:function(){setShowIncForm(!showIncForm);}},React.createElement(Icons.Plus)," Registrar Incidente")
        ),
        showIncForm?React.createElement(Card,{style:{padding:16,marginBottom:12}},
          React.createElement("div",{style:{fontSize:12,fontWeight:700,color:C.tx,marginBottom:12}},"Nuevo Registro de Incidente/Accidente"),
          React.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}},
            React.createElement(SelectField,{label:"Tipo de Evento",value:incForm.tipo,onChange:function(v){setIncForm(Object.assign({},incForm,{tipo:v}));},options:["Cuasi Accidente","Incidente Peligroso","Accidente Leve","Accidente Incapacitante","Fatalidad"]}),
            React.createElement(InputField,{label:"Fecha",value:incForm.fecha,onChange:function(v){setIncForm(Object.assign({},incForm,{fecha:v}));},type:"date"}),
            React.createElement(SelectField,{label:"Area",value:incForm.area,onChange:function(v){setIncForm(Object.assign({},incForm,{area:v}));},options:["Obras civiles","Estructura","Inst. electricas","Acabados","Almacen","Equipos pesados","Administracion"]}),
            React.createElement(InputField,{label:"Lesion",value:incForm.lesion,onChange:function(v){setIncForm(Object.assign({},incForm,{lesion:v}));},placeholder:"Ninguna / Descripcion"})
          ),
          React.createElement(InputField,{label:"Descripcion del Evento",value:incForm.desc,onChange:function(v){setIncForm(Object.assign({},incForm,{desc:v}));},placeholder:"Describir detalladamente el evento..."}),
          React.createElement("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:8}},
            React.createElement(Btn,{onClick:function(){setShowIncForm(false);}},"Cancelar"),
            React.createElement(Btn,{accent:true,onClick:function(){
              if(incForm.tipo&&incForm.fecha&&incForm.desc){
                var ni={id:"INC-"+String(incidentsDB.length+1).padStart(3,"0"),tipo:incForm.tipo,fecha:incForm.fecha,area:incForm.area||"General",desc:incForm.desc,lesion:incForm.lesion||"Ninguna",diasP:0,invest:"Pendiente",accion:"Por definir",est:"abierto"};
                setIncidentsDB(incidentsDB.concat([ni]));
                setIncForm({tipo:"",fecha:"",area:"",desc:"",lesion:"Ninguna",diasP:0});
                setShowIncForm(false);
              }
            }},React.createElement(Icons.Check)," Registrar")
          )
        ):null,
        React.createElement(Card,{p:0},React.createElement("div",{style:{overflowX:"auto"}},
          React.createElement("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:10}},
            React.createElement("thead",null,React.createElement("tr",{style:{borderBottom:"1px solid "+C.bd}},
              ["Codigo","Tipo","Fecha","Area","Descripcion","Lesion","Investigacion","Accion Correctiva","Estado"].map(function(h){
                return React.createElement("th",{key:h,style:{padding:"10px 6px",textAlign:"left",fontSize:8,fontWeight:700,color:C.td,textTransform:"uppercase",whiteSpace:"nowrap"}},h);
              })
            )),
            React.createElement("tbody",null,incidentsDB.map(function(inc){
              return React.createElement("tr",{key:inc.id,style:{borderBottom:"1px solid "+C.bd+"50"},onMouseEnter:function(e){e.currentTarget.style.background=C.cardH;},onMouseLeave:function(e){e.currentTarget.style.background="transparent";}},
                React.createElement("td",{style:{padding:"6px",fontWeight:700,color:C.i45,whiteSpace:"nowrap"}},inc.id),
                React.createElement("td",{style:{padding:"6px"}},React.createElement(Badge,{color:tipC2[inc.tipo]||"yellow"},inc.tipo)),
                React.createElement("td",{style:{padding:"6px",color:C.tm,whiteSpace:"nowrap"}},inc.fecha),
                React.createElement("td",{style:{padding:"6px",color:C.tm}},inc.area),
                React.createElement("td",{style:{padding:"6px",color:C.tx,maxWidth:180,fontSize:9}},inc.desc),
                React.createElement("td",{style:{padding:"6px",color:inc.lesion==="Ninguna"?C.ac:C.wn,fontSize:9}},inc.lesion),
                React.createElement("td",{style:{padding:"6px"}},React.createElement(Badge,{color:inc.invest==="Completa"?"green":inc.invest==="En curso"?"yellow":"red"},inc.invest)),
                React.createElement("td",{style:{padding:"6px",color:C.tm,fontSize:9,maxWidth:160}},inc.accion),
                React.createElement("td",{style:{padding:"6px"}},React.createElement(Badge,{color:estC2[inc.est]||"yellow"},inc.est))
              );
            }))
          )
        )),
        React.createElement("div",{style:{padding:"12px 0",fontSize:9,color:C.td}},"Ley 29783 Art.82 | DS 005-2012-TR Art.110 | Registro obligatorio de incidentes, accidentes y enfermedades ocupacionales")
      );
    }

    return React.createElement("div", null,
      React.createElement(TabBar, { tabs: tabs, active: sTab, onChange: setSTab }),
      sTab === "dashboard-s" ? React.createElement(SSTDash) : null,
      sTab === "iperc" ? React.createElement(IPERCView) : null,
      sTab === "nc-sst" ? React.createElement(NCSSTView) : null,
      sTab === "incidentes" ? React.createElement(IncidentesView) : null,
      sTab === "inspecciones" ? React.createElement(InspView) : null,
      sTab === "capacitaciones" ? React.createElement(CapView) : null,
      sTab === "db-s" ? React.createElement(EditableDBView, {
        title: "Base de Datos ISO 45001 — SST",
        color: C.i45,
        columns: ["Indicador","Formula","Meta","Resultado","Periodo"],
        rows: [
          {id:1,vals:["Indice Frecuencia","(Accidentes/HHT)x200000","<1.0","0.70","Mensual"]},
          {id:2,vals:["Indice Severidad","(Dias perdidos/HHT)x200000","<50","12","Mensual"]},
          {id:3,vals:["Indice Accidentabilidad","IFxIS/1000","<0.05","0.00","Mensual"]},
          {id:4,vals:["Capacitacion SST","(Ejecutado/Programado)x100",">=95%","98%","Mensual"]},
          {id:5,vals:["Inspecciones planeadas","Ejecutadas/Programadas","100%","93%","Semanal"]},
          {id:6,vals:["PETAR emitidos","Total del mes",">=150","189","Mensual"]},
          {id:7,vals:["Cuasi accidentes reportados","Total reportados",">=10","18","Mensual"]},
          {id:8,vals:["Observaciones SST levantadas","(Levantadas/Total)x100",">=90%","87%","Mensual"]},
        ]
      }) : null
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // ISO 37001:2016 v02 — SISTEMA DE GESTION ANTISOBORNO
  // ═══════════════════════════════════════════════════════════════════════
  function ISO37001V2View() {
    var tabs = [
      { key: "dashboard-ab", label: "Dashboard", icon: Icons.Dash },
      { key: "due-diligence", label: "Due Diligence", icon: Icons.Search },
      { key: "canal-etico", label: "Canal Etico", icon: Icons.Shield },
      { key: "riesgos-ab", label: "Mapa Riesgos", icon: Icons.Alert },
      { key: "db-ab", label: "Base de Datos", icon: Icons.Database },
    ];
    var ddTrend = [{mes:"Jul",alto:2,medio:3,bajo:3},{mes:"Ago",alto:3,medio:4,bajo:5},{mes:"Sep",alto:1,medio:4,bajo:5},{mes:"Oct",alto:2,medio:5,bajo:8},{mes:"Nov",alto:1,medio:3,bajo:7},{mes:"Dic",alto:0,medio:4,bajo:10}];
    var ddReg = [
      {ent:"Constructora XYZ SAC",tipo:"Proveedor",riesgo:"Alto",score:35,est:"En revision",fecha:"2025-12-10"},
      {ent:"Minera Andina SRL",tipo:"Cliente",riesgo:"Medio",score:62,est:"Aprobado condic.",fecha:"2025-11-28"},
      {ent:"Transportes Lima SAC",tipo:"Proveedor",riesgo:"Bajo",score:85,est:"Aprobado",fecha:"2025-12-05"},
      {ent:"Gob. Regional Junin",tipo:"Cliente Publico",riesgo:"Alto",score:40,est:"En revision",fecha:"2025-12-15"},
      {ent:"Aceros del Peru SA",tipo:"Proveedor",riesgo:"Bajo",score:92,est:"Aprobado",fecha:"2025-10-20"},
    ];
    var denuncias = [
      {id:"DEN-007",tipo:"Conflicto de interes",est:"Resuelto",fecha:"2025-12-01",canal:"Web",riesgo:"Medio",dias:15},
      {id:"DEN-006",tipo:"Pago irregular a funcionario",est:"En investigacion",fecha:"2025-11-20",canal:"Telefono",riesgo:"Alto",dias:null},
      {id:"DEN-005",tipo:"Regalos no declarados",est:"Resuelto",fecha:"2025-10-15",canal:"Email",riesgo:"Bajo",dias:12},
    ];
    var riesgos = [
      {r:"Soborno a funcionarios para permisos",prob:3,imp:4,nrp:12,ctrl:"Due diligence + prohibicion regalos",res:"Medio"},
      {r:"Pagos facilitacion en tramites",prob:3,imp:3,nrp:9,ctrl:"Politica cero tolerancia",res:"Bajo"},
      {r:"Conflicto interes en adquisiciones",prob:2,imp:3,nrp:6,ctrl:"Declaracion jurada + rotacion",res:"Bajo"},
      {r:"Regalos/hospitalidad excesivos",prob:2,imp:2,nrp:4,ctrl:"Registro + aprobacion gerencial",res:"Bajo"},
      {r:"Lavado activos subcontratistas",prob:1,imp:4,nrp:4,ctrl:"KYC + monitoreo transaccional",res:"Bajo"},
    ];

    function ABDash() {
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Gavel), label: "Due Diligence", value: "70", sub: "Evaluaciones 2025", glow: C.i37 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Alert), label: "Denuncias Activas", value: "1", sub: "2 resueltas", subColor: C.ac, glow: C.wn }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Users), label: "Capacitacion", value: "94%", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Shield), label: "Riesgo Residual", value: "Bajo", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Check), label: "Cumpl. Ley 30424", value: "78%", glow: C.pp })
        ),
        React.createElement(Card, { style: { padding: 16 } },
          React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx, marginBottom: 12 } }, "Due Diligence por Nivel de Riesgo"),
          React.createElement(ResponsiveContainer, { width: "100%", height: 200 },
            React.createElement(BarChart, { data: ddTrend },
              React.createElement(CartesianGrid, { strokeDasharray: "3 3", stroke: C.bd }),
              React.createElement(XAxis, { dataKey: "mes", stroke: C.td, fontSize: 10 }),
              React.createElement(YAxis, { stroke: C.td, fontSize: 10 }),
              React.createElement(Tooltip, { contentStyle: { background: C.card, border: "1px solid " + C.bd, borderRadius: 8, fontSize: 11 } }),
              React.createElement(Bar, { dataKey: "alto", stackId: "a", fill: C.dn, name: "Alto" }),
              React.createElement(Bar, { dataKey: "medio", stackId: "a", fill: C.wn, name: "Medio" }),
              React.createElement(Bar, { dataKey: "bajo", stackId: "a", fill: C.ac, radius: [3, 3, 0, 0], name: "Bajo" }),
              React.createElement(Legend, { wrapperStyle: { fontSize: 9 } })
            )
          )
        )
      );
    }

    function DDView() {
      var rc = {Alto:"red",Medio:"yellow",Bajo:"green"}; var ec = {Aprobado:"green","Aprobado condic.":"yellow","En revision":"red"};
      return React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd, display: "flex", justifyContent: "space-between", alignItems: "center" } },
          React.createElement("div", null, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Registro Due Diligence"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "Cl. 8.2")),
          React.createElement(Btn, { primary: true }, React.createElement(Icons.Plus), " Nueva Evaluacion")
        ),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } }, ["Entidad","Tipo","Riesgo","Score","Estado","Fecha"].map(function(h) { return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h); }))),
            React.createElement("tbody", null, ddReg.map(function(dd, i) {
              return React.createElement("tr", { key: i, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 600, color: C.tx } }, dd.ent),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, dd.tipo),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: rc[dd.riesgo] }, dd.riesgo)),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 4 } }, React.createElement(ProgressBar, { value: dd.score, color: dd.score >= 70 ? C.ac : dd.score >= 50 ? C.wn : C.dn }), React.createElement("span", { style: { fontSize: 9, fontWeight: 700, color: dd.score >= 70 ? C.ac : dd.score >= 50 ? C.wn : C.dn } }, dd.score + "%"))),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: ec[dd.est] }, dd.est)),
                React.createElement("td", { style: { padding: "8px", color: C.tm } }, dd.fecha)
              );
            }))
          )
        )
      );
    }

    function CEView() {
      return React.createElement("div", null,
        React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 16, flexWrap: "wrap" } },
          React.createElement(KPICard, { icon: React.createElement(Icons.Shield), label: "Total 2025", value: "7", glow: C.i37 }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Check), label: "Resueltas", value: "6", sub: "85.7%", glow: C.ac }),
          React.createElement(KPICard, { icon: React.createElement(Icons.Clock), label: "Tiempo Prom.", value: "13d", glow: C.pr })
        ),
        React.createElement(Card, { p: 0 },
          React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd } }, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Canal Etico — Denuncias"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "Cl. 8.9 | Ley 30424")),
          denuncias.map(function(d, i) {
            var rc2 = {Alto:C.dn,Medio:C.wn,Bajo:C.ac};
            return React.createElement("div", { key: i, style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd + "50", borderLeft: "3px solid " + rc2[d.riesgo] } },
              React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 6 } },
                React.createElement("div", { style: { display: "flex", gap: 8, alignItems: "center" } },
                  React.createElement("span", { style: { fontSize: 11, fontWeight: 700, color: C.pr } }, d.id),
                  React.createElement(Badge, { color: d.est === "Resuelto" ? "green" : "yellow" }, d.est),
                  React.createElement(Badge, { color: d.riesgo === "Alto" ? "red" : d.riesgo === "Medio" ? "yellow" : "green" }, d.riesgo)
                ),
                React.createElement("span", { style: { fontSize: 9, color: C.td } }, d.fecha)
              ),
              React.createElement("div", { style: { fontSize: 11, color: C.tx } }, d.tipo),
              React.createElement("div", { style: { fontSize: 9, color: C.tm, marginTop: 2 } }, "Canal: " + d.canal + (d.dias ? " | " + d.dias + " dias" : " | En curso"))
            );
          })
        )
      );
    }

    function RiesView() {
      return React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd } }, React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Mapa de Riesgos de Soborno"), React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "Cl. 4.5 | NRP = P x I")),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } }, ["Riesgo","P","I","NRP","Control","Residual"].map(function(h) { return React.createElement("th", { key: h, style: { padding: "10px 8px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase" } }, h); }))),
            React.createElement("tbody", null, riesgos.map(function(r, i) {
              return React.createElement("tr", { key: i, style: { borderBottom: "1px solid " + C.bd + "50" }, onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "8px", fontWeight: 500, color: C.tx, maxWidth: 220 } }, r.r),
                React.createElement("td", { style: { padding: "8px", color: C.wn, fontWeight: 700, textAlign: "center" } }, r.prob),
                React.createElement("td", { style: { padding: "8px", color: C.dn, fontWeight: 700, textAlign: "center" } }, r.imp),
                React.createElement("td", { style: { padding: "8px", fontWeight: 800, color: r.nrp >= 12 ? C.dn : r.nrp >= 6 ? C.wn : C.ac, textAlign: "center" } }, r.nrp),
                React.createElement("td", { style: { padding: "8px", color: C.tm, fontSize: 9 } }, r.ctrl),
                React.createElement("td", { style: { padding: "8px" } }, React.createElement(Badge, { color: r.res === "Medio" ? "yellow" : "green" }, r.res))
              );
            }))
          )
        )
      );
    }

    return React.createElement("div", null,
      React.createElement(TabBar, { tabs: tabs, active: abTab, onChange: setAbTab }),
      abTab === "dashboard-ab" ? React.createElement(ABDash) : null,
      abTab === "due-diligence" ? React.createElement(DDView) : null,
      abTab === "canal-etico" ? React.createElement(CEView) : null,
      abTab === "riesgos-ab" ? React.createElement(RiesView) : null,
      abTab === "db-ab" ? React.createElement(EditableDBView, {
        title: "Base de Datos ISO 37001 — Antisoborno",
        color: C.i37,
        columns: ["Indicador","Clausula","Meta","Resultado","Estado"],
        rows: [
          {id:1,vals:["Due Diligence completadas","8.2",">=60/anio","70","Cumple"]},
          {id:2,vals:["Denuncias canal etico","8.9","Seguimiento 100%","7 (86% resueltas)","En proceso"]},
          {id:3,vals:["Capacitacion antisoborno","7.3",">=90%","94%","Cumple"]},
          {id:4,vals:["Riesgo residual promedio","4.5","Bajo","Bajo","Cumple"]},
          {id:5,vals:["Cumplimiento Ley 30424","All",">=75%","78%","En proceso"]},
          {id:6,vals:["Declaraciones juradas","7.5","100% personal clave","92%","En proceso"]},
          {id:7,vals:["Proveedores evaluados","8.2",">=80% criticos","85%","Cumple"]},
          {id:8,vals:["Tiempo resolucion denuncias","8.9","<=20 dias","13 dias","Cumple"]},
        ]
      }) : null
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // LISTA MAESTRA DE DOCUMENTOS
  // ═══════════════════════════════════════════════════════════════════════
  function ListaMaestraView() {
    var filtered = masterListDB.filter(function(d) {
      var matchSearch = !mlSearch || d.name.toLowerCase().indexOf(mlSearch.toLowerCase()) >= 0 || d.id.toLowerCase().indexOf(mlSearch.toLowerCase()) >= 0;
      var matchFilter = mlFilter === "all" || d.iso === mlFilter || d.status === mlFilter;
      return matchSearch && matchFilter;
    });

    function parseImport(text) {
      var lines = text.trim().split("\n");
      var added = [];
      lines.forEach(function(line) {
        var parts = line.split("|").map(function(p){return p.trim();});
        if (parts.length >= 3) {
          var newDoc = {
            id: parts[0] || "DOC-" + String(masterListDB.length + added.length + 1).padStart(3, "0"),
            name: parts[1] || "Documento Importado",
            iso: parts[2] || "multi",
            area: parts[3] || "General",
            pdca: parts[4] || "P",
            status: "vigente",
            version: parts[5] || "1.0",
            date: new Date().toISOString().slice(0, 10),
            pages: 1,
            mlId: masterListDB.length + added.length + 1,
            origen: "Importacion Inteligente",
            fechaAlta: new Date().toISOString().slice(0, 10),
            responsable: parts[6] || "Coord. SIG",
            ubicacion: "Servidor SIG",
            retencion: "3 anios",
          };
          added.push(newDoc);
        }
      });
      if (added.length > 0) {
        setMasterListDB(masterListDB.concat(added));
        setImportText("");
        setShowImport(false);
      }
    }

    var isoColor = { "9001": "blue", "14001": "green", "45001": "yellow", "37001": "purple", multi: "cyan" };
    var statusColor = { vigente: "green", revision: "yellow", abierto: "red" };

    return React.createElement("div", null,
      React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14, flexWrap: "wrap", gap: 8 } },
        React.createElement("div", { style: { display: "flex", gap: 8, alignItems: "center" } },
          React.createElement("div", { style: { position: "relative" } },
            React.createElement("input", { placeholder: "Buscar documento...", value: mlSearch,
              onChange: function(e) { setMlSearch(e.target.value); },
              style: { padding: "8px 12px 8px 32px", borderRadius: 8, border: "1px solid " + C.bd, background: C.sa, color: C.tx, fontSize: 11, fontFamily: "inherit", width: 220 }
            }),
            React.createElement("div", { style: { position: "absolute", left: 10, top: "50%", transform: "translateY(-50%)", color: C.td } }, React.createElement(Icons.Search))
          ),
          React.createElement("select", {
            value: mlFilter, onChange: function(e) { setMlFilter(e.target.value); },
            style: { padding: "8px 12px", borderRadius: 8, border: "1px solid " + C.bd, background: C.sa, color: C.tx, fontSize: 11, fontFamily: "inherit" }
          },
            React.createElement("option", { value: "all" }, "Todos"),
            React.createElement("option", { value: "9001" }, "ISO 9001"),
            React.createElement("option", { value: "14001" }, "ISO 14001"),
            React.createElement("option", { value: "45001" }, "ISO 45001"),
            React.createElement("option", { value: "37001" }, "ISO 37001"),
            React.createElement("option", { value: "vigente" }, "Vigentes"),
            React.createElement("option", { value: "revision" }, "En Revision")
          )
        ),
        React.createElement("div", { style: { display: "flex", gap: 6 } },
          React.createElement(Btn, { primary: true, onClick: function() { setShowImport(!showImport); } }, React.createElement(Icons.Upload), " Importar Docs"),
          React.createElement(Badge, { color: "cyan" }, "Total: " + filtered.length + "/" + masterListDB.length)
        )
      ),
      showImport ? React.createElement(Card, { style: { padding: 16, marginBottom: 12, borderLeft: "3px solid " + C.pr } },
        React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 8, marginBottom: 10 } },
          React.createElement("div", { style: { width: 28, height: 28, borderRadius: 8, background: C.pr + "18", display: "flex", alignItems: "center", justifyContent: "center", color: C.pr } }, React.createElement(Icons.Zap)),
          React.createElement("div", null,
            React.createElement("div", { style: { fontSize: 12, fontWeight: 700, color: C.tx } }, "Importacion Inteligente de Documentos"),
            React.createElement("div", { style: { fontSize: 9, color: C.td } }, "Formato: CODIGO | NOMBRE | ISO | AREA | PDCA | VERSION | RESPONSABLE")
          )
        ),
        React.createElement("div", { style: { padding: 10, background: C.sa, borderRadius: 8, marginBottom: 8, fontSize: 9, color: C.tm } },
          "Ejemplo de formato (una linea por documento):",
          React.createElement("br"),
          React.createElement("code", { style: { color: C.cy } }, "DOC-030 | Plan de Contingencias | 45001 | SSOMA | P | 2.0 | J. Perez"),
          React.createElement("br"),
          React.createElement("code", { style: { color: C.cy } }, "DOC-031 | Matriz Leopold | 14001 | Ambiental | P | 1.0 | M. Torres")
        ),
        React.createElement("textarea", {
          value: importText,
          onChange: function(e) { setImportText(e.target.value); },
          placeholder: "Pegue aqui los documentos en formato CODIGO | NOMBRE | ISO | AREA | PDCA | VERSION | RESPONSABLE\nUna linea por documento...",
          rows: 6,
          style: { width: "100%", padding: 10, borderRadius: 8, border: "1px solid " + C.bd, background: C.card, color: C.tx, fontSize: 10, fontFamily: "monospace", resize: "vertical", boxSizing: "border-box" }
        }),
        React.createElement("div", { style: { display: "flex", gap: 8, justifyContent: "flex-end", marginTop: 8 } },
          React.createElement(Btn, { onClick: function() { setShowImport(false); setImportText(""); } }, "Cancelar"),
          React.createElement(Btn, { accent: true, onClick: function() { parseImport(importText); } }, React.createElement(Icons.Zap), " Procesar e Importar")
        )
      ) : null,
      React.createElement(Card, { p: 0 },
        React.createElement("div", { style: { padding: "12px 16px", borderBottom: "1px solid " + C.bd, display: "flex", justifyContent: "space-between", alignItems: "center" } },
          React.createElement("div", null,
            React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, "Lista Maestra de Documentos del SIG"),
            React.createElement("div", { style: { fontSize: 9, color: C.td } }, "ISO 9001 Cl.7.5 | Control de informacion documentada")
          ),
          React.createElement("div", { style: { display: "flex", gap: 6 } },
            React.createElement(Badge, { color: "green" }, "Vigentes: " + filtered.filter(function(d) { return d.status === "vigente"; }).length),
            React.createElement(Badge, { color: "yellow" }, "Revision: " + filtered.filter(function(d) { return d.status === "revision"; }).length)
          )
        ),
        React.createElement("div", { style: { overflowX: "auto" } },
          React.createElement("table", { style: { width: "100%", borderCollapse: "collapse", fontSize: 10 } },
            React.createElement("thead", null, React.createElement("tr", { style: { borderBottom: "1px solid " + C.bd } },
              ["#", "Codigo", "Documento", "ISO", "Area", "PDCA", "Version", "Fecha", "Estado", "Origen", "Responsable", "Acciones"].map(function(h) {
                return React.createElement("th", { key: h, style: { padding: "10px 6px", textAlign: "left", fontSize: 8, fontWeight: 700, color: C.td, textTransform: "uppercase", whiteSpace: "nowrap" } }, h);
              })
            )),
            React.createElement("tbody", null, filtered.map(function(d) {
              return React.createElement("tr", { key: d.mlId, style: { borderBottom: "1px solid " + C.bd + "50" },
                onMouseEnter: function(e) { e.currentTarget.style.background = C.cardH; }, onMouseLeave: function(e) { e.currentTarget.style.background = "transparent"; } },
                React.createElement("td", { style: { padding: "6px", color: C.td, fontSize: 9 } }, d.mlId),
                React.createElement("td", { style: { padding: "6px", fontWeight: 700, color: C.pr, whiteSpace: "nowrap" } }, d.id),
                React.createElement("td", { style: { padding: "6px", fontWeight: 600, color: C.tx } }, d.name),
                React.createElement("td", { style: { padding: "6px" } }, React.createElement(Badge, { color: isoColor[d.iso] || "cyan" }, d.iso === "multi" ? "Multi" : d.iso)),
                React.createElement("td", { style: { padding: "6px", color: C.tm, fontSize: 9 } }, d.area),
                React.createElement("td", { style: { padding: "6px" } }, React.createElement(Badge, { color: d.pdca === "P" ? "blue" : d.pdca === "D" ? "green" : d.pdca === "C" ? "yellow" : "purple" }, d.pdca)),
                React.createElement("td", { style: { padding: "6px", color: C.cy, fontWeight: 600 } }, "v" + d.version),
                React.createElement("td", { style: { padding: "6px", color: C.tm, whiteSpace: "nowrap" } }, d.date),
                React.createElement("td", { style: { padding: "6px" } }, React.createElement(Badge, { color: statusColor[d.status] || "blue" }, d.status)),
                React.createElement("td", { style: { padding: "6px", fontSize: 9, color: d.origen === "Importacion Inteligente" ? C.cy : C.tm } }, d.origen),
                React.createElement("td", { style: { padding: "6px", color: C.tm, fontSize: 9 } }, d.responsable),
                React.createElement("td", { style: { padding: "6px" } },
                  React.createElement("div", { style: { display: "flex", gap: 4 } },
                    React.createElement("button", { onClick: function() { setPreviewDoc(d); },
                      style: { background: C.pr + "18", border: "none", borderRadius: 4, padding: "3px 6px", cursor: "pointer", color: C.pr } }, React.createElement(Icons.Eye)),
                    React.createElement("button", { onClick: function() { downloadDoc(d); },
                      style: { background: C.ac + "18", border: "none", borderRadius: 4, padding: "3px 6px", cursor: "pointer", color: C.ac } }, React.createElement(Icons.Download))
                  )
                )
              );
            }))
          )
        )
      )
    );
  }

  // ═══════════════════════════════════════════════════════════════════════
  // RECURSOS PDCA — DOCUMENTOS DESCARGABLES
  // ═══════════════════════════════════════════════════════════════════════
  function RecursosView() {
    var pdcaDocs = {
      P: [
        { id: "REC-P01", name: "Politica Integrada SIG", desc: "Politica de calidad, medio ambiente, SST y antisoborno", iso: "multi" },
        { id: "REC-P02", name: "Manual del SIG", desc: "Manual del sistema integrado de gestion", iso: "9001" },
        { id: "REC-P03", name: "Mapa de Procesos", desc: "Interaccion de procesos Core/Soporte/Estrategicos", iso: "9001" },
        { id: "REC-P04", name: "Matriz IPERC Linea Base", desc: "Identificacion de peligros y evaluacion de riesgos", iso: "45001" },
        { id: "REC-P05", name: "Matriz de Aspectos Ambientales", desc: "Identificacion y evaluacion de aspectos ambientales", iso: "14001" },
        { id: "REC-P06", name: "Matriz de Riesgos de Soborno", desc: "Evaluacion de riesgos de soborno por area", iso: "37001" },
        { id: "REC-P07", name: "Objetivos SIG y Programas", desc: "Objetivos medibles por norma y programa de gestion", iso: "multi" },
        { id: "REC-P08", name: "Plan Anual de SST", desc: "Programa anual de seguridad y salud en el trabajo", iso: "45001" },
      ],
      D: [
        { id: "REC-D01", name: "Procedimiento Control Documentos", desc: "Creacion, revision, aprobacion y distribucion de documentos", iso: "9001" },
        { id: "REC-D02", name: "Procedimiento PETAR", desc: "Permiso escrito para trabajos de alto riesgo", iso: "45001" },
        { id: "REC-D03", name: "Procedimiento Gestion Residuos", desc: "Segregacion, almacenamiento y disposicion de residuos", iso: "14001" },
        { id: "REC-D04", name: "Procedimiento Due Diligence", desc: "Evaluacion de contrapartes para prevencion de soborno", iso: "37001" },
        { id: "REC-D05", name: "Procedimiento Compras", desc: "Evaluacion y seleccion de proveedores", iso: "9001" },
        { id: "REC-D06", name: "Procedimiento LOTO", desc: "Bloqueo y etiquetado de energias peligrosas", iso: "45001" },
        { id: "REC-D07", name: "Instructivo ATS", desc: "Analisis de trabajo seguro antes de actividades criticas", iso: "45001" },
        { id: "REC-D08", name: "Procedimiento Canal de Denuncias", desc: "Recepcion e investigacion de denuncias eticas", iso: "37001" },
      ],
      C: [
        { id: "REC-C01", name: "Informe Auditoria Interna", desc: "Modelo de informe de auditoria del SIG", iso: "multi" },
        { id: "REC-C02", name: "Registro Monitoreo Ambiental", desc: "Formato para registro de mediciones ambientales", iso: "14001" },
        { id: "REC-C03", name: "Formato Inspeccion SST", desc: "Checklist de inspecciones de seguridad", iso: "45001" },
        { id: "REC-C04", name: "Registro Satisfaccion Cliente", desc: "Encuesta y tabulacion de satisfaccion", iso: "9001" },
        { id: "REC-C05", name: "Informe Revision por la Direccion", desc: "Acta y seguimiento de revision gerencial", iso: "multi" },
        { id: "REC-C06", name: "Registro Investigacion Incidentes", desc: "Formato de investigacion de accidentes/incidentes", iso: "45001" },
      ],
      A: [
        { id: "REC-A01", name: "Solicitud de Accion Correctiva", desc: "Formato SAC con analisis de causa raiz", iso: "9001" },
        { id: "REC-A02", name: "Plan de Mejora Continua", desc: "Propuestas y seguimiento de mejoras", iso: "multi" },
        { id: "REC-A03", name: "Informe Accion Preventiva", desc: "Analisis y prevencion de potenciales no conformidades", iso: "9001" },
        { id: "REC-A04", name: "Registro Leccion Aprendida", desc: "Documentacion de lecciones aprendidas del proyecto", iso: "multi" },
      ],
    };

    var pdcaInfo = {
      P: { label: "PLANIFICAR (Plan)", color: C.pr, desc: "Documentos de planificacion estrategica y operativa" },
      D: { label: "HACER (Do)", color: C.ac, desc: "Procedimientos, instructivos y documentos operativos" },
      C: { label: "VERIFICAR (Check)", color: C.wn, desc: "Registros de monitoreo, inspeccion y auditoria" },
      A: { label: "ACTUAR (Act)", color: C.pp, desc: "Acciones correctivas, preventivas y mejora continua" },
    };

    var _pt = _s("P"), pdcaTab = _pt[0], setPdcaTab = _pt[1];

    function generatePDCADoc(doc) {
      var html = "<!DOCTYPE html><html><head><meta charset='UTF-8'><title>" + doc.name + "</title>";
      html += "<style>body{font-family:Calibri,Arial,sans-serif;margin:40px;color:#222;line-height:1.6}";
      html += ".header{border:2px solid #1a5276;padding:15px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}";
      html += ".header-logo{width:120px;height:55px;border:1px dashed #999;display:flex;align-items:center;justify-content:center;color:#999;font-size:11px}";
      html += ".header-title{flex:1;text-align:center;font-size:16px;font-weight:bold;color:#1a5276}";
      html += ".header-info{text-align:right;font-size:10px;line-height:1.8;color:#555}";
      html += "h1{color:#1a5276;border-bottom:2px solid #2d7ff9;padding-bottom:8px;font-size:16px}";
      html += "h2{color:#2d7ff9;font-size:14px;margin-top:20px}";
      html += "table{width:100%;border-collapse:collapse;margin:15px 0}th,td{border:1px solid #ccc;padding:8px;text-align:left;font-size:11px}";
      html += "th{background:#2d7ff9;color:white;font-weight:bold}";
      html += ".pdca-badge{display:inline-block;padding:3px 10px;border-radius:4px;font-weight:bold;font-size:11px;color:white;background:"+(pdcaInfo[doc.id.charAt(4)]||pdcaInfo.P).color+"}";
      html += ".footer{margin-top:40px;border-top:2px solid #1a5276;padding-top:12px;font-size:9px;color:#666}";
      html += ".signatures{display:flex;justify-content:space-between;margin-top:40px}";
      html += ".sig-block{text-align:center;width:30%;border-top:1px solid #333;padding-top:8px;font-size:10px}";
      html += ".section{margin:20px 0;padding:15px;background:#f8f9fa;border-radius:8px;border-left:4px solid #2d7ff9}";
      html += "</style></head><body>";
      html += "<div class='header'><div class='header-logo'>[LOGO EMPRESA]</div>";
      html += "<div class='header-title'>" + doc.name.toUpperCase() + "</div>";
      html += "<div class='header-info'>Codigo: " + doc.id + "<br>Version: 1.0<br>Fecha: " + new Date().toISOString().slice(0,10) + "<br>ISO: " + doc.iso + "</div></div>";
      html += "<h1>1. OBJETIVO</h1><p>Establecer los lineamientos para " + doc.desc.toLowerCase() + " dentro del Sistema Integrado de Gestion.</p>";
      html += "<h1>2. ALCANCE</h1><p>Aplica a todas las actividades y personal involucrado en " + doc.desc.toLowerCase() + ".</p>";
      html += "<h1>3. REFERENCIAS NORMATIVAS</h1><ul><li>ISO " + doc.iso + (doc.iso==="multi"?" (9001, 14001, 45001, 37001)":"") + "</li><li>Ley 29783 - SST</li><li>Ley 28611 - Medio Ambiente</li><li>Politica Integrada SIG</li></ul>";
      html += "<h1>4. DEFINICIONES</h1><div class='section'><p>[Insertar definiciones aplicables al documento]</p></div>";
      html += "<h1>5. RESPONSABILIDADES</h1><table><tr><th>Cargo</th><th>Responsabilidad</th></tr>";
      html += "<tr><td>Gerente General</td><td>Aprobar documento y asegurar recursos</td></tr>";
      html += "<tr><td>Coordinador SIG</td><td>Elaborar, actualizar y difundir</td></tr>";
      html += "<tr><td>Supervisores</td><td>Implementar y verificar cumplimiento</td></tr>";
      html += "<tr><td>Trabajadores</td><td>Cumplir lineamientos establecidos</td></tr></table>";
      html += "<h1>6. DESARROLLO</h1><div class='section'><p>[Contenido principal del documento - Desarrollar segun la naturaleza del procedimiento/registro/plan]</p></div>";
      html += "<h1>7. REGISTROS</h1><table><tr><th>Codigo</th><th>Nombre del Registro</th><th>Responsable</th><th>Retencion</th></tr>";
      html += "<tr><td>" + doc.id + "-R01</td><td>Registro principal asociado</td><td>Coord. SIG</td><td>3 anios</td></tr></table>";
      html += "<h1>8. CONTROL DE CAMBIOS</h1><table><tr><th>Version</th><th>Fecha</th><th>Modificacion</th><th>Aprobado por</th></tr>";
      html += "<tr><td>1.0</td><td>" + new Date().toISOString().slice(0,10) + "</td><td>Emision inicial</td><td>Gerencia General</td></tr></table>";
      html += "<div class='signatures'><div class='sig-block'>Elaborado por<br><br><br>_________________<br>Coord. SIG</div>";
      html += "<div class='sig-block'>Revisado por<br><br><br>_________________<br>Jefe de Area</div>";
      html += "<div class='sig-block'>Aprobado por<br><br><br>_________________<br>Gerente General</div></div>";
      html += "<div class='footer'>Documento confidencial - SIG Construccion 360 v7.0 | ISO " + doc.iso + " | Ciclo PDCA: " + doc.id.charAt(4) + "<br>";
      html += "Este documento es propiedad de la empresa. Prohibida su reproduccion sin autorizacion.</div>";
      html += "</body></html>";
      return html;
    }

    function downloadPDCA(doc) {
      var html = generatePDCADoc(doc);
      var blob = new Blob([html], { type: "text/html" });
      var url = URL.createObjectURL(blob);
      var a = document.createElement("a");
      a.href = url; a.download = doc.id + "_" + doc.name.replace(/\s+/g, "_") + ".html";
      document.body.appendChild(a); a.click(); document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    var isoC = { "9001":"blue", "14001":"green", "45001":"yellow", "37001":"purple", multi:"cyan" };
    var currentDocs = pdcaDocs[pdcaTab] || [];

    return React.createElement("div", null,
      React.createElement("div", { style: { display: "flex", gap: 4, marginBottom: 16 } },
        ["P","D","C","A"].map(function(phase) {
          var info = pdcaInfo[phase];
          var active = pdcaTab === phase;
          return React.createElement("button", { key: phase,
            onClick: function() { setPdcaTab(phase); },
            style: {
              flex: 1, padding: "12px 8px", borderRadius: 10, border: "none", cursor: "pointer",
              background: active ? info.color + "20" : C.sa,
              borderBottom: active ? "3px solid " + info.color : "3px solid transparent",
              color: active ? info.color : C.tm, fontWeight: 700, fontSize: 11, fontFamily: "inherit",
              transition: "all 0.2s",
            }
          }, phase + " - " + info.label.split(" ")[0]);
        })
      ),
      React.createElement(Card, { style: { padding: 16, marginBottom: 12, borderLeft: "3px solid " + pdcaInfo[pdcaTab].color } },
        React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 10 } },
          React.createElement("div", { style: { width: 36, height: 36, borderRadius: 10, background: pdcaInfo[pdcaTab].color + "20", display: "flex", alignItems: "center", justifyContent: "center", color: pdcaInfo[pdcaTab].color, fontWeight: 800, fontSize: 16 } }, pdcaTab),
          React.createElement("div", null,
            React.createElement("div", { style: { fontSize: 13, fontWeight: 700, color: C.tx } }, pdcaInfo[pdcaTab].label),
            React.createElement("div", { style: { fontSize: 10, color: C.td } }, pdcaInfo[pdcaTab].desc + " | " + currentDocs.length + " documentos")
          )
        )
      ),
      React.createElement("div", { style: { display: "grid", gridTemplateColumns: "repeat(auto-fill, minmax(280px, 1fr))", gap: 10 } },
        currentDocs.map(function(doc) {
          return React.createElement(Card, { key: doc.id, style: { padding: 14 } },
            React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "flex-start", marginBottom: 8 } },
              React.createElement("div", { style: { display: "flex", gap: 6, alignItems: "center" } },
                React.createElement("div", { style: { width: 30, height: 30, borderRadius: 8, background: pdcaInfo[pdcaTab].color + "18", display: "flex", alignItems: "center", justifyContent: "center", color: pdcaInfo[pdcaTab].color } }, React.createElement(Icons.FileText)),
                React.createElement("div", null,
                  React.createElement("div", { style: { fontSize: 10, fontWeight: 700, color: C.tx, lineHeight: 1.2 } }, doc.name),
                  React.createElement("div", { style: { fontSize: 8, color: C.td } }, doc.id)
                )
              ),
              React.createElement(Badge, { color: isoC[doc.iso] || "cyan" }, doc.iso === "multi" ? "Multi" : doc.iso)
            ),
            React.createElement("div", { style: { fontSize: 9, color: C.tm, marginBottom: 10, lineHeight: 1.4 } }, doc.desc),
            React.createElement("div", { style: { display: "flex", gap: 6 } },
              React.createElement(Btn, { sm: true, primary: true, onClick: function() { downloadPDCA(doc); } }, React.createElement(Icons.Download), " Descargar HTML"),
              React.createElement(Btn, { sm: true, onClick: function() {
                setPreviewDoc({ id: doc.id, name: doc.name, iso: doc.iso, area: "SIG", version: "1.0", date: new Date().toISOString().slice(0,10), pages: 8, pdca: pdcaTab });
              }}, React.createElement(Icons.Eye), " Vista Previa")
            )
          );
        })
      ),
      React.createElement("div", { style: { padding: "14px 0", fontSize: 9, color: C.td } },
        "Todos los documentos se descargan en formato HTML compatible con Microsoft Word y convertibles a PDF. ",
        "Abrir con navegador para ver/imprimir como PDF, o abrir con Word para editar."
      )
    );
  }

  // ═══ SETTINGS VIEW ═══
  function SettingsView() {
    return React.createElement(Card, { style: { padding: 24, maxWidth: 500 } },
      React.createElement("div", {
        style: { display: "flex", alignItems: "center", gap: 10, marginBottom: 20 }
      },
        React.createElement("div", {
          style: { width: 40, height: 40, borderRadius: 12, background: C.g1, display: "flex", alignItems: "center", justifyContent: "center" }
        }, React.createElement(Icons.Settings)),
        React.createElement("div", null,
          React.createElement("div", { style: { fontSize: 14, fontWeight: 800, color: C.tx } }, "Configuracion General"),
          React.createElement("div", { style: { fontSize: 10, color: C.td } }, "Parametros del sistema")
        )
      ),
      React.createElement(InputField, {
        label: "Nombre de la Empresa",
        value: empresa, onChange: setEmpresa,
        placeholder: "Ingrese razon social..."
      }),
      React.createElement(SelectField, {
        label: "Sector Principal",
        value: legalProfile.sector,
        onChange: function(v) { setLegalProfile(Object.assign({}, legalProfile, { sector: v })); },
        options: SECTORS
      }),
      React.createElement(SelectField, {
        label: "Idioma",
        value: "es",
        onChange: function() {},
        options: [{ value: "es", label: "Espanol" }, { value: "en", label: "English" }]
      }),
      React.createElement("div", {
        style: { padding: 12, background: C.ac + "10", borderRadius: 8, marginTop: 16 }
      },
        React.createElement("div", { style: { fontSize: 10, color: C.ac, fontWeight: 600 } }, "SIG Construccion 360 v7.0"),
        React.createElement("div", { style: { fontSize: 9, color: C.tm, marginTop: 4 } }, "ISO 9001:2015 | ISO 14001:2015 | ISO 45001:2018 | ISO 37001:2016"),
        React.createElement("div", { style: { fontSize: 9, color: C.td, marginTop: 2 } }, "Enterprise Edition - Docs + BI + Legal Tech + Lista Maestra + Recursos PDCA + ISO Editables + Incidentes")
      )
    );
  }

  // ═══ RENDER VIEW ROUTER ═══
  function renderView() {
    switch (view) {
      case "dashboard": return React.createElement(DashboardView);
      case "documents": return React.createElement(DocumentsView);
      case "ai-audit": return React.createElement(AIAuditorView);
      case "legal": return React.createElement(LegalView);
      case "lista-maestra": return React.createElement(ListaMaestraView);
      case "recursos": return React.createElement(RecursosView);
      case "iso9001-v2": return React.createElement(ISO9001V2View);
      case "iso14001-v2": return React.createElement(ISO14001V2View);
      case "iso45001-v2": return React.createElement(ISO45001V2View);
      case "iso37001-v2": return React.createElement(ISO37001V2View);
      case "settings": return React.createElement(SettingsView);
      default: return React.createElement("div", {
        style: { display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", height: "50vh", gap: 12 }
      },
        React.createElement("div", { style: { fontSize: 40 } }, "\uD83C\uDFD7\uFE0F"),
        React.createElement("div", { style: { fontSize: 14, fontWeight: 700, color: C.tx } }, titles[view] || view),
        React.createElement("div", { style: { fontSize: 10, color: C.td } }, "Modulo en desarrollo")
      );
    }
  }

  var dateStr = new Date().toLocaleDateString("es-PE", { weekday: "long", year: "numeric", month: "long", day: "numeric" });

  // ═══ MAIN LAYOUT ═══
  return React.createElement("div", {
    style: {
      display: "flex", height: "100vh", width: "100vw",
      background: C.bg,
      fontFamily: "'DM Sans','Segoe UI',system-ui,sans-serif",
      color: C.tx, overflow: "hidden"
    }
  },
    React.createElement("link", {
      href: "https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap",
      rel: "stylesheet"
    }),
    React.createElement(Sidebar),
    mobMenu ? React.createElement(React.Fragment, null,
      React.createElement("div", {
        style: { position: "fixed", inset: 0, background: "rgba(0,0,0,0.5)", zIndex: 999 },
        onClick: function() { setMobMenu(false); }
      }),
      React.createElement(Sidebar, { mobile: true })
    ) : null,
    React.createElement("div", {
      style: { flex: 1, display: "flex", flexDirection: "column", overflow: "hidden" }
    },
      // Header
      React.createElement("div", {
        style: {
          padding: "0 20px", height: 50, borderBottom: "1px solid " + C.bd,
          display: "flex", alignItems: "center", justifyContent: "space-between",
          background: C.sf, flexShrink: 0,
        }
      },
        React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 10 } },
          React.createElement("button", {
            onClick: function() {
              if (window.innerWidth < 768) { setMobMenu(true); }
              else { setSbOpen(!sbOpen); }
            },
            style: { background: "none", border: "none", color: C.tm, cursor: "pointer", padding: 4 }
          }, React.createElement(Icons.Menu)),
          React.createElement("div", null,
            React.createElement("h1", {
              style: { fontSize: 14, fontWeight: 700, color: C.tx, margin: 0 }
            }, titles[view] || "SIG Construccion"),
            React.createElement("p", {
              style: { fontSize: 8, color: C.td, margin: 0 }
            }, (empresa || "[Empresa]") + " \u2014 " + dateStr)
          )
        ),
        React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 8 } },
          React.createElement("button", {
            style: {
              background: C.sa, border: "1px solid " + C.bd, borderRadius: 8,
              padding: 6, cursor: "pointer", color: C.tm, position: "relative"
            }
          },
            React.createElement(Icons.Bell),
            React.createElement("div", {
              style: {
                position: "absolute", top: 2, right: 2, width: 6, height: 6,
                borderRadius: "50%", background: C.dn
              }
            })
          )
        )
      ),
      // Content
      React.createElement("div", {
        style: { flex: 1, overflow: "auto", padding: "14px 18px" }
      }, renderView())
    )
  );
}


// Render the app
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(React.createElement(SIGConstruccion360));
</script>
</body>
</html>
